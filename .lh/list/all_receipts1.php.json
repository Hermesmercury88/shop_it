{
    "sourceFile": "list/all_receipts1.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 60,
            "patches": [
                {
                    "date": 1758552087197,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1758552200777,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -165,9 +165,9 @@\n <body>\r\n <div class=\"sidebar\">\r\n     <a href=\"all_quotations1.php\">ใบเสนอราคา</a>\r\n     <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n-    <a href=\"#\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n"
                },
                {
                    "date": 1758552218614,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -163,9 +163,9 @@\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n-    <a href=\"all_quotations1.php\">ใบเสนอราคา</a>\r\n+    <a href=\"http://localhost/shop/list/all_quotations1.php\">ใบเสนอราคา</a>\r\n     <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n     <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n"
                },
                {
                    "date": 1758552230348,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -164,9 +164,9 @@\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n     <a href=\"http://localhost/shop/list/all_quotations1.php\">ใบเสนอราคา</a>\r\n-    <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n+    <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n     <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n"
                },
                {
                    "date": 1758552811841,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -222,9 +222,15 @@\n             ?>\r\n         </tbody>\r\n     </table>\r\n \r\n+    <div style=\"margin-top: 20px; display: flex; gap: 10px;\">\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n+    <button style=\"padding: 10px 10px; background:#b89172; color:#fff; border:none; border-radius:6px; cursor:pointer; font-weight:bold;\"\r\n+            onclick=\"window.location.href='../index.html'\">\r\n+        กลับหน้าหลัก\r\n+    </button>\r\n+    \r\n </div>\r\n \r\n <script>\r\n // ฟังก์ชันค้นหา (client side)\r\n"
                },
                {
                    "date": 1758554046328,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -182,8 +182,16 @@\n             <option value=\"1\">เลขที่ใบเสร็จ</option>\r\n             <option value=\"2\">ชื่อลูกค้า</option>\r\n         </select>\r\n         <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+        <!-- ✅ เพิ่มตัวเลือกจำนวนแถว -->\r\n+        <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n+        <select id=\"rowsPerPage\">\r\n+            <option value=\"5\">5</option>\r\n+            <option value=\"10\" selected>10</option>\r\n+            <option value=\"20\">20</option>\r\n+            <option value=\"50\">50</option>\r\n+        </select>\r\n     </div>\r\n \r\n     <table id=\"receiptTable\">\r\n         <thead>\r\n@@ -228,9 +236,9 @@\n     <button style=\"padding: 10px 10px; background:#b89172; color:#fff; border:none; border-radius:6px; cursor:pointer; font-weight:bold;\"\r\n             onclick=\"window.location.href='../index.html'\">\r\n         กลับหน้าหลัก\r\n     </button>\r\n-    \r\n+\r\n </div>\r\n \r\n <script>\r\n // ฟังก์ชันค้นหา (client side)\r\n"
                },
                {
                    "date": 1758554061583,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -182,8 +182,9 @@\n             <option value=\"1\">เลขที่ใบเสร็จ</option>\r\n             <option value=\"2\">ชื่อลูกค้า</option>\r\n         </select>\r\n         <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+\r\n         <!-- ✅ เพิ่มตัวเลือกจำนวนแถว -->\r\n         <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n         <select id=\"rowsPerPage\">\r\n             <option value=\"5\">5</option>\r\n@@ -255,8 +256,10 @@\n             rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n         }\r\n     }\r\n });\r\n+\r\n+\r\n </script>\r\n \r\n </body>\r\n </html>\r\n"
                },
                {
                    "date": 1758554217672,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -257,9 +257,27 @@\n         }\r\n     }\r\n });\r\n \r\n+// ✅ ฟังก์ชันเลือกจำนวนแถวที่จะแสดง\r\n+function updateTableRows() {\r\n+    let rowsPerPage = parseInt(document.getElementById(\"rowsPerPage\").value);\r\n+    let table = document.getElementById(\"receiptTable\");\r\n+    let rows = table.getElementsByTagName(\"tr\");\r\n \r\n+    let count = 0;\r\n+    for (let i = 1; i < rows.length; i++) {\r\n+        if (rows[i].style.display !== \"none\") { // ถ้าไม่ได้ถูกซ่อนจากการค้นหา\r\n+            count++;\r\n+            rows[i].style.display = (count <= rowsPerPage) ? \"\" : \"none\";\r\n+        }\r\n+    }\r\n+}\r\n+\r\n+document.getElementById(\"rowsPerPage\").addEventListener(\"change\", updateTableRows);\r\n+// เรียกตอนโหลดหน้า\r\n+updateTableRows();\r\n+\r\n </script>\r\n \r\n </body>\r\n </html>\r\n"
                },
                {
                    "date": 1758554656618,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -231,14 +231,10 @@\n             ?>\r\n         </tbody>\r\n     </table>\r\n \r\n-    <div style=\"margin-top: 20px; display: flex; gap: 10px;\">\r\n+    <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-    <button style=\"padding: 10px 10px; background:#b89172; color:#fff; border:none; border-radius:6px; cursor:pointer; font-weight:bold;\"\r\n-            onclick=\"window.location.href='../index.html'\">\r\n-        กลับหน้าหลัก\r\n-    </button>\r\n \r\n </div>\r\n \r\n <script>\r\n"
                },
                {
                    "date": 1758612268920,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,11 +9,12 @@\n if ($conn->connect_error) {\r\n     die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n }\r\n \r\n-// ดึงข้อมูลจากตาราง receipts + receipt_items\r\n+// ดึงข้อมูล receipts + receipt_items\r\n $sql = \"\r\n     SELECT \r\n+        i.id AS item_id,\r\n         r.order_no,\r\n         r.customer_name,\r\n         r.customer_address,\r\n         i.item_name,\r\n@@ -34,248 +35,199 @@\n <meta charset=\"UTF-8\">\r\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n <title>ใบเสร็จรับเงิน</title>\r\n <style>\r\n-body {\r\n-    margin: 0;\r\n-    font-family: Tahoma, sans-serif;\r\n-    background: #f9f9ef;\r\n-}\r\n-\r\n-/* Sidebar */\r\n-.sidebar {\r\n-    width: 220px;\r\n-    height: 100vh;\r\n-    background: #b89172;\r\n-    float: left;\r\n-    color: #fff;\r\n-    display: flex;\r\n-    flex-direction: column;\r\n-    align-items: center;\r\n-    padding-top: 30px;\r\n-}\r\n-.sidebar a {\r\n-    color: #fff;\r\n-    text-decoration: none;\r\n-    margin: 15px 0;\r\n-    display: block;\r\n-    width: 100%;\r\n-    text-align: center;\r\n-    transition: background 0.3s;\r\n-}\r\n-.sidebar a:hover {\r\n-    background: rgba(255,255,255,0.2);\r\n-    border-radius: 6px;\r\n-}\r\n-\r\n-/* Content */\r\n-.content {\r\n-    margin-left: 220px;\r\n-    padding: 20px;\r\n-}\r\n-\r\n-/* Topbar */\r\n-.topbar {\r\n-    background: #d4b295;\r\n-    padding: 15px 0;\r\n-    text-align: center;\r\n-    margin-bottom: 25px;\r\n-    box-sizing: border-box;\r\n-    border-radius: 6px 6px 0 0;\r\n-    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\r\n-}\r\n-.topbar img {\r\n-    max-height: 60px;\r\n-    display: block;\r\n-    margin: 0 auto;\r\n-}\r\n-\r\n-/* Headline */\r\n-h2, h3 {\r\n-    font-weight: 600;\r\n-    color: #4d3a2c;\r\n-    margin: 15px 0;\r\n-}\r\n-\r\n-/* Table */\r\n-table {\r\n-    width: 100%;\r\n-    border-collapse: collapse;\r\n-    border-radius: 6px;\r\n-    overflow: hidden;\r\n-    box-shadow: 0 2px 5px rgba(0,0,0,0.05);\r\n-}\r\n-th, td {\r\n-    border: 1px solid #333; /* เส้นชัด */\r\n-    padding: 10px;\r\n-    text-align: center;\r\n-}\r\n-th {\r\n-    background: #e5c3a6;\r\n-    font-weight: 600;\r\n-}\r\n-tr:nth-child(even) {\r\n-    background: #fdf5ef;\r\n-}\r\n-tr:hover {\r\n-    background: #ffe8d0;\r\n-}\r\n-\r\n-/* Search box */\r\n-.search-box {\r\n-    margin: 10px 0 15px;\r\n-}\r\n-input, select, textarea {\r\n-    padding: 6px;\r\n-    border: 1px solid #ccc;\r\n-    border-radius: 4px;\r\n-    outline: none;\r\n-}\r\n-input:focus, select:focus, textarea:focus {\r\n-    border-color: #b89172;\r\n-}\r\n-\r\n-/* PDF button */\r\n-.btn-pdf {\r\n-    margin-top: 20px;\r\n-    background: #f77c7c;\r\n-    color: #000;\r\n-    padding: 10px 25px;\r\n-    border: none;\r\n-    border-radius: 6px;\r\n-    cursor: pointer;\r\n-    font-weight: bold;\r\n-    transition: background 0.3s;\r\n-}\r\n-.btn-pdf:hover {\r\n-    background: #f55c5c;\r\n-}\r\n-\r\n-/* Print PDF */\r\n-@media print {\r\n-    @page { size: A5 portrait; margin: 5mm; }\r\n-    body { background: #fff; margin: 0; font-size: 12pt; }\r\n-    .sidebar, .search-box, .btn-pdf, .topbar { display: none !important; }\r\n-    .content { margin: 0; padding: 0; }\r\n-    table { border-collapse: collapse; width: 100%; border: 2px solid #000; margin: 0; box-sizing: border-box; }\r\n-    th, td { border: 1px solid #000; padding: 6px; text-align: center; box-sizing: border-box; }\r\n-    tr:nth-child(even) { background: #fdf5ef; }\r\n-}\r\n+/* --- CSS เหมือนตัวก่อนหน้า --- */\r\n+body{margin:0;font-family:Tahoma,sans-serif;background:#f9f9ef;}\r\n+.sidebar{width:220px;height:100vh;background:#b89172;float:left;color:#fff;display:flex;flex-direction:column;align-items:center;padding-top:30px;}\r\n+.sidebar a{color:#fff;text-decoration:none;margin:15px 0;display:block;width:100%;text-align:center;transition:background 0.3s;}\r\n+.sidebar a:hover{background: rgba(255,255,255,0.2);border-radius:6px;}\r\n+.content{margin-left:220px;padding:20px;}\r\n+.topbar{background:#d4b295;padding:15px 0;text-align:center;margin-bottom:25px;box-sizing:border-box;border-radius:6px 6px 0 0;box-shadow:0 2px 5px rgba(0,0,0,0.1);}\r\n+.topbar img{max-height:60px;display:block;margin:0 auto;}\r\n+h2{margin:20px 0;font-weight:600;color:#4d3a2c;}\r\n+table{width:100%;border-collapse:collapse;border-radius:6px;overflow:hidden;box-shadow:0 2px 5px rgba(0,0,0,0.05);}\r\n+th,td{border:1px solid #333;padding:10px;text-align:center;}\r\n+th{background:#e5c3a6;font-weight:600;}\r\n+tr:nth-child(even){background:#fdf5ef;}\r\n+tr:hover{background:#ffe8d0;}\r\n+.search-box{margin:10px 0 15px;}\r\n+input,select{padding:8px;border:1px solid #ccc;border-radius:4px;outline:none;}\r\n+input:focus,select:focus{border-color:#b89172;}\r\n+.action-btn{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;margin:2px;}\r\n+.btn-edit{background:#4caf50;color:#fff;}\r\n+.btn-save{background:#2196f3;color:#fff;}\r\n+.btn-cancel{background:#777;color:#fff;}\r\n+.btn-delete{background:#f44336;color:#fff;}\r\n+.btn-pdf,.btn-upload{margin-top:20px;padding:10px 25px;border:none;border-radius:6px;cursor:pointer;font-weight:bold;transition:background 0.3s;}\r\n+.btn-pdf{background:#f77c7c;color:#000;}\r\n+.btn-pdf:hover{background:#f55c5c;}\r\n+.btn-upload{background:#7cf7b3ff;color:#000;}\r\n+.btn-upload:hover{background:#3ad334ff;}\r\n+@media print{@page{size:A4 portrait;margin:5mm;}body{background:#fff;margin:0;font-size:12pt;}.sidebar,.search-box,.btn-pdf,.btn-upload,.action-btn,.topbar{display:none !important;}.content{margin:0;padding:0;}table{border-collapse:collapse;width:auto;margin:0;border:3px solid #000;}th,td{border:1px solid #000;padding:6px;text-align:center;}table th:last-child,table td:last-child{display:none !important;}}\r\n </style>\r\n </head>\r\n <body>\r\n+\r\n <div class=\"sidebar\">\r\n-    <a href=\"http://localhost/shop/list/all_quotations1.php\">ใบเสนอราคา</a>\r\n-    <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n-    <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"all_quotations1.php\">ใบเสนอราคา</a>\r\n+    <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n+    <a href=\"all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n-    <div class=\"topbar\">\r\n-        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n-    </div>\r\n+<div class=\"topbar\"><img src=\"../pic/logo.png\" alt=\"LOGO\"></div>\r\n+<h2>รายการใบเสร็จรับเงิน</h2>\r\n \r\n-    <h2>รายการใบเสร็จรับเงิน</h2>\r\n+<div class=\"search-box\">\r\n+<label for=\"searchColumn\">ค้นหาโดย: </label>\r\n+<select id=\"searchColumn\">\r\n+<option value=\"1\">เลขที่ใบเสร็จ</option>\r\n+<option value=\"2\">ชื่อลูกค้า</option>\r\n+</select>\r\n+<input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+<label for=\"rowsPerPage\">แสดงแถว: </label>\r\n+<select id=\"rowsPerPage\">\r\n+<option value=\"5\">5</option>\r\n+<option value=\"10\" selected>10</option>\r\n+<option value=\"20\">20</option>\r\n+<option value=\"50\">50</option>\r\n+</select>\r\n+</div>\r\n \r\n-    <div class=\"search-box\">\r\n-        <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n-        <select id=\"searchColumn\">\r\n-            <option value=\"1\">เลขที่ใบเสร็จ</option>\r\n-            <option value=\"2\">ชื่อลูกค้า</option>\r\n-        </select>\r\n-        <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+<table id=\"receiptTable\">\r\n+<thead>\r\n+<tr>\r\n+<th>ลำดับ</th>\r\n+<th>เลขที่ใบเสร็จ</th>\r\n+<th>ชื่อลูกค้า</th>\r\n+<th>ที่อยู่ลูกค้า</th>\r\n+<th>รายการ</th>\r\n+<th>จำนวน</th>\r\n+<th>ราคา</th>\r\n+<th>หน่วย</th>\r\n+<th>ราคารวม</th>\r\n+<th>จัดการ</th>\r\n+</tr>\r\n+</thead>\r\n+<tbody>\r\n+<?php\r\n+$no = 1;\r\n+if($result->num_rows>0){\r\n+    while($row=$result->fetch_assoc()){\r\n+        echo \"<tr data-id='\".$row['item_id'].\"'>\";\r\n+        echo \"<td>\".$no++.\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['order_no']).\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['customer_name']).\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['customer_address']).\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['item_name']).\"</td>\";\r\n+        echo \"<td class='editable col-qty'>\".$row['qty'].\"</td>\";\r\n+        echo \"<td class='editable col-price'>\".number_format($row['price'],2).\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['unit']).\"</td>\";\r\n+        echo \"<td class='editable col-total'>\".number_format($row['total'],2).\"</td>\";\r\n+        echo \"<td>\r\n+        <button class='action-btn btn-edit'>แก้ไข</button>\r\n+        <button class='action-btn btn-delete'>ลบ</button>\r\n+        </td>\";\r\n+        echo \"</tr>\";\r\n+    }\r\n+}else{\r\n+    echo \"<tr><td colspan='10'>ยังไม่มีข้อมูล</td></tr>\";\r\n+}\r\n+?>\r\n+</tbody>\r\n+</table>\r\n \r\n-        <!-- ✅ เพิ่มตัวเลือกจำนวนแถว -->\r\n-        <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n-        <select id=\"rowsPerPage\">\r\n-            <option value=\"5\">5</option>\r\n-            <option value=\"10\" selected>10</option>\r\n-            <option value=\"20\">20</option>\r\n-            <option value=\"50\">50</option>\r\n-        </select>\r\n-    </div>\r\n-\r\n-    <table id=\"receiptTable\">\r\n-        <thead>\r\n-            <tr>\r\n-                <th>ลำดับ</th>\r\n-                <th>เลขที่ใบเสร็จ</th>\r\n-                <th>ชื่อลูกค้า</th>\r\n-                <th>ที่อยู่ลูกค้า</th>\r\n-                <th>รายการ</th>\r\n-                <th>จำนวน</th>\r\n-                <th>ราคา</th>\r\n-                <th>หน่วย</th>\r\n-                <th>ราคารวม</th>\r\n-            </tr>\r\n-        </thead>\r\n-        <tbody>\r\n-            <?php\r\n-            $no = 1;\r\n-            if ($result->num_rows > 0) {\r\n-                while($row = $result->fetch_assoc()) {\r\n-                    echo \"<tr>\";\r\n-                    echo \"<td>\" . $no++ . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['order_no']) . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['customer_name']) . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['customer_address']) . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n-                    echo \"<td>\" . $row['qty'] . \"</td>\";\r\n-                    echo \"<td>\" . number_format($row['price'],2) . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n-                    echo \"<td>\" . number_format($row['total'],2) . \"</td>\";\r\n-                    echo \"</tr>\";\r\n-                }\r\n-            } else {\r\n-                echo \"<tr><td colspan='9'>ยังไม่มีข้อมูล</td></tr>\";\r\n-            }\r\n-            ?>\r\n-        </tbody>\r\n-    </table>\r\n-\r\n-    <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n-    <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-\r\n+<button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n+<button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n+<button class=\"btn-upload\" onclick=\"window.open('../receipts_add.html','_blank')\">เพิ่มใบเสร็จ</button>\r\n </div>\r\n \r\n <script>\r\n-// ฟังก์ชันค้นหา (client side)\r\n-document.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n-    let input = this.value.toLowerCase();\r\n-    let table = document.getElementById(\"receiptTable\");\r\n-    let rows = table.getElementsByTagName(\"tr\");\r\n-    let column = parseInt(document.getElementById(\"searchColumn\").value);\r\n-\r\n-    for (let i = 1; i < rows.length; i++) {\r\n-        let cell = rows[i].getElementsByTagName(\"td\")[column];\r\n-        if (cell) {\r\n-            let text = cell.textContent.toLowerCase();\r\n-            rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n-        }\r\n+// ค้นหา\r\n+document.getElementById(\"searchInput\").addEventListener(\"keyup\",function(){\r\n+    let input=this.value.toLowerCase();\r\n+    let table=document.getElementById(\"receiptTable\");\r\n+    let rows=table.getElementsByTagName(\"tr\");\r\n+    let column=parseInt(document.getElementById(\"searchColumn\").value);\r\n+    for(let i=1;i<rows.length;i++){\r\n+        let cell=rows[i].getElementsByTagName(\"td\")[column];\r\n+        rows[i].style.display = cell && cell.textContent.toLowerCase().includes(input) ? \"\" : \"none\";\r\n     }\r\n });\r\n-\r\n-// ✅ ฟังก์ชันเลือกจำนวนแถวที่จะแสดง\r\n-function updateTableRows() {\r\n-    let rowsPerPage = parseInt(document.getElementById(\"rowsPerPage\").value);\r\n-    let table = document.getElementById(\"receiptTable\");\r\n-    let rows = table.getElementsByTagName(\"tr\");\r\n-\r\n-    let count = 0;\r\n-    for (let i = 1; i < rows.length; i++) {\r\n-        if (rows[i].style.display !== \"none\") { // ถ้าไม่ได้ถูกซ่อนจากการค้นหา\r\n+// แสดงจำนวนแถว\r\n+function updateTableRows(){\r\n+    let rowsPerPage=parseInt(document.getElementById(\"rowsPerPage\").value);\r\n+    let table=document.getElementById(\"receiptTable\");\r\n+    let rows=table.getElementsByTagName(\"tr\");\r\n+    let count=0;\r\n+    for(let i=1;i<rows.length;i++){\r\n+        if(rows[i].style.display!==\"none\"){\r\n             count++;\r\n-            rows[i].style.display = (count <= rowsPerPage) ? \"\" : \"none\";\r\n+            rows[i].style.display=(count<=rowsPerPage)?\"\":\"none\";\r\n         }\r\n     }\r\n }\r\n-\r\n-document.getElementById(\"rowsPerPage\").addEventListener(\"change\", updateTableRows);\r\n-// เรียกตอนโหลดหน้า\r\n+document.getElementById(\"rowsPerPage\").addEventListener(\"change\",updateTableRows);\r\n updateTableRows();\r\n \r\n+// แก้ไข/บันทึก/ยกเลิก\r\n+document.querySelectorAll('.btn-edit').forEach(btn=>{\r\n+    btn.addEventListener('click',function(){\r\n+        let tr=this.closest('tr');\r\n+        let inputs=tr.querySelectorAll('.editable');\r\n+        if(this.textContent==='แก้ไข'){\r\n+            inputs.forEach(td=>{\r\n+                let val=td.textContent;\r\n+                td.innerHTML=\"<input value='\"+val+\"' style='width:100px'>\";\r\n+            });\r\n+            this.textContent='บันทึก';\r\n+            let cancelBtn=document.createElement('button');\r\n+            cancelBtn.textContent='ยกเลิก';\r\n+            cancelBtn.className='action-btn btn-cancel';\r\n+            this.after(cancelBtn);\r\n+            cancelBtn.addEventListener('click',()=>{\r\n+                location.reload(); // คืนค่าเดิม\r\n+            });\r\n+        } else {\r\n+            let data={};\r\n+            inputs.forEach(td=>{\r\n+                let key=td.className.includes('col-qty')?'qty':\r\n+                        td.className.includes('col-price')?'price':\r\n+                        td.className.includes('col-total')?'total':\r\n+                        td.previousElementSibling ? td.previousElementSibling.textContent : td.textContent;\r\n+                data[key]=td.querySelector('input')?td.querySelector('input').value:td.textContent;\r\n+            });\r\n+            let id=tr.dataset.id;\r\n+            fetch('update_receipts_item.php',{\r\n+                method:'POST',\r\n+                headers:{'Content-Type':'application/json'},\r\n+                body:JSON.stringify({id,data})\r\n+            }).then(r=>r.json()).then(res=>{\r\n+                if(res.success) location.reload();\r\n+                else alert('บันทึกไม่สำเร็จ');\r\n+            });\r\n+        }\r\n+    });\r\n+});\r\n+\r\n+// ลบ\r\n+document.querySelectorAll('.btn-delete').forEach(btn=>{\r\n+    btn.addEventListener('click',function(){\r\n+        if(!confirm('คุณต้องการลบรายการนี้หรือไม่?')) return;\r\n+        let tr=this.closest('tr');\r\n+        let id=tr.dataset.id;\r\n+        fetch('delete_receipts_item.php',{\r\n+            method:'POST',\r\n+            headers:{'Content-Type':'application/json'},\r\n+            body:JSON.stringify({id})\r\n+        }).then(r=>r.json()).then(res=>{\r\n+            if(res.success) tr.remove();\r\n+            else alert('ลบไม่สำเร็จ');\r\n+        });\r\n+    });\r\n+});\r\n </script>\r\n \r\n </body>\r\n </html>\r\n-\r\n <?php $conn->close(); ?>\r\n"
                },
                {
                    "date": 1758612873179,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n if ($conn->connect_error) {\r\n     die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n }\r\n \r\n-// ดึงข้อมูล receipts + receipt_items\r\n+// ดึงข้อมูลจาก receipts + receipt_items\r\n $sql = \"\r\n     SELECT \r\n         i.id AS item_id,\r\n         r.order_no,\r\n@@ -35,127 +35,135 @@\n <meta charset=\"UTF-8\">\r\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n <title>ใบเสร็จรับเงิน</title>\r\n <style>\r\n-/* --- CSS เหมือนตัวก่อนหน้า --- */\r\n-body{margin:0;font-family:Tahoma,sans-serif;background:#f9f9ef;}\r\n-.sidebar{width:220px;height:100vh;background:#b89172;float:left;color:#fff;display:flex;flex-direction:column;align-items:center;padding-top:30px;}\r\n-.sidebar a{color:#fff;text-decoration:none;margin:15px 0;display:block;width:100%;text-align:center;transition:background 0.3s;}\r\n-.sidebar a:hover{background: rgba(255,255,255,0.2);border-radius:6px;}\r\n-.content{margin-left:220px;padding:20px;}\r\n-.topbar{background:#d4b295;padding:15px 0;text-align:center;margin-bottom:25px;box-sizing:border-box;border-radius:6px 6px 0 0;box-shadow:0 2px 5px rgba(0,0,0,0.1);}\r\n-.topbar img{max-height:60px;display:block;margin:0 auto;}\r\n-h2{margin:20px 0;font-weight:600;color:#4d3a2c;}\r\n-table{width:100%;border-collapse:collapse;border-radius:6px;overflow:hidden;box-shadow:0 2px 5px rgba(0,0,0,0.05);}\r\n-th,td{border:1px solid #333;padding:10px;text-align:center;}\r\n-th{background:#e5c3a6;font-weight:600;}\r\n-tr:nth-child(even){background:#fdf5ef;}\r\n-tr:hover{background:#ffe8d0;}\r\n-.search-box{margin:10px 0 15px;}\r\n-input,select{padding:8px;border:1px solid #ccc;border-radius:4px;outline:none;}\r\n-input:focus,select:focus{border-color:#b89172;}\r\n-.action-btn{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;margin:2px;}\r\n-.btn-edit{background:#4caf50;color:#fff;}\r\n-.btn-save{background:#2196f3;color:#fff;}\r\n-.btn-cancel{background:#777;color:#fff;}\r\n-.btn-delete{background:#f44336;color:#fff;}\r\n-.btn-pdf,.btn-upload{margin-top:20px;padding:10px 25px;border:none;border-radius:6px;cursor:pointer;font-weight:bold;transition:background 0.3s;}\r\n-.btn-pdf{background:#f77c7c;color:#000;}\r\n-.btn-pdf:hover{background:#f55c5c;}\r\n-.btn-upload{background:#7cf7b3ff;color:#000;}\r\n-.btn-upload:hover{background:#3ad334ff;}\r\n-@media print{@page{size:A4 portrait;margin:5mm;}body{background:#fff;margin:0;font-size:12pt;}.sidebar,.search-box,.btn-pdf,.btn-upload,.action-btn,.topbar{display:none !important;}.content{margin:0;padding:0;}table{border-collapse:collapse;width:auto;margin:0;border:3px solid #000;}th,td{border:1px solid #000;padding:6px;text-align:center;}table th:last-child,table td:last-child{display:none !important;}}\r\n+body { margin:0; font-family:Tahoma,sans-serif; background:#f9f9ef; }\r\n+.sidebar { width:220px; height:100vh; background:#b89172; float:left; color:#fff; display:flex; flex-direction:column; align-items:center; padding-top:30px; }\r\n+.sidebar a { color:#fff; text-decoration:none; margin:15px 0; display:block; width:100%; text-align:center; transition:background 0.3s; }\r\n+.sidebar a:hover { background: rgba(255,255,255,0.2); border-radius:6px; }\r\n+.content { margin-left:220px; padding:20px; }\r\n+.topbar { background:#d4b295; padding:15px 0; text-align:center; margin-bottom:25px; box-sizing:border-box; border-radius:6px 6px 0 0; box-shadow:0 2px 5px rgba(0,0,0,0.1); }\r\n+.topbar img { max-height:60px; display:block; margin:0 auto; }\r\n+h2 { font-weight:600; color:#4d3a2c; margin:15px 0; }\r\n+table { width:100%; border-collapse:collapse; border-radius:6px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.05); }\r\n+th, td { border:1px solid #333; padding:10px; text-align:center; }\r\n+th { background:#e5c3a6; font-weight:600; }\r\n+tr:nth-child(even) { background:#fdf5ef; }\r\n+tr:hover { background:#ffe8d0; }\r\n+.search-box { margin:10px 0 15px; }\r\n+input, select { padding:6px; border:1px solid #ccc; border-radius:4px; outline:none; }\r\n+input:focus, select:focus { border-color:#b89172; }\r\n+.action-btn { padding:5px 10px; border:none; border-radius:4px; cursor:pointer; margin:2px; }\r\n+.btn-edit { background:#4caf50; color:#fff; }\r\n+.btn-save { background:#2196f3; color:#fff; }\r\n+.btn-cancel { background:#777; color:#fff; }\r\n+.btn-delete { background:#f44336; color:#fff; }\r\n+.btn-pdf { margin-top:20px; background:#f77c7c; color:#000; padding:10px 25px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; transition:background 0.3s; }\r\n+.btn-pdf:hover { background:#f55c5c; }\r\n+\r\n+/* Print */\r\n+@media print {\r\n+    @page { size:A4 portrait; margin:5mm; }\r\n+    body { background:#fff; margin:0; font-size:12pt; }\r\n+    .sidebar, .search-box, .btn-pdf, .action-btn, .topbar { display:none !important; }\r\n+    .content { margin:0; padding:0; }\r\n+    table { border-collapse:collapse; width:100%; border:2px solid #000; margin:0; box-sizing:border-box; }\r\n+    th, td { border:1px solid #000; padding:6px; text-align:center; box-sizing:border-box; }\r\n+}\r\n </style>\r\n </head>\r\n <body>\r\n-\r\n <div class=\"sidebar\">\r\n-    <a href=\"all_quotations1.php\">ใบเสนอราคา</a>\r\n-    <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n-    <a href=\"all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"#\">ใบเสนอราคา</a>\r\n+    <a href=\"#\">ใบส่งของ</a>\r\n+    <a href=\"#\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n-<div class=\"topbar\"><img src=\"../pic/logo.png\" alt=\"LOGO\"></div>\r\n-<h2>รายการใบเสร็จรับเงิน</h2>\r\n+    <div class=\"topbar\">\r\n+        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n+    </div>\r\n \r\n-<div class=\"search-box\">\r\n-<label for=\"searchColumn\">ค้นหาโดย: </label>\r\n-<select id=\"searchColumn\">\r\n-<option value=\"1\">เลขที่ใบเสร็จ</option>\r\n-<option value=\"2\">ชื่อลูกค้า</option>\r\n-</select>\r\n-<input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n-<label for=\"rowsPerPage\">แสดงแถว: </label>\r\n-<select id=\"rowsPerPage\">\r\n-<option value=\"5\">5</option>\r\n-<option value=\"10\" selected>10</option>\r\n-<option value=\"20\">20</option>\r\n-<option value=\"50\">50</option>\r\n-</select>\r\n-</div>\r\n+    <h2>รายการใบเสร็จรับเงิน</h2>\r\n \r\n-<table id=\"receiptTable\">\r\n-<thead>\r\n-<tr>\r\n-<th>ลำดับ</th>\r\n-<th>เลขที่ใบเสร็จ</th>\r\n-<th>ชื่อลูกค้า</th>\r\n-<th>ที่อยู่ลูกค้า</th>\r\n-<th>รายการ</th>\r\n-<th>จำนวน</th>\r\n-<th>ราคา</th>\r\n-<th>หน่วย</th>\r\n-<th>ราคารวม</th>\r\n-<th>จัดการ</th>\r\n-</tr>\r\n-</thead>\r\n-<tbody>\r\n-<?php\r\n-$no = 1;\r\n-if($result->num_rows>0){\r\n-    while($row=$result->fetch_assoc()){\r\n-        echo \"<tr data-id='\".$row['item_id'].\"'>\";\r\n-        echo \"<td>\".$no++.\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['order_no']).\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['customer_name']).\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['customer_address']).\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['item_name']).\"</td>\";\r\n-        echo \"<td class='editable col-qty'>\".$row['qty'].\"</td>\";\r\n-        echo \"<td class='editable col-price'>\".number_format($row['price'],2).\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['unit']).\"</td>\";\r\n-        echo \"<td class='editable col-total'>\".number_format($row['total'],2).\"</td>\";\r\n-        echo \"<td>\r\n-        <button class='action-btn btn-edit'>แก้ไข</button>\r\n-        <button class='action-btn btn-delete'>ลบ</button>\r\n-        </td>\";\r\n-        echo \"</tr>\";\r\n-    }\r\n-}else{\r\n-    echo \"<tr><td colspan='10'>ยังไม่มีข้อมูล</td></tr>\";\r\n-}\r\n-?>\r\n-</tbody>\r\n-</table>\r\n+    <div class=\"search-box\">\r\n+        <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n+        <select id=\"searchColumn\">\r\n+            <option value=\"1\">เลขที่ใบเสร็จ</option>\r\n+            <option value=\"2\">ชื่อลูกค้า</option>\r\n+        </select>\r\n+        <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+        <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n+        <select id=\"rowsPerPage\">\r\n+            <option value=\"5\">5</option>\r\n+            <option value=\"10\" selected>10</option>\r\n+            <option value=\"20\">20</option>\r\n+            <option value=\"50\">50</option>\r\n+        </select>\r\n+    </div>\r\n \r\n-<button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n-<button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-<button class=\"btn-upload\" onclick=\"window.open('../receipts_add.html','_blank')\">เพิ่มใบเสร็จ</button>\r\n+    <table id=\"receiptTable\">\r\n+        <thead>\r\n+            <tr>\r\n+                <th>ลำดับ</th>\r\n+                <th>เลขที่ใบเสร็จ</th>\r\n+                <th>ชื่อลูกค้า</th>\r\n+                <th>ที่อยู่ลูกค้า</th>\r\n+                <th>รายการ</th>\r\n+                <th>จำนวน</th>\r\n+                <th>ราคา</th>\r\n+                <th>หน่วย</th>\r\n+                <th>ราคารวม</th>\r\n+                <th>จัดการ</th>\r\n+            </tr>\r\n+        </thead>\r\n+        <tbody>\r\n+        <?php\r\n+        $no=1;\r\n+        if($result->num_rows>0){\r\n+            while($row=$result->fetch_assoc()){\r\n+                echo \"<tr data-id='{$row['item_id']}'>\";\r\n+                echo \"<td>\".$no++.\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['order_no']).\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['customer_name']).\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['customer_address']).\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['item_name']).\"</td>\";\r\n+                echo \"<td class='editable col-qty'>{$row['qty']}</td>\";\r\n+                echo \"<td class='editable col-price'>\".number_format($row['price'],2).\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['unit']).\"</td>\";\r\n+                echo \"<td class='editable col-total'>\".number_format($row['total'],2).\"</td>\";\r\n+                echo \"<td>\r\n+                        <button class='action-btn btn-edit'>แก้ไข</button>\r\n+                        <button class='action-btn btn-delete'>ลบ</button>\r\n+                      </td>\";\r\n+                echo \"</tr>\";\r\n+            }\r\n+        }else{\r\n+            echo \"<tr><td colspan='10'>ยังไม่มีข้อมูล</td></tr>\";\r\n+        }\r\n+        ?>\r\n+        </tbody>\r\n+    </table>\r\n+\r\n+    <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n+    <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n+\r\n </div>\r\n \r\n <script>\r\n // ค้นหา\r\n document.getElementById(\"searchInput\").addEventListener(\"keyup\",function(){\r\n     let input=this.value.toLowerCase();\r\n     let table=document.getElementById(\"receiptTable\");\r\n     let rows=table.getElementsByTagName(\"tr\");\r\n-    let column=parseInt(document.getElementById(\"searchColumn\").value);\r\n+    let col=parseInt(document.getElementById(\"searchColumn\").value);\r\n     for(let i=1;i<rows.length;i++){\r\n-        let cell=rows[i].getElementsByTagName(\"td\")[column];\r\n-        rows[i].style.display = cell && cell.textContent.toLowerCase().includes(input) ? \"\" : \"none\";\r\n+        let cell=rows[i].getElementsByTagName(\"td\")[col];\r\n+        if(cell) rows[i].style.display=cell.textContent.toLowerCase().includes(input)?\"\":\"none\";\r\n     }\r\n });\r\n-// แสดงจำนวนแถว\r\n+\r\n+// จำนวนแถว\r\n function updateTableRows(){\r\n     let rowsPerPage=parseInt(document.getElementById(\"rowsPerPage\").value);\r\n     let table=document.getElementById(\"receiptTable\");\r\n     let rows=table.getElementsByTagName(\"tr\");\r\n@@ -170,60 +178,75 @@\n document.getElementById(\"rowsPerPage\").addEventListener(\"change\",updateTableRows);\r\n updateTableRows();\r\n \r\n // แก้ไข/บันทึก/ยกเลิก\r\n-document.querySelectorAll('.btn-edit').forEach(btn=>{\r\n-    btn.addEventListener('click',function(){\r\n-        let tr=this.closest('tr');\r\n-        let inputs=tr.querySelectorAll('.editable');\r\n-        if(this.textContent==='แก้ไข'){\r\n-            inputs.forEach(td=>{\r\n-                let val=td.textContent;\r\n-                td.innerHTML=\"<input value='\"+val+\"' style='width:100px'>\";\r\n+document.querySelectorAll(\".btn-edit\").forEach(btn=>{\r\n+    btn.addEventListener(\"click\",function(){\r\n+        let row=this.closest(\"tr\");\r\n+        let tds=row.querySelectorAll(\".editable\");\r\n+        if(this.textContent===\"แก้ไข\"){\r\n+            tds.forEach(td=>{\r\n+                let val=td.textContent.trim();\r\n+                td.innerHTML=`<input value=\"${val}\">`;\r\n             });\r\n-            this.textContent='บันทึก';\r\n-            let cancelBtn=document.createElement('button');\r\n-            cancelBtn.textContent='ยกเลิก';\r\n-            cancelBtn.className='action-btn btn-cancel';\r\n+            let qtyInput=row.querySelector(\".col-qty input\");\r\n+            let priceInput=row.querySelector(\".col-price input\");\r\n+            let totalCell=row.querySelector(\".col-total\");\r\n+\r\n+            function updateTotal(){\r\n+                let qty=parseFloat(qtyInput.value)||0;\r\n+                let price=parseFloat(priceInput.value)||0;\r\n+                totalCell.innerHTML=`<input value=\"${(qty*price).toFixed(2)}\">`;\r\n+            }\r\n+            qtyInput.addEventListener(\"input\",updateTotal);\r\n+            priceInput.addEventListener(\"input\",updateTotal);\r\n+\r\n+            this.textContent=\"บันทึก\";\r\n+            this.className=\"action-btn btn-save\";\r\n+\r\n+            let cancelBtn=document.createElement(\"button\");\r\n+            cancelBtn.textContent=\"ยกเลิก\";\r\n+            cancelBtn.className=\"action-btn btn-cancel\";\r\n             this.after(cancelBtn);\r\n-            cancelBtn.addEventListener('click',()=>{\r\n-                location.reload(); // คืนค่าเดิม\r\n-            });\r\n-        } else {\r\n-            let data={};\r\n-            inputs.forEach(td=>{\r\n-                let key=td.className.includes('col-qty')?'qty':\r\n-                        td.className.includes('col-price')?'price':\r\n-                        td.className.includes('col-total')?'total':\r\n-                        td.previousElementSibling ? td.previousElementSibling.textContent : td.textContent;\r\n-                data[key]=td.querySelector('input')?td.querySelector('input').value:td.textContent;\r\n-            });\r\n-            let id=tr.dataset.id;\r\n-            fetch('update_receipts_item.php',{\r\n-                method:'POST',\r\n-                headers:{'Content-Type':'application/json'},\r\n+            cancelBtn.addEventListener(\"click\",()=>location.reload());\r\n+\r\n+        }else{\r\n+            let id=row.dataset.id;\r\n+            let data={\r\n+                order_no: row.querySelector(\"td:nth-child(2) input\").value,\r\n+                customer_name: row.querySelector(\"td:nth-child(3) input\").value,\r\n+                customer_address: row.querySelector(\"td:nth-child(4) input\").value,\r\n+                item_name: row.querySelector(\"td:nth-child(5) input\").value,\r\n+                qty: row.querySelector(\".col-qty input\").value,\r\n+                price: row.querySelector(\".col-price input\").value,\r\n+                unit: row.querySelector(\"td:nth-child(8) input\").value,\r\n+                total: row.querySelector(\".col-total input\").value\r\n+            };\r\n+            fetch(\"update_receipts_item.php\",{\r\n+                method:\"POST\",\r\n+                headers:{\"Content-Type\":\"application/json\"},\r\n                 body:JSON.stringify({id,data})\r\n             }).then(r=>r.json()).then(res=>{\r\n                 if(res.success) location.reload();\r\n-                else alert('บันทึกไม่สำเร็จ');\r\n+                else alert(\"บันทึกไม่สำเร็จ\");\r\n             });\r\n         }\r\n     });\r\n });\r\n \r\n // ลบ\r\n-document.querySelectorAll('.btn-delete').forEach(btn=>{\r\n-    btn.addEventListener('click',function(){\r\n-        if(!confirm('คุณต้องการลบรายการนี้หรือไม่?')) return;\r\n-        let tr=this.closest('tr');\r\n-        let id=tr.dataset.id;\r\n-        fetch('delete_receipts_item.php',{\r\n-            method:'POST',\r\n-            headers:{'Content-Type':'application/json'},\r\n+document.querySelectorAll(\".btn-delete\").forEach(btn=>{\r\n+    btn.addEventListener(\"click\",function(){\r\n+        if(!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n+        let row=this.closest(\"tr\");\r\n+        let id=row.dataset.id;\r\n+        fetch(\"delete_receipts_item.php\",{\r\n+            method:\"POST\",\r\n+            headers:{\"Content-Type\":\"application/json\"},\r\n             body:JSON.stringify({id})\r\n         }).then(r=>r.json()).then(res=>{\r\n-            if(res.success) tr.remove();\r\n-            else alert('ลบไม่สำเร็จ');\r\n+            if(res.success) row.remove();\r\n+            else alert(\"ลบไม่สำเร็จ\");\r\n         });\r\n     });\r\n });\r\n </script>\r\n"
                },
                {
                    "date": 1758613090774,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -209,15 +209,15 @@\n             this.after(cancelBtn);\r\n             cancelBtn.addEventListener(\"click\",()=>location.reload());\r\n \r\n         }else{\r\n-            let id=row.dataset.id;\r\n+            =row.dataset.id;\r\n             let data={\r\n                 order_no: row.querySelector(\"td:nth-child(2) input\").value,\r\n                 customer_name: row.querySelector(\"td:nth-child(3) input\").value,\r\n                 customer_address: row.querySelector(\"td:nth-child(4) input\").value,\r\n                 item_name: row.querySelector(\"td:nth-child(5) input\").value,\r\n-                qty: row.querySelector(\".col-qty input\").value,\r\n+                qty: row.querlet idySelector(\".col-qty input\").value,\r\n                 price: row.querySelector(\".col-price input\").value,\r\n                 unit: row.querySelector(\"td:nth-child(8) input\").value,\r\n                 total: row.querySelector(\".col-total input\").value\r\n             };\r\n"
                },
                {
                    "date": 1758613113682,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -210,26 +210,37 @@\n             cancelBtn.addEventListener(\"click\",()=>location.reload());\r\n \r\n         }else{\r\n             =row.dataset.id;\r\n-            let data={\r\n-                order_no: row.querySelector(\"td:nth-child(2) input\").value,\r\n-                customer_name: row.querySelector(\"td:nth-child(3) input\").value,\r\n-                customer_address: row.querySelector(\"td:nth-child(4) input\").value,\r\n-                item_name: row.querySelector(\"td:nth-child(5) input\").value,\r\n-                qty: row.querlet idySelector(\".col-qty input\").value,\r\n-                price: row.querySelector(\".col-price input\").value,\r\n-                unit: row.querySelector(\"td:nth-child(8) input\").value,\r\n-                total: row.querySelector(\".col-total input\").value\r\n-            };\r\n-            fetch(\"update_receipts_item.php\",{\r\n-                method:\"POST\",\r\n-                headers:{\"Content-Type\":\"application/json\"},\r\n-                body:JSON.stringify({id,data})\r\n-            }).then(r=>r.json()).then(res=>{\r\n-                if(res.success) location.reload();\r\n-                else alert(\"บันทึกไม่สำเร็จ\");\r\n-            });\r\n+            let id = row.dataset.id;\r\n+let payload = {\r\n+    id: id,\r\n+    data: {\r\n+        order_no: row.querySelector(\"td:nth-child(2) input\").value.trim(),\r\n+        customer_name: row.querySelector(\"td:nth-child(3) input\").value.trim(),\r\n+        customer_address: row.querySelector(\"td:nth-child(4) input\").value.trim(),\r\n+        item_name: row.querySelector(\"td:nth-child(5) input\").value.trim(),\r\n+        qty: parseFloat(row.querySelector(\".col-qty input\").value) || 0,\r\n+        price: parseFloat(row.querySelector(\".col-price input\").value) || 0,\r\n+        unit: row.querySelector(\"td:nth-child(8) input\").value.trim()\r\n+    }\r\n+};\r\n+\r\n+fetch(\"update_receipts_item.php\", {\r\n+    method: \"POST\",\r\n+    headers: {\"Content-Type\": \"application/json\"},\r\n+    body: JSON.stringify(payload)\r\n+})\r\n+.then(response => response.json())\r\n+.then(res => {\r\n+    if(res.success){\r\n+        location.reload();\r\n+    }else{\r\n+        alert(\"บันทึกไม่สำเร็จ: \" + (res.message || \"\"));\r\n+    }\r\n+})\r\n+.catch(err => alert(\"เกิดข้อผิดพลาด: \" + err));\r\n+\r\n         }\r\n     });\r\n });\r\n \r\n"
                },
                {
                    "date": 1758613121535,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -211,10 +211,10 @@\n \r\n         }else{\r\n             =row.dataset.id;\r\n             let id = row.dataset.id;\r\n-let payload = {\r\n-    id: id,\r\n+            let payload = {\r\n+                id: id,\r\n     data: {\r\n         order_no: row.querySelector(\"td:nth-child(2) input\").value.trim(),\r\n         customer_name: row.querySelector(\"td:nth-child(3) input\").value.trim(),\r\n         customer_address: row.querySelector(\"td:nth-child(4) input\").value.trim(),\r\n"
                },
                {
                    "date": 1758613136546,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -213,17 +213,18 @@\n             =row.dataset.id;\r\n             let id = row.dataset.id;\r\n             let payload = {\r\n                 id: id,\r\n-    data: {\r\n+                data: {\r\n         order_no: row.querySelector(\"td:nth-child(2) input\").value.trim(),\r\n         customer_name: row.querySelector(\"td:nth-child(3) input\").value.trim(),\r\n         customer_address: row.querySelector(\"td:nth-child(4) input\").value.trim(),\r\n         item_name: row.querySelector(\"td:nth-child(5) input\").value.trim(),\r\n         qty: parseFloat(row.querySelector(\".col-qty input\").value) || 0,\r\n         price: parseFloat(row.querySelector(\".col-price input\").value) || 0,\r\n         unit: row.querySelector(\"td:nth-child(8) input\").value.trim()\r\n     }\r\n+    \r\n };\r\n \r\n fetch(\"update_receipts_item.php\", {\r\n     method: \"POST\",\r\n"
                },
                {
                    "date": 1758613157553,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -209,39 +209,27 @@\n             this.after(cancelBtn);\r\n             cancelBtn.addEventListener(\"click\",()=>location.reload());\r\n \r\n         }else{\r\n-            =row.dataset.id;\r\n-            let id = row.dataset.id;\r\n-            let payload = {\r\n-                id: id,\r\n-                data: {\r\n-        order_no: row.querySelector(\"td:nth-child(2) input\").value.trim(),\r\n-        customer_name: row.querySelector(\"td:nth-child(3) input\").value.trim(),\r\n-        customer_address: row.querySelector(\"td:nth-child(4) input\").value.trim(),\r\n-        item_name: row.querySelector(\"td:nth-child(5) input\").value.trim(),\r\n-        qty: parseFloat(row.querySelector(\".col-qty input\").value) || 0,\r\n-        price: parseFloat(row.querySelector(\".col-price input\").value) || 0,\r\n-        unit: row.querySelector(\"td:nth-child(8) input\").value.trim()\r\n-    }\r\n-    \r\n-};\r\n-\r\n-fetch(\"update_receipts_item.php\", {\r\n-    method: \"POST\",\r\n-    headers: {\"Content-Type\": \"application/json\"},\r\n-    body: JSON.stringify(payload)\r\n-})\r\n-.then(response => response.json())\r\n-.then(res => {\r\n-    if(res.success){\r\n-        location.reload();\r\n-    }else{\r\n-        alert(\"บันทึกไม่สำเร็จ: \" + (res.message || \"\"));\r\n-    }\r\n-})\r\n-.catch(err => alert(\"เกิดข้อผิดพลาด: \" + err));\r\n-\r\n+            let id=row.dataset.id;\r\n+            let data={\r\n+                order_no: row.querySelector(\"td:nth-child(2) input\").value,\r\n+                customer_name: row.querySelector(\"td:nth-child(3) input\").value,\r\n+                customer_address: row.querySelector(\"td:nth-child(4) input\").value,\r\n+                item_name: row.querySelector(\"td:nth-child(5) input\").value,\r\n+                qty: row.querySelector(\".col-qty input\").value,\r\n+                price: row.querySelector(\".col-price input\").value,\r\n+                unit: row.querySelector(\"td:nth-child(8) input\").value,\r\n+                total: row.querySelector(\".col-total input\").value\r\n+            };\r\n+            fetch(\"update_receipts_item.php\",{\r\n+                method:\"POST\",\r\n+                headers:{\"Content-Type\":\"application/json\"},\r\n+                body:JSON.stringify({id,data})\r\n+            }).then(r=>r.json()).then(res=>{\r\n+                if(res.success) location.reload();\r\n+                else alert(\"บันทึกไม่สำเร็จ\");\r\n+            });\r\n         }\r\n     });\r\n });\r\n \r\n"
                },
                {
                    "date": 1758613379257,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n if ($conn->connect_error) {\r\n     die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n }\r\n \r\n-// ดึงข้อมูลจาก receipts + receipt_items\r\n+// ดึงข้อมูล receipts + receipt_items\r\n $sql = \"\r\n     SELECT \r\n         i.id AS item_id,\r\n         r.order_no,\r\n@@ -35,135 +35,127 @@\n <meta charset=\"UTF-8\">\r\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n <title>ใบเสร็จรับเงิน</title>\r\n <style>\r\n-body { margin:0; font-family:Tahoma,sans-serif; background:#f9f9ef; }\r\n-.sidebar { width:220px; height:100vh; background:#b89172; float:left; color:#fff; display:flex; flex-direction:column; align-items:center; padding-top:30px; }\r\n-.sidebar a { color:#fff; text-decoration:none; margin:15px 0; display:block; width:100%; text-align:center; transition:background 0.3s; }\r\n-.sidebar a:hover { background: rgba(255,255,255,0.2); border-radius:6px; }\r\n-.content { margin-left:220px; padding:20px; }\r\n-.topbar { background:#d4b295; padding:15px 0; text-align:center; margin-bottom:25px; box-sizing:border-box; border-radius:6px 6px 0 0; box-shadow:0 2px 5px rgba(0,0,0,0.1); }\r\n-.topbar img { max-height:60px; display:block; margin:0 auto; }\r\n-h2 { font-weight:600; color:#4d3a2c; margin:15px 0; }\r\n-table { width:100%; border-collapse:collapse; border-radius:6px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.05); }\r\n-th, td { border:1px solid #333; padding:10px; text-align:center; }\r\n-th { background:#e5c3a6; font-weight:600; }\r\n-tr:nth-child(even) { background:#fdf5ef; }\r\n-tr:hover { background:#ffe8d0; }\r\n-.search-box { margin:10px 0 15px; }\r\n-input, select { padding:6px; border:1px solid #ccc; border-radius:4px; outline:none; }\r\n-input:focus, select:focus { border-color:#b89172; }\r\n-.action-btn { padding:5px 10px; border:none; border-radius:4px; cursor:pointer; margin:2px; }\r\n-.btn-edit { background:#4caf50; color:#fff; }\r\n-.btn-save { background:#2196f3; color:#fff; }\r\n-.btn-cancel { background:#777; color:#fff; }\r\n-.btn-delete { background:#f44336; color:#fff; }\r\n-.btn-pdf { margin-top:20px; background:#f77c7c; color:#000; padding:10px 25px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; transition:background 0.3s; }\r\n-.btn-pdf:hover { background:#f55c5c; }\r\n-\r\n-/* Print */\r\n-@media print {\r\n-    @page { size:A4 portrait; margin:5mm; }\r\n-    body { background:#fff; margin:0; font-size:12pt; }\r\n-    .sidebar, .search-box, .btn-pdf, .action-btn, .topbar { display:none !important; }\r\n-    .content { margin:0; padding:0; }\r\n-    table { border-collapse:collapse; width:100%; border:2px solid #000; margin:0; box-sizing:border-box; }\r\n-    th, td { border:1px solid #000; padding:6px; text-align:center; box-sizing:border-box; }\r\n-}\r\n+/* --- CSS เหมือนตัวก่อนหน้า --- */\r\n+body{margin:0;font-family:Tahoma,sans-serif;background:#f9f9ef;}\r\n+.sidebar{width:220px;height:100vh;background:#b89172;float:left;color:#fff;display:flex;flex-direction:column;align-items:center;padding-top:30px;}\r\n+.sidebar a{color:#fff;text-decoration:none;margin:15px 0;display:block;width:100%;text-align:center;transition:background 0.3s;}\r\n+.sidebar a:hover{background: rgba(255,255,255,0.2);border-radius:6px;}\r\n+.content{margin-left:220px;padding:20px;}\r\n+.topbar{background:#d4b295;padding:15px 0;text-align:center;margin-bottom:25px;box-sizing:border-box;border-radius:6px 6px 0 0;box-shadow:0 2px 5px rgba(0,0,0,0.1);}\r\n+.topbar img{max-height:60px;display:block;margin:0 auto;}\r\n+h2{margin:20px 0;font-weight:600;color:#4d3a2c;}\r\n+table{width:100%;border-collapse:collapse;border-radius:6px;overflow:hidden;box-shadow:0 2px 5px rgba(0,0,0,0.05);}\r\n+th,td{border:1px solid #333;padding:10px;text-align:center;}\r\n+th{background:#e5c3a6;font-weight:600;}\r\n+tr:nth-child(even){background:#fdf5ef;}\r\n+tr:hover{background:#ffe8d0;}\r\n+.search-box{margin:10px 0 15px;}\r\n+input,select{padding:8px;border:1px solid #ccc;border-radius:4px;outline:none;}\r\n+input:focus,select:focus{border-color:#b89172;}\r\n+.action-btn{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;margin:2px;}\r\n+.btn-edit{background:#4caf50;color:#fff;}\r\n+.btn-save{background:#2196f3;color:#fff;}\r\n+.btn-cancel{background:#777;color:#fff;}\r\n+.btn-delete{background:#f44336;color:#fff;}\r\n+.btn-pdf,.btn-upload{margin-top:20px;padding:10px 25px;border:none;border-radius:6px;cursor:pointer;font-weight:bold;transition:background 0.3s;}\r\n+.btn-pdf{background:#f77c7c;color:#000;}\r\n+.btn-pdf:hover{background:#f55c5c;}\r\n+.btn-upload{background:#7cf7b3ff;color:#000;}\r\n+.btn-upload:hover{background:#3ad334ff;}\r\n+@media print{@page{size:A4 portrait;margin:5mm;}body{background:#fff;margin:0;font-size:12pt;}.sidebar,.search-box,.btn-pdf,.btn-upload,.action-btn,.topbar{display:none !important;}.content{margin:0;padding:0;}table{border-collapse:collapse;width:auto;margin:0;border:3px solid #000;}th,td{border:1px solid #000;padding:6px;text-align:center;}table th:last-child,table td:last-child{display:none !important;}}\r\n </style>\r\n </head>\r\n <body>\r\n+\r\n <div class=\"sidebar\">\r\n-    <a href=\"#\">ใบเสนอราคา</a>\r\n-    <a href=\"#\">ใบส่งของ</a>\r\n-    <a href=\"#\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"all_quotations1.php\">ใบเสนอราคา</a>\r\n+    <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n+    <a href=\"all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n-    <div class=\"topbar\">\r\n-        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n-    </div>\r\n+<div class=\"topbar\"><img src=\"../pic/logo.png\" alt=\"LOGO\"></div>\r\n+<h2>รายการใบเสร็จรับเงิน</h2>\r\n \r\n-    <h2>รายการใบเสร็จรับเงิน</h2>\r\n+<div class=\"search-box\">\r\n+<label for=\"searchColumn\">ค้นหาโดย: </label>\r\n+<select id=\"searchColumn\">\r\n+<option value=\"1\">เลขที่ใบเสร็จ</option>\r\n+<option value=\"2\">ชื่อลูกค้า</option>\r\n+</select>\r\n+<input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+<label for=\"rowsPerPage\">แสดงแถว: </label>\r\n+<select id=\"rowsPerPage\">\r\n+<option value=\"5\">5</option>\r\n+<option value=\"10\" selected>10</option>\r\n+<option value=\"20\">20</option>\r\n+<option value=\"50\">50</option>\r\n+</select>\r\n+</div>\r\n \r\n-    <div class=\"search-box\">\r\n-        <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n-        <select id=\"searchColumn\">\r\n-            <option value=\"1\">เลขที่ใบเสร็จ</option>\r\n-            <option value=\"2\">ชื่อลูกค้า</option>\r\n-        </select>\r\n-        <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n-        <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n-        <select id=\"rowsPerPage\">\r\n-            <option value=\"5\">5</option>\r\n-            <option value=\"10\" selected>10</option>\r\n-            <option value=\"20\">20</option>\r\n-            <option value=\"50\">50</option>\r\n-        </select>\r\n-    </div>\r\n+<table id=\"receiptTable\">\r\n+<thead>\r\n+<tr>\r\n+<th>ลำดับ</th>\r\n+<th>เลขที่ใบเสร็จ</th>\r\n+<th>ชื่อลูกค้า</th>\r\n+<th>ที่อยู่ลูกค้า</th>\r\n+<th>รายการ</th>\r\n+<th>จำนวน</th>\r\n+<th>ราคา</th>\r\n+<th>หน่วย</th>\r\n+<th>ราคารวม</th>\r\n+<th>จัดการ</th>\r\n+</tr>\r\n+</thead>\r\n+<tbody>\r\n+<?php\r\n+$no = 1;\r\n+if($result->num_rows>0){\r\n+    while($row=$result->fetch_assoc()){\r\n+        echo \"<tr data-id='\".$row['item_id'].\"'>\";\r\n+        echo \"<td>\".$no++.\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['order_no']).\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['customer_name']).\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['customer_address']).\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['item_name']).\"</td>\";\r\n+        echo \"<td class='editable col-qty'>\".$row['qty'].\"</td>\";\r\n+        echo \"<td class='editable col-price'>\".number_format($row['price'],2).\"</td>\";\r\n+        echo \"<td class='editable'>\".htmlspecialchars($row['unit']).\"</td>\";\r\n+        echo \"<td class='editable col-total'>\".number_format($row['total'],2).\"</td>\";\r\n+        echo \"<td>\r\n+        <button class='action-btn btn-edit'>แก้ไข</button>\r\n+        <button class='action-btn btn-delete'>ลบ</button>\r\n+        </td>\";\r\n+        echo \"</tr>\";\r\n+    }\r\n+}else{\r\n+    echo \"<tr><td colspan='10'>ยังไม่มีข้อมูล</td></tr>\";\r\n+}\r\n+?>\r\n+</tbody>\r\n+</table>\r\n \r\n-    <table id=\"receiptTable\">\r\n-        <thead>\r\n-            <tr>\r\n-                <th>ลำดับ</th>\r\n-                <th>เลขที่ใบเสร็จ</th>\r\n-                <th>ชื่อลูกค้า</th>\r\n-                <th>ที่อยู่ลูกค้า</th>\r\n-                <th>รายการ</th>\r\n-                <th>จำนวน</th>\r\n-                <th>ราคา</th>\r\n-                <th>หน่วย</th>\r\n-                <th>ราคารวม</th>\r\n-                <th>จัดการ</th>\r\n-            </tr>\r\n-        </thead>\r\n-        <tbody>\r\n-        <?php\r\n-        $no=1;\r\n-        if($result->num_rows>0){\r\n-            while($row=$result->fetch_assoc()){\r\n-                echo \"<tr data-id='{$row['item_id']}'>\";\r\n-                echo \"<td>\".$no++.\"</td>\";\r\n-                echo \"<td class='editable'>\".htmlspecialchars($row['order_no']).\"</td>\";\r\n-                echo \"<td class='editable'>\".htmlspecialchars($row['customer_name']).\"</td>\";\r\n-                echo \"<td class='editable'>\".htmlspecialchars($row['customer_address']).\"</td>\";\r\n-                echo \"<td class='editable'>\".htmlspecialchars($row['item_name']).\"</td>\";\r\n-                echo \"<td class='editable col-qty'>{$row['qty']}</td>\";\r\n-                echo \"<td class='editable col-price'>\".number_format($row['price'],2).\"</td>\";\r\n-                echo \"<td class='editable'>\".htmlspecialchars($row['unit']).\"</td>\";\r\n-                echo \"<td class='editable col-total'>\".number_format($row['total'],2).\"</td>\";\r\n-                echo \"<td>\r\n-                        <button class='action-btn btn-edit'>แก้ไข</button>\r\n-                        <button class='action-btn btn-delete'>ลบ</button>\r\n-                      </td>\";\r\n-                echo \"</tr>\";\r\n-            }\r\n-        }else{\r\n-            echo \"<tr><td colspan='10'>ยังไม่มีข้อมูล</td></tr>\";\r\n-        }\r\n-        ?>\r\n-        </tbody>\r\n-    </table>\r\n-\r\n-    <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n-    <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-\r\n+<button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n+<button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n+<button class=\"btn-upload\" onclick=\"window.open('../receipts_add.html','_blank')\">เพิ่มใบเสร็จ</button>\r\n </div>\r\n \r\n <script>\r\n // ค้นหา\r\n document.getElementById(\"searchInput\").addEventListener(\"keyup\",function(){\r\n     let input=this.value.toLowerCase();\r\n     let table=document.getElementById(\"receiptTable\");\r\n     let rows=table.getElementsByTagName(\"tr\");\r\n-    let col=parseInt(document.getElementById(\"searchColumn\").value);\r\n+    let column=parseInt(document.getElementById(\"searchColumn\").value);\r\n     for(let i=1;i<rows.length;i++){\r\n-        let cell=rows[i].getElementsByTagName(\"td\")[col];\r\n-        if(cell) rows[i].style.display=cell.textContent.toLowerCase().includes(input)?\"\":\"none\";\r\n+        let cell=rows[i].getElementsByTagName(\"td\")[column];\r\n+        rows[i].style.display = cell && cell.textContent.toLowerCase().includes(input) ? \"\" : \"none\";\r\n     }\r\n });\r\n-\r\n-// จำนวนแถว\r\n+// แสดงจำนวนแถว\r\n function updateTableRows(){\r\n     let rowsPerPage=parseInt(document.getElementById(\"rowsPerPage\").value);\r\n     let table=document.getElementById(\"receiptTable\");\r\n     let rows=table.getElementsByTagName(\"tr\");\r\n@@ -178,75 +170,60 @@\n document.getElementById(\"rowsPerPage\").addEventListener(\"change\",updateTableRows);\r\n updateTableRows();\r\n \r\n // แก้ไข/บันทึก/ยกเลิก\r\n-document.querySelectorAll(\".btn-edit\").forEach(btn=>{\r\n-    btn.addEventListener(\"click\",function(){\r\n-        let row=this.closest(\"tr\");\r\n-        let tds=row.querySelectorAll(\".editable\");\r\n-        if(this.textContent===\"แก้ไข\"){\r\n-            tds.forEach(td=>{\r\n-                let val=td.textContent.trim();\r\n-                td.innerHTML=`<input value=\"${val}\">`;\r\n+document.querySelectorAll('.btn-edit').forEach(btn=>{\r\n+    btn.addEventListener('click',function(){\r\n+        let tr=this.closest('tr');\r\n+        let inputs=tr.querySelectorAll('.editable');\r\n+        if(this.textContent==='แก้ไข'){\r\n+            inputs.forEach(td=>{\r\n+                let val=td.textContent;\r\n+                td.innerHTML=\"<input value='\"+val+\"' style='width:100px'>\";\r\n             });\r\n-            let qtyInput=row.querySelector(\".col-qty input\");\r\n-            let priceInput=row.querySelector(\".col-price input\");\r\n-            let totalCell=row.querySelector(\".col-total\");\r\n-\r\n-            function updateTotal(){\r\n-                let qty=parseFloat(qtyInput.value)||0;\r\n-                let price=parseFloat(priceInput.value)||0;\r\n-                totalCell.innerHTML=`<input value=\"${(qty*price).toFixed(2)}\">`;\r\n-            }\r\n-            qtyInput.addEventListener(\"input\",updateTotal);\r\n-            priceInput.addEventListener(\"input\",updateTotal);\r\n-\r\n-            this.textContent=\"บันทึก\";\r\n-            this.className=\"action-btn btn-save\";\r\n-\r\n-            let cancelBtn=document.createElement(\"button\");\r\n-            cancelBtn.textContent=\"ยกเลิก\";\r\n-            cancelBtn.className=\"action-btn btn-cancel\";\r\n+            this.textContent='บันทึก';\r\n+            let cancelBtn=document.createElement('button');\r\n+            cancelBtn.textContent='ยกเลิก';\r\n+            cancelBtn.className='action-btn btn-cancel';\r\n             this.after(cancelBtn);\r\n-            cancelBtn.addEventListener(\"click\",()=>location.reload());\r\n-\r\n-        }else{\r\n-            let id=row.dataset.id;\r\n-            let data={\r\n-                order_no: row.querySelector(\"td:nth-child(2) input\").value,\r\n-                customer_name: row.querySelector(\"td:nth-child(3) input\").value,\r\n-                customer_address: row.querySelector(\"td:nth-child(4) input\").value,\r\n-                item_name: row.querySelector(\"td:nth-child(5) input\").value,\r\n-                qty: row.querySelector(\".col-qty input\").value,\r\n-                price: row.querySelector(\".col-price input\").value,\r\n-                unit: row.querySelector(\"td:nth-child(8) input\").value,\r\n-                total: row.querySelector(\".col-total input\").value\r\n-            };\r\n-            fetch(\"update_receipts_item.php\",{\r\n-                method:\"POST\",\r\n-                headers:{\"Content-Type\":\"application/json\"},\r\n+            cancelBtn.addEventListener('click',()=>{\r\n+                location.reload(); // คืนค่าเดิม\r\n+            });\r\n+        } else {\r\n+            let data={};\r\n+            inputs.forEach(td=>{\r\n+                let key=td.className.includes('col-qty')?'qty':\r\n+                        td.className.includes('col-price')?'price':\r\n+                        td.className.includes('col-total')?'total':\r\n+                        td.previousElementSibling ? td.previousElementSibling.textContent : td.textContent;\r\n+                data[key]=td.querySelector('input')?td.querySelector('input').value:td.textContent;\r\n+            });\r\n+            let id=tr.dataset.id;\r\n+            fetch('update_receipts_item.php',{\r\n+                method:'POST',\r\n+                headers:{'Content-Type':'application/json'},\r\n                 body:JSON.stringify({id,data})\r\n             }).then(r=>r.json()).then(res=>{\r\n                 if(res.success) location.reload();\r\n-                else alert(\"บันทึกไม่สำเร็จ\");\r\n+                else alert('บันทึกไม่สำเร็จ');\r\n             });\r\n         }\r\n     });\r\n });\r\n \r\n // ลบ\r\n-document.querySelectorAll(\".btn-delete\").forEach(btn=>{\r\n-    btn.addEventListener(\"click\",function(){\r\n-        if(!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n-        let row=this.closest(\"tr\");\r\n-        let id=row.dataset.id;\r\n-        fetch(\"delete_receipts_item.php\",{\r\n-            method:\"POST\",\r\n-            headers:{\"Content-Type\":\"application/json\"},\r\n+document.querySelectorAll('.btn-delete').forEach(btn=>{\r\n+    btn.addEventListener('click',function(){\r\n+        if(!confirm('คุณต้องการลบรายการนี้หรือไม่?')) return;\r\n+        let tr=this.closest('tr');\r\n+        let id=tr.dataset.id;\r\n+        fetch('delete_receipts_item.php',{\r\n+            method:'POST',\r\n+            headers:{'Content-Type':'application/json'},\r\n             body:JSON.stringify({id})\r\n         }).then(r=>r.json()).then(res=>{\r\n-            if(res.success) row.remove();\r\n-            else alert(\"ลบไม่สำเร็จ\");\r\n+            if(res.success) tr.remove();\r\n+            else alert('ลบไม่สำเร็จ');\r\n         });\r\n     });\r\n });\r\n </script>\r\n"
                },
                {
                    "date": 1758613464762,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n if ($conn->connect_error) {\r\n     die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n }\r\n \r\n-// ดึงข้อมูล receipts + receipt_items\r\n+// ดึงข้อมูลจาก receipts + receipt_items\r\n $sql = \"\r\n     SELECT \r\n         i.id AS item_id,\r\n         r.order_no,\r\n@@ -35,127 +35,136 @@\n <meta charset=\"UTF-8\">\r\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n <title>ใบเสร็จรับเงิน</title>\r\n <style>\r\n-/* --- CSS เหมือนตัวก่อนหน้า --- */\r\n-body{margin:0;font-family:Tahoma,sans-serif;background:#f9f9ef;}\r\n-.sidebar{width:220px;height:100vh;background:#b89172;float:left;color:#fff;display:flex;flex-direction:column;align-items:center;padding-top:30px;}\r\n-.sidebar a{color:#fff;text-decoration:none;margin:15px 0;display:block;width:100%;text-align:center;transition:background 0.3s;}\r\n-.sidebar a:hover{background: rgba(255,255,255,0.2);border-radius:6px;}\r\n-.content{margin-left:220px;padding:20px;}\r\n-.topbar{background:#d4b295;padding:15px 0;text-align:center;margin-bottom:25px;box-sizing:border-box;border-radius:6px 6px 0 0;box-shadow:0 2px 5px rgba(0,0,0,0.1);}\r\n-.topbar img{max-height:60px;display:block;margin:0 auto;}\r\n-h2{margin:20px 0;font-weight:600;color:#4d3a2c;}\r\n-table{width:100%;border-collapse:collapse;border-radius:6px;overflow:hidden;box-shadow:0 2px 5px rgba(0,0,0,0.05);}\r\n-th,td{border:1px solid #333;padding:10px;text-align:center;}\r\n-th{background:#e5c3a6;font-weight:600;}\r\n-tr:nth-child(even){background:#fdf5ef;}\r\n-tr:hover{background:#ffe8d0;}\r\n-.search-box{margin:10px 0 15px;}\r\n-input,select{padding:8px;border:1px solid #ccc;border-radius:4px;outline:none;}\r\n-input:focus,select:focus{border-color:#b89172;}\r\n-.action-btn{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;margin:2px;}\r\n-.btn-edit{background:#4caf50;color:#fff;}\r\n-.btn-save{background:#2196f3;color:#fff;}\r\n-.btn-cancel{background:#777;color:#fff;}\r\n-.btn-delete{background:#f44336;color:#fff;}\r\n-.btn-pdf,.btn-upload{margin-top:20px;padding:10px 25px;border:none;border-radius:6px;cursor:pointer;font-weight:bold;transition:background 0.3s;}\r\n-.btn-pdf{background:#f77c7c;color:#000;}\r\n-.btn-pdf:hover{background:#f55c5c;}\r\n-.btn-upload{background:#7cf7b3ff;color:#000;}\r\n-.btn-upload:hover{background:#3ad334ff;}\r\n-@media print{@page{size:A4 portrait;margin:5mm;}body{background:#fff;margin:0;font-size:12pt;}.sidebar,.search-box,.btn-pdf,.btn-upload,.action-btn,.topbar{display:none !important;}.content{margin:0;padding:0;}table{border-collapse:collapse;width:auto;margin:0;border:3px solid #000;}th,td{border:1px solid #000;padding:6px;text-align:center;}table th:last-child,table td:last-child{display:none !important;}}\r\n+body { margin:0; font-family:Tahoma,sans-serif; background:#f9f9ef; }\r\n+.sidebar { width:220px; height:100vh; background:#b89172; float:left; color:#fff; display:flex; flex-direction:column; align-items:center; padding-top:30px; }\r\n+.sidebar a { color:#fff; text-decoration:none; margin:15px 0; display:block; width:100%; text-align:center; transition:background 0.3s; }\r\n+.sidebar a:hover { background: rgba(255,255,255,0.2); border-radius:6px; }\r\n+.content { margin-left:220px; padding:20px; }\r\n+.topbar { background:#d4b295; padding:15px 0; text-align:center; margin-bottom:25px; box-sizing:border-box; border-radius:6px 6px 0 0; box-shadow:0 2px 5px rgba(0,0,0,0.1); }\r\n+.topbar img { max-height:60px; display:block; margin:0 auto; }\r\n+h2 { font-weight:600; color:#4d3a2c; margin:15px 0; }\r\n+table { width:100%; border-collapse:collapse; border-radius:6px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.05); }\r\n+th, td { border:1px solid #333; padding:10px; text-align:center; }\r\n+th { background:#e5c3a6; font-weight:600; }\r\n+tr:nth-child(even) { background:#fdf5ef; }\r\n+tr:hover { background:#ffe8d0; }\r\n+.search-box { margin:10px 0 15px; }\r\n+input, select { padding:6px; border:1px solid #ccc; border-radius:4px; outline:none; }\r\n+input:focus, select:focus { border-color:#b89172; }\r\n+.action-btn { padding:5px 10px; border:none; border-radius:4px; cursor:pointer; margin:2px; }\r\n+.btn-edit { background:#4caf50; color:#fff; }\r\n+.btn-save { background:#2196f3; color:#fff; }\r\n+.btn-cancel { background:#777; color:#fff; }\r\n+.btn-delete { background:#f44336; color:#fff; }\r\n+.btn-pdf { margin-top:20px; background:#f77c7c; color:#000; padding:10px 25px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; transition:background 0.3s; }\r\n+.btn-pdf:hover { background:#f55c5c; }\r\n+\r\n+/* Print */\r\n+@media print {\r\n+    @page { size:A4 portrait; margin:5mm; }\r\n+    body { background:#fff; margin:0; font-size:12pt; }\r\n+    .sidebar, .search-box, .btn-pdf, .action-btn, .topbar { display:none !important; }\r\n+    .content { margin:0; padding:0; }\r\n+    table { border-collapse:collapse; width:100%; border:2px solid #000; margin:0; box-sizing:border-box; }\r\n+    th, td { border:1px solid #000; padding:6px; text-align:center; box-sizing:border-box; }\r\n+}\r\n </style>\r\n </head>\r\n <body>\r\n-\r\n <div class=\"sidebar\">\r\n-    <a href=\"all_quotations1.php\">ใบเสนอราคา</a>\r\n-    <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n-    <a href=\"all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"#\">ใบเสนอราคา</a>\r\n+    <a href=\"#\">ใบส่งของ</a>\r\n+    <a href=\"#\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n-<div class=\"topbar\"><img src=\"../pic/logo.png\" alt=\"LOGO\"></div>\r\n-<h2>รายการใบเสร็จรับเงิน</h2>\r\n+    <div class=\"topbar\">\r\n+        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n+    </div>\r\n \r\n-<div class=\"search-box\">\r\n-<label for=\"searchColumn\">ค้นหาโดย: </label>\r\n-<select id=\"searchColumn\">\r\n-<option value=\"1\">เลขที่ใบเสร็จ</option>\r\n-<option value=\"2\">ชื่อลูกค้า</option>\r\n-</select>\r\n-<input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n-<label for=\"rowsPerPage\">แสดงแถว: </label>\r\n-<select id=\"rowsPerPage\">\r\n-<option value=\"5\">5</option>\r\n-<option value=\"10\" selected>10</option>\r\n-<option value=\"20\">20</option>\r\n-<option value=\"50\">50</option>\r\n-</select>\r\n-</div>\r\n+    <h2>รายการใบเสร็จรับเงิน</h2>\r\n \r\n-<table id=\"receiptTable\">\r\n-<thead>\r\n-<tr>\r\n-<th>ลำดับ</th>\r\n-<th>เลขที่ใบเสร็จ</th>\r\n-<th>ชื่อลูกค้า</th>\r\n-<th>ที่อยู่ลูกค้า</th>\r\n-<th>รายการ</th>\r\n-<th>จำนวน</th>\r\n-<th>ราคา</th>\r\n-<th>หน่วย</th>\r\n-<th>ราคารวม</th>\r\n-<th>จัดการ</th>\r\n-</tr>\r\n-</thead>\r\n-<tbody>\r\n-<?php\r\n-$no = 1;\r\n-if($result->num_rows>0){\r\n-    while($row=$result->fetch_assoc()){\r\n-        echo \"<tr data-id='\".$row['item_id'].\"'>\";\r\n-        echo \"<td>\".$no++.\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['order_no']).\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['customer_name']).\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['customer_address']).\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['item_name']).\"</td>\";\r\n-        echo \"<td class='editable col-qty'>\".$row['qty'].\"</td>\";\r\n-        echo \"<td class='editable col-price'>\".number_format($row['price'],2).\"</td>\";\r\n-        echo \"<td class='editable'>\".htmlspecialchars($row['unit']).\"</td>\";\r\n-        echo \"<td class='editable col-total'>\".number_format($row['total'],2).\"</td>\";\r\n-        echo \"<td>\r\n-        <button class='action-btn btn-edit'>แก้ไข</button>\r\n-        <button class='action-btn btn-delete'>ลบ</button>\r\n-        </td>\";\r\n-        echo \"</tr>\";\r\n-    }\r\n-}else{\r\n-    echo \"<tr><td colspan='10'>ยังไม่มีข้อมูล</td></tr>\";\r\n-}\r\n-?>\r\n-</tbody>\r\n-</table>\r\n+    <div class=\"search-box\">\r\n+        <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n+        <select id=\"searchColumn\">\r\n+            <option value=\"1\">เลขที่ใบเสร็จ</option>\r\n+            <option value=\"2\">ชื่อลูกค้า</option>\r\n+        </select>\r\n+        <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+        <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n+        <select id=\"rowsPerPage\">\r\n+            <option value=\"5\">5</option>\r\n+            <option value=\"10\" selected>10</option>\r\n+            <option value=\"20\">20</option>\r\n+            <option value=\"50\">50</option>\r\n+        </select>\r\n+    </div>\r\n \r\n-<button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n-<button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-<button class=\"btn-upload\" onclick=\"window.open('../receipts_add.html','_blank')\">เพิ่มใบเสร็จ</button>\r\n+    <table id=\"receiptTable\">\r\n+        <thead>\r\n+            <tr>\r\n+                <th>ลำดับ</th>\r\n+                <th>เลขที่ใบเสร็จ</th>\r\n+                <th>ชื่อลูกค้า</th>\r\n+                <th>ที่อยู่ลูกค้า</th>\r\n+                <th>รายการ</th>\r\n+                <th>จำนวน</th>\r\n+                <th>ราคา</th>\r\n+                <th>หน่วย</th>\r\n+                <th>ราคารวม</th>\r\n+                <th>จัดการ</th>\r\n+            </tr>\r\n+        </thead>\r\n+        <tbody>\r\n+        <?php\r\n+        $no=1;\r\n+        if($result->num_rows>0){\r\n+            while($row=$result->fetch_assoc()){\r\n+                echo \"<tr data-id='{$row['item_id']}'>\";\r\n+                echo \"<td>\".$no++.\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['order_no']).\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['customer_name']).\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['customer_address']).\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['item_name']).\"</td>\";\r\n+                echo \"<td class='editable col-qty'>{$row['qty']}</td>\";\r\n+                echo \"<td class='editable col-price'>\".number_format($row['price'],2).\"</td>\";\r\n+                echo \"<td class='editable'>\".htmlspecialchars($row['unit']).\"</td>\";\r\n+                echo \"<td class='editable col-total'>\".number_format($row['total'],2).\"</td>\";\r\n+                echo \"<td>\r\n+                        <button class='action-btn btn-edit'>แก้ไข</button>\r\n+                        <button class='action-btn btn-delete'>ลบ</button>\r\n+                      </td>\";\r\n+                echo \"</tr>\";\r\n+            }\r\n+        }else{\r\n+            echo \"<tr><td colspan='10'>ยังไม่มีข้อมูล</td></tr>\";\r\n+        }\r\n+        ?>\r\n+        </tbody>\r\n+    </table>\r\n+\r\n+    <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n+    <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n+\r\n </div>\r\n \r\n <script>\r\n // ค้นหา\r\n document.getElementById(\"searchInput\").addEventListener(\"keyup\",function(){\r\n     let input=this.value.toLowerCase();\r\n     let table=document.getElementById(\"receiptTable\");\r\n     let rows=table.getElementsByTagName(\"tr\");\r\n-    let column=parseInt(document.getElementById(\"searchColumn\").value);\r\n+    let col=parseInt(document.getElementById(\"searchColumn\").value);\r\n     for(let i=1;i<rows.length;i++){\r\n-        let cell=rows[i].getElementsByTagName(\"td\")[column];\r\n-        rows[i].style.display = cell && cell.textContent.toLowerCase().includes(input) ? \"\" : \"none\";\r\n+        let cell=rows[i].getElementsByTagName(\"td\")[col];\r\n+        if(cell) rows[i].style.display=cell.textContent.toLowerCase().includes(input)?\"\":\"none\";\r\n     }\r\n+    updateTableRows();\r\n });\r\n-// แสดงจำนวนแถว\r\n+\r\n+// จำนวนแถว\r\n function updateTableRows(){\r\n     let rowsPerPage=parseInt(document.getElementById(\"rowsPerPage\").value);\r\n     let table=document.getElementById(\"receiptTable\");\r\n     let rows=table.getElementsByTagName(\"tr\");\r\n@@ -170,60 +179,77 @@\n document.getElementById(\"rowsPerPage\").addEventListener(\"change\",updateTableRows);\r\n updateTableRows();\r\n \r\n // แก้ไข/บันทึก/ยกเลิก\r\n-document.querySelectorAll('.btn-edit').forEach(btn=>{\r\n-    btn.addEventListener('click',function(){\r\n-        let tr=this.closest('tr');\r\n-        let inputs=tr.querySelectorAll('.editable');\r\n-        if(this.textContent==='แก้ไข'){\r\n-            inputs.forEach(td=>{\r\n-                let val=td.textContent;\r\n-                td.innerHTML=\"<input value='\"+val+\"' style='width:100px'>\";\r\n+document.querySelectorAll(\".btn-edit\").forEach(btn=>{\r\n+    btn.addEventListener(\"click\",function(){\r\n+        let row=this.closest(\"tr\");\r\n+        let tds=row.querySelectorAll(\".editable\");\r\n+        if(this.textContent===\"แก้ไข\"){\r\n+            tds.forEach(td=>{\r\n+                let val=td.textContent.trim();\r\n+                td.innerHTML=`<input value=\"${val}\">`;\r\n             });\r\n-            this.textContent='บันทึก';\r\n-            let cancelBtn=document.createElement('button');\r\n-            cancelBtn.textContent='ยกเลิก';\r\n-            cancelBtn.className='action-btn btn-cancel';\r\n+\r\n+            let qtyInput=row.querySelector(\".col-qty input\");\r\n+            let priceInput=row.querySelector(\".col-price input\");\r\n+            let totalCell=row.querySelector(\".col-total\");\r\n+\r\n+            function updateTotal(){\r\n+                let qty=parseFloat(qtyInput.value)||0;\r\n+                let price=parseFloat(priceInput.value)||0;\r\n+                totalCell.innerHTML=`<input value=\"${(qty*price).toFixed(2)}\">`;\r\n+            }\r\n+            qtyInput.addEventListener(\"input\",updateTotal);\r\n+            priceInput.addEventListener(\"input\",updateTotal);\r\n+\r\n+            this.textContent=\"บันทึก\";\r\n+            this.className=\"action-btn btn-save\";\r\n+\r\n+            let cancelBtn=document.createElement(\"button\");\r\n+            cancelBtn.textContent=\"ยกเลิก\";\r\n+            cancelBtn.className=\"action-btn btn-cancel\";\r\n             this.after(cancelBtn);\r\n-            cancelBtn.addEventListener('click',()=>{\r\n-                location.reload(); // คืนค่าเดิม\r\n-            });\r\n-        } else {\r\n-            let data={};\r\n-            inputs.forEach(td=>{\r\n-                let key=td.className.includes('col-qty')?'qty':\r\n-                        td.className.includes('col-price')?'price':\r\n-                        td.className.includes('col-total')?'total':\r\n-                        td.previousElementSibling ? td.previousElementSibling.textContent : td.textContent;\r\n-                data[key]=td.querySelector('input')?td.querySelector('input').value:td.textContent;\r\n-            });\r\n-            let id=tr.dataset.id;\r\n-            fetch('update_receipts_item.php',{\r\n-                method:'POST',\r\n-                headers:{'Content-Type':'application/json'},\r\n-                body:JSON.stringify({id,data})\r\n+            cancelBtn.addEventListener(\"click\",()=>location.reload());\r\n+\r\n+        }else{\r\n+            let id=row.dataset.id;\r\n+            let payload = {\r\n+                id: parseInt(id),\r\n+                order_no: row.querySelector(\"td:nth-child(2) input\").value.trim(),\r\n+                customer_name: row.querySelector(\"td:nth-child(3) input\").value.trim(),\r\n+                customer_address: row.querySelector(\"td:nth-child(4) input\").value.trim(),\r\n+                item_name: row.querySelector(\"td:nth-child(5) input\").value.trim(),\r\n+                qty: parseFloat(row.querySelector(\".col-qty input\").value)||0,\r\n+                price: parseFloat(row.querySelector(\".col-price input\").value)||0,\r\n+                unit: row.querySelector(\"td:nth-child(8) input\").value.trim()\r\n+            };\r\n+\r\n+            fetch(\"update_receipts_item.php\",{\r\n+                method:\"POST\",\r\n+                headers:{\"Content-Type\":\"application/json\"},\r\n+                body:JSON.stringify(payload)\r\n             }).then(r=>r.json()).then(res=>{\r\n                 if(res.success) location.reload();\r\n-                else alert('บันทึกไม่สำเร็จ');\r\n-            });\r\n+                else alert(\"บันทึกไม่สำเร็จ: \" + (res.message || \"\"));\r\n+            }).catch(err=>alert(\"เกิดข้อผิดพลาด: \"+err));\r\n         }\r\n     });\r\n });\r\n \r\n // ลบ\r\n-document.querySelectorAll('.btn-delete').forEach(btn=>{\r\n-    btn.addEventListener('click',function(){\r\n-        if(!confirm('คุณต้องการลบรายการนี้หรือไม่?')) return;\r\n-        let tr=this.closest('tr');\r\n-        let id=tr.dataset.id;\r\n-        fetch('delete_receipts_item.php',{\r\n-            method:'POST',\r\n-            headers:{'Content-Type':'application/json'},\r\n+document.querySelectorAll(\".btn-delete\").forEach(btn=>{\r\n+    btn.addEventListener(\"click\",function(){\r\n+        if(!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n+        let row=this.closest(\"tr\");\r\n+        let id=row.dataset.id;\r\n+        fetch(\"delete_receipts_item.php\",{\r\n+            method:\"POST\",\r\n+            headers:{\"Content-Type\":\"application/json\"},\r\n             body:JSON.stringify({id})\r\n         }).then(r=>r.json()).then(res=>{\r\n-            if(res.success) tr.remove();\r\n-            else alert('ลบไม่สำเร็จ');\r\n+            if(res.success) row.remove();\r\n+            else alert(\"ลบไม่สำเร็จ\");\r\n         });\r\n     });\r\n });\r\n </script>\r\n"
                },
                {
                    "date": 1758613644146,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -193,8 +193,15 @@\n             let qtyInput=row.querySelector(\".col-qty input\");\r\n             let priceInput=row.querySelector(\".col-price input\");\r\n             let totalCell=row.querySelector(\".col-total\");\r\n \r\n+                        function updateTotal() {\r\n+                let qty = parseFloat(qtyInput.value) || 0;\r\n+                let price = parseFloat(priceInput.value) || 0;\r\n+                let total = qty * price;\r\n+                totalCell.innerHTML = `<input value=\"${total.toFixed(2)}\">`;\r\n+            }\r\n+\r\n             function updateTotal(){\r\n                 let qty=parseFloat(qtyInput.value)||0;\r\n                 let price=parseFloat(priceInput.value)||0;\r\n                 totalCell.innerHTML=`<input value=\"${(qty*price).toFixed(2)}\">`;\r\n"
                },
                {
                    "date": 1758613678367,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -193,15 +193,18 @@\n             let qtyInput=row.querySelector(\".col-qty input\");\r\n             let priceInput=row.querySelector(\".col-price input\");\r\n             let totalCell=row.querySelector(\".col-total\");\r\n \r\n-                        function updateTotal() {\r\n+            function updateTotal() {\r\n                 let qty = parseFloat(qtyInput.value) || 0;\r\n                 let price = parseFloat(priceInput.value) || 0;\r\n                 let total = qty * price;\r\n                 totalCell.innerHTML = `<input value=\"${total.toFixed(2)}\">`;\r\n             }\r\n \r\n+            qtyInput.addEventListener(\"input\", updateTotal);\r\n+            priceInput.addEventListener(\"input\", updateTotal);\r\n+\r\n             function updateTotal(){\r\n                 let qty=parseFloat(qtyInput.value)||0;\r\n                 let price=parseFloat(priceInput.value)||0;\r\n                 totalCell.innerHTML=`<input value=\"${(qty*price).toFixed(2)}\">`;\r\n"
                },
                {
                    "date": 1758613693145,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -193,18 +193,8 @@\n             let qtyInput=row.querySelector(\".col-qty input\");\r\n             let priceInput=row.querySelector(\".col-price input\");\r\n             let totalCell=row.querySelector(\".col-total\");\r\n \r\n-            function updateTotal() {\r\n-                let qty = parseFloat(qtyInput.value) || 0;\r\n-                let price = parseFloat(priceInput.value) || 0;\r\n-                let total = qty * price;\r\n-                totalCell.innerHTML = `<input value=\"${total.toFixed(2)}\">`;\r\n-            }\r\n-\r\n-            qtyInput.addEventListener(\"input\", updateTotal);\r\n-            priceInput.addEventListener(\"input\", updateTotal);\r\n-\r\n             function updateTotal(){\r\n                 let qty=parseFloat(qtyInput.value)||0;\r\n                 let price=parseFloat(priceInput.value)||0;\r\n                 totalCell.innerHTML=`<input value=\"${(qty*price).toFixed(2)}\">`;\r\n"
                },
                {
                    "date": 1758613870900,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -72,11 +72,11 @@\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n-    <a href=\"#\">ใบเสนอราคา</a>\r\n-    <a href=\"#\">ใบส่งของ</a>\r\n-    <a href=\"#\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n+    <a href=\"http://localhost/shop/list/all_deliveries2.php\">ใบส่งของ</a>\r\n+    <a href=\"http://localhost/shop/list/all_receipts2.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n"
                },
                {
                    "date": 1758613942747,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,9 +74,9 @@\n <body>\r\n <div class=\"sidebar\">\r\n     <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n     <a href=\"http://localhost/shop/list/all_deliveries2.php\">ใบส่งของ</a>\r\n-    <a href=\"http://localhost/shop/list/all_receipts2.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"http://localhost/shop/list/all_receipts.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n"
                },
                {
                    "date": 1758613950759,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,10 +73,10 @@\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n     <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n-    <a href=\"http://localhost/shop/list/all_deliveries2.php\">ใบส่งของ</a>\r\n-    <a href=\"http://localhost/shop/list/all_receipts.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n+    <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n"
                },
                {
                    "date": 1758639513661,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n <?php\r\n $host = \"localhost\";\r\n $user = \"root\";\r\n $pass = \"\";\r\n-$dbname = \"shop_it\";\r\n+$dbname = \"shop_it2\";\r\n \r\n // เชื่อมต่อฐานข้อมูล\r\n $conn = new mysqli($host, $user, $pass, $dbname);\r\n if ($conn->connect_error) {\r\n@@ -32,51 +32,45 @@\n <!DOCTYPE html>\r\n <html lang=\"th\">\r\n <head>\r\n <meta charset=\"UTF-8\">\r\n-<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n <title>ใบเสร็จรับเงิน</title>\r\n <style>\r\n-body { margin:0; font-family:Tahoma,sans-serif; background:#f9f9ef; }\r\n-.sidebar { width:220px; height:100vh; background:#b89172; float:left; color:#fff; display:flex; flex-direction:column; align-items:center; padding-top:30px; }\r\n-.sidebar a { color:#fff; text-decoration:none; margin:15px 0; display:block; width:100%; text-align:center; transition:background 0.3s; }\r\n-.sidebar a:hover { background: rgba(255,255,255,0.2); border-radius:6px; }\r\n-.content { margin-left:220px; padding:20px; }\r\n-.topbar { background:#d4b295; padding:15px 0; text-align:center; margin-bottom:25px; box-sizing:border-box; border-radius:6px 6px 0 0; box-shadow:0 2px 5px rgba(0,0,0,0.1); }\r\n-.topbar img { max-height:60px; display:block; margin:0 auto; }\r\n-h2 { font-weight:600; color:#4d3a2c; margin:15px 0; }\r\n-table { width:100%; border-collapse:collapse; border-radius:6px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.05); }\r\n-th, td { border:1px solid #333; padding:10px; text-align:center; }\r\n-th { background:#e5c3a6; font-weight:600; }\r\n-tr:nth-child(even) { background:#fdf5ef; }\r\n-tr:hover { background:#ffe8d0; }\r\n-.search-box { margin:10px 0 15px; }\r\n-input, select { padding:6px; border:1px solid #ccc; border-radius:4px; outline:none; }\r\n-input:focus, select:focus { border-color:#b89172; }\r\n-.action-btn { padding:5px 10px; border:none; border-radius:4px; cursor:pointer; margin:2px; }\r\n-.btn-edit { background:#4caf50; color:#fff; }\r\n-.btn-save { background:#2196f3; color:#fff; }\r\n-.btn-cancel { background:#777; color:#fff; }\r\n-.btn-delete { background:#f44336; color:#fff; }\r\n-.btn-pdf { margin-top:20px; background:#f77c7c; color:#000; padding:10px 25px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; transition:background 0.3s; }\r\n-.btn-pdf:hover { background:#f55c5c; }\r\n-\r\n-/* Print */\r\n-@media print {\r\n-    @page { size:A4 portrait; margin:5mm; }\r\n-    body { background:#fff; margin:0; font-size:12pt; }\r\n-    .sidebar, .search-box, .btn-pdf, .action-btn, .topbar { display:none !important; }\r\n-    .content { margin:0; padding:0; }\r\n-    table { border-collapse:collapse; width:100%; border:2px solid #000; margin:0; box-sizing:border-box; }\r\n-    th, td { border:1px solid #000; padding:6px; text-align:center; box-sizing:border-box; }\r\n+body {margin:0;font-family:Tahoma,sans-serif;background:#f9f9ef}\r\n+.sidebar{width:220px;height:100vh;background:#b89172;float:left;color:#fff;display:flex;flex-direction:column;align-items:center;padding-top:30px}\r\n+.sidebar a{color:#fff;text-decoration:none;margin:15px 0;display:block;width:100%;text-align:center;transition:background .3s}\r\n+.sidebar a:hover{background:rgba(255,255,255,0.2);border-radius:6px}\r\n+.content{margin-left:220px;padding:20px}\r\n+.topbar{background:#d4b295;padding:15px 0;text-align:center;margin-bottom:25px;border-radius:6px 6px 0 0;box-shadow:0 2px 5px rgba(0,0,0,0.1)}\r\n+.topbar img{max-height:60px;margin:0 auto;display:block}\r\n+h2{margin:20px 0;font-weight:600;color:#4d3a2c}\r\n+table{width:100%;border-collapse:collapse;box-shadow:0 2px 5px rgba(0,0,0,.05)}\r\n+th,td{border:1px solid #333;padding:10px;text-align:center}\r\n+th{background:#e5c3a6}\r\n+tr:nth-child(even){background:#fdf5ef}\r\n+tr:hover{background:#ffe8d0}\r\n+.search-box{margin:10px 0 15px}\r\n+input,select{padding:8px;border:1px solid #ccc;border-radius:4px}\r\n+input:focus,select:focus{border-color:#b89172}\r\n+.action-btn{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;margin:2px}\r\n+.btn-edit{background:#4caf50;color:#fff}\r\n+.btn-save{background:#2196f3;color:#fff}\r\n+.btn-cancel{background:#777;color:#fff}\r\n+.btn-delete{background:#f44336;color:#fff}\r\n+.btn-pdf{margin-top:20px;background:#f77c7c;color:#000;padding:10px 25px;border:none;border-radius:6px;cursor:pointer;font-weight:bold}\r\n+.btn-pdf:hover{background:#f55c5c}\r\n+@media print{\r\n+    .sidebar,.search-box,.btn-pdf,.btn-edit,.btn-delete{display:none!important}\r\n+    table{border:5px solid #000}\r\n+    table th:last-child,table td:last-child{display:none!important}\r\n }\r\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n-    <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n-    <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n-    <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"all_quotations1.php\">ใบเสนอราคา</a>\r\n+    <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n+    <a href=\"all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n@@ -85,15 +79,15 @@\n \r\n     <h2>รายการใบเสร็จรับเงิน</h2>\r\n \r\n     <div class=\"search-box\">\r\n-        <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n+        <label>ค้นหาโดย: </label>\r\n         <select id=\"searchColumn\">\r\n             <option value=\"1\">เลขที่ใบเสร็จ</option>\r\n             <option value=\"2\">ชื่อลูกค้า</option>\r\n         </select>\r\n         <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n-        <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n+        <label>แสดงแถว: </label>\r\n         <select id=\"rowsPerPage\">\r\n             <option value=\"5\">5</option>\r\n             <option value=\"10\" selected>10</option>\r\n             <option value=\"20\">20</option>\r\n@@ -145,46 +139,44 @@\n     </table>\r\n \r\n     <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-\r\n </div>\r\n \r\n <script>\r\n-// ค้นหา\r\n+// ✅ ค้นหา\r\n document.getElementById(\"searchInput\").addEventListener(\"keyup\",function(){\r\n     let input=this.value.toLowerCase();\r\n-    let table=document.getElementById(\"receiptTable\");\r\n-    let rows=table.getElementsByTagName(\"tr\");\r\n+    let rows=document.querySelectorAll(\"#receiptTable tbody tr\");\r\n     let col=parseInt(document.getElementById(\"searchColumn\").value);\r\n-    for(let i=1;i<rows.length;i++){\r\n-        let cell=rows[i].getElementsByTagName(\"td\")[col];\r\n-        if(cell) rows[i].style.display=cell.textContent.toLowerCase().includes(input)?\"\":\"none\";\r\n-    }\r\n+    rows.forEach(r=>{\r\n+        let cell=r.getElementsByTagName(\"td\")[col];\r\n+        if(cell) r.style.display=cell.textContent.toLowerCase().includes(input)?\"\":\"none\";\r\n+    });\r\n     updateTableRows();\r\n });\r\n \r\n-// จำนวนแถว\r\n+// ✅ จำกัดจำนวนแถว\r\n function updateTableRows(){\r\n     let rowsPerPage=parseInt(document.getElementById(\"rowsPerPage\").value);\r\n-    let table=document.getElementById(\"receiptTable\");\r\n-    let rows=table.getElementsByTagName(\"tr\");\r\n+    let rows=document.querySelectorAll(\"#receiptTable tbody tr\");\r\n     let count=0;\r\n-    for(let i=1;i<rows.length;i++){\r\n-        if(rows[i].style.display!==\"none\"){\r\n+    rows.forEach(r=>{\r\n+        if(r.style.display!==\"none\"){\r\n             count++;\r\n-            rows[i].style.display=(count<=rowsPerPage)?\"\":\"none\";\r\n+            r.style.display=(count<=rowsPerPage)?\"\":\"none\";\r\n         }\r\n-    }\r\n+    });\r\n }\r\n document.getElementById(\"rowsPerPage\").addEventListener(\"change\",updateTableRows);\r\n updateTableRows();\r\n \r\n-// แก้ไข/บันทึก/ยกเลิก\r\n+// ✅ แก้ไข / บันทึก / ยกเลิก\r\n document.querySelectorAll(\".btn-edit\").forEach(btn=>{\r\n     btn.addEventListener(\"click\",function(){\r\n         let row=this.closest(\"tr\");\r\n         let tds=row.querySelectorAll(\".editable\");\r\n+\r\n         if(this.textContent===\"แก้ไข\"){\r\n             tds.forEach(td=>{\r\n                 let val=td.textContent.trim();\r\n                 td.innerHTML=`<input value=\"${val}\">`;\r\n@@ -196,10 +188,12 @@\n \r\n             function updateTotal(){\r\n                 let qty=parseFloat(qtyInput.value)||0;\r\n                 let price=parseFloat(priceInput.value)||0;\r\n-                totalCell.innerHTML=`<input value=\"${(qty*price).toFixed(2)}\">`;\r\n+                let total=qty*price;\r\n+                totalCell.innerHTML=`<input value=\"${total.toFixed(2)}\">`;\r\n             }\r\n+            updateTotal();\r\n             qtyInput.addEventListener(\"input\",updateTotal);\r\n             priceInput.addEventListener(\"input\",updateTotal);\r\n \r\n             this.textContent=\"บันทึก\";\r\n@@ -209,41 +203,34 @@\n             cancelBtn.textContent=\"ยกเลิก\";\r\n             cancelBtn.className=\"action-btn btn-cancel\";\r\n             this.after(cancelBtn);\r\n             cancelBtn.addEventListener(\"click\",()=>location.reload());\r\n-\r\n         }else{\r\n+            let data=[];\r\n+            tds.forEach(td=>{\r\n+                let val=td.querySelector(\"input\").value.trim();\r\n+                data.push(val);\r\n+            });\r\n             let id=row.dataset.id;\r\n-            let payload = {\r\n-                id: parseInt(id),\r\n-                order_no: row.querySelector(\"td:nth-child(2) input\").value.trim(),\r\n-                customer_name: row.querySelector(\"td:nth-child(3) input\").value.trim(),\r\n-                customer_address: row.querySelector(\"td:nth-child(4) input\").value.trim(),\r\n-                item_name: row.querySelector(\"td:nth-child(5) input\").value.trim(),\r\n-                qty: parseFloat(row.querySelector(\".col-qty input\").value)||0,\r\n-                price: parseFloat(row.querySelector(\".col-price input\").value)||0,\r\n-                unit: row.querySelector(\"td:nth-child(8) input\").value.trim()\r\n-            };\r\n-\r\n-            fetch(\"update_receipts_item.php\",{\r\n+            fetch(\"update_receipt_item.php\",{\r\n                 method:\"POST\",\r\n                 headers:{\"Content-Type\":\"application/json\"},\r\n-                body:JSON.stringify(payload)\r\n+                body:JSON.stringify({id,data})\r\n             }).then(r=>r.json()).then(res=>{\r\n                 if(res.success) location.reload();\r\n-                else alert(\"บันทึกไม่สำเร็จ: \" + (res.message || \"\"));\r\n-            }).catch(err=>alert(\"เกิดข้อผิดพลาด: \"+err));\r\n+                else alert(\"บันทึกไม่สำเร็จ\");\r\n+            });\r\n         }\r\n     });\r\n });\r\n \r\n-// ลบ\r\n+// ✅ ลบ\r\n document.querySelectorAll(\".btn-delete\").forEach(btn=>{\r\n     btn.addEventListener(\"click\",function(){\r\n         if(!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n         let row=this.closest(\"tr\");\r\n         let id=row.dataset.id;\r\n-        fetch(\"delete_receipts_item.php\",{\r\n+        fetch(\"delete_receipt_item.php\",{\r\n             method:\"POST\",\r\n             headers:{\"Content-Type\":\"application/json\"},\r\n             body:JSON.stringify({id})\r\n         }).then(r=>r.json()).then(res=>{\r\n@@ -252,8 +239,7 @@\n         });\r\n     });\r\n });\r\n </script>\r\n-\r\n </body>\r\n </html>\r\n <?php $conn->close(); ?>\r\n"
                },
                {
                    "date": 1758639574179,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -169,55 +169,83 @@\n }\r\n document.getElementById(\"rowsPerPage\").addEventListener(\"change\",updateTableRows);\r\n updateTableRows();\r\n \r\n-// ✅ แก้ไข / บันทึก / ยกเลิก\r\n-document.querySelectorAll(\".btn-edit\").forEach(btn=>{\r\n-    btn.addEventListener(\"click\",function(){\r\n-        let row=this.closest(\"tr\");\r\n-        let tds=row.querySelectorAll(\".editable\");\r\n+// ✅ แก้ไข/บันทึก/ยกเลิก\r\n+document.querySelectorAll(\".btn-edit\").forEach(btn => {\r\n+    btn.addEventListener(\"click\", function() {\r\n+        let row = this.closest(\"tr\");\r\n+        let tds = row.querySelectorAll(\".editable\");\r\n \r\n-        if(this.textContent===\"แก้ไข\"){\r\n-            tds.forEach(td=>{\r\n-                let val=td.textContent.trim();\r\n-                td.innerHTML=`<input value=\"${val}\">`;\r\n+        if (this.textContent === \"แก้ไข\") {\r\n+            // แปลงเป็น input\r\n+            tds.forEach(td => {\r\n+                let val = td.textContent.trim();\r\n+                td.innerHTML = `<input value=\"${val}\">`;\r\n             });\r\n \r\n-            let qtyInput=row.querySelector(\".col-qty input\");\r\n-            let priceInput=row.querySelector(\".col-price input\");\r\n-            let totalCell=row.querySelector(\".col-total\");\r\n+            // ✅ จับช่อง qty, price, total\r\n+            let qtyInput = row.querySelector(\".col-qty input\");\r\n+            let priceInput = row.querySelector(\".col-price input\");\r\n+            let totalCell = row.querySelector(\".col-total\");\r\n \r\n-            function updateTotal(){\r\n-                let qty=parseFloat(qtyInput.value)||0;\r\n-                let price=parseFloat(priceInput.value)||0;\r\n-                let total=qty*price;\r\n-                totalCell.innerHTML=`<input value=\"${total.toFixed(2)}\">`;\r\n+            // ฟังก์ชันคำนวณราคารวม\r\n+            function updateTotal() {\r\n+                let qtyStr = qtyInput.value.trim().replace(/,/g, \"\");\r\n+                let priceStr = priceInput.value.trim().replace(/,/g, \"\");\r\n+\r\n+                if (!qtyStr) qtyStr = \"0\";\r\n+                if (!priceStr) priceStr = \"0\";\r\n+\r\n+                let total = parseFloat(qtyStr) * parseFloat(priceStr);\r\n+\r\n+                if (Number.isInteger(total)) {\r\n+                    totalCell.innerHTML = `<input value=\"${total}\">`; // ถ้าเป็นเลขกลม\r\n+                } else {\r\n+                    totalCell.innerHTML = `<input value=\"${total.toFixed(2)}\">`; // ถ้ามีเศษทศนิยม\r\n+                }\r\n             }\r\n+\r\n+            // ✅ คำนวณ total เดิมทันที\r\n             updateTotal();\r\n-            qtyInput.addEventListener(\"input\",updateTotal);\r\n-            priceInput.addEventListener(\"input\",updateTotal);\r\n \r\n-            this.textContent=\"บันทึก\";\r\n-            this.className=\"action-btn btn-save\";\r\n+            qtyInput.addEventListener(\"input\", updateTotal);\r\n+            priceInput.addEventListener(\"input\", updateTotal);\r\n \r\n-            let cancelBtn=document.createElement(\"button\");\r\n-            cancelBtn.textContent=\"ยกเลิก\";\r\n-            cancelBtn.className=\"action-btn btn-cancel\";\r\n+            this.textContent = \"บันทึก\";\r\n+            this.className = \"action-btn btn-save\";\r\n+\r\n+            let cancelBtn = document.createElement(\"button\");\r\n+            cancelBtn.textContent = \"ยกเลิก\";\r\n+            cancelBtn.className = \"action-btn btn-cancel\";\r\n             this.after(cancelBtn);\r\n-            cancelBtn.addEventListener(\"click\",()=>location.reload());\r\n-        }else{\r\n-            let data=[];\r\n-            tds.forEach(td=>{\r\n-                let val=td.querySelector(\"input\").value.trim();\r\n-                data.push(val);\r\n+            cancelBtn.addEventListener(\"click\", () => location.reload());\r\n+\r\n+        } else {\r\n+            // ✅ เก็บค่า input ส่งไป PHP\r\n+            let data = [];\r\n+            tds.forEach(td => {\r\n+                let val = td.querySelector(\"input\").value.trim().replace(/,/g, \"\");\r\n+                let num = parseFloat(val);\r\n+\r\n+                if (!isNaN(num)) {\r\n+                    if (Number.isInteger(num)) {\r\n+                        data.push(num.toString()); // เก็บเป็น int ถ้าเลขกลม เช่น 7500\r\n+                    } else {\r\n+                        data.push(num.toFixed(2)); // เก็บทศนิยมถ้ามี เช่น 7500.50\r\n+                    }\r\n+                } else {\r\n+                    data.push(val); // เผื่อเป็นข้อความ เช่น \"รายการ\"\r\n+                }\r\n             });\r\n-            let id=row.dataset.id;\r\n-            fetch(\"update_receipt_item.php\",{\r\n-                method:\"POST\",\r\n-                headers:{\"Content-Type\":\"application/json\"},\r\n-                body:JSON.stringify({id,data})\r\n-            }).then(r=>r.json()).then(res=>{\r\n-                if(res.success) location.reload();\r\n+            let id = row.dataset.id;\r\n+\r\n+            fetch(\"update_quotations2_item.php\", {\r\n+                method: \"POST\",\r\n+                headers: {\"Content-Type\": \"application/json\"},\r\n+                body: JSON.stringify({id, data})\r\n+            }).then(r => r.json()).then(res => {\r\n+                if (res.success) location.reload();\r\n                 else alert(\"บันทึกไม่สำเร็จ\");\r\n             });\r\n         }\r\n     });\r\n"
                },
                {
                    "date": 1758639625813,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n <?php\r\n $host = \"localhost\";\r\n $user = \"root\";\r\n $pass = \"\";\r\n-$dbname = \"shop_it2\";\r\n+$dbname = \"shop_it\";\r\n \r\n // เชื่อมต่อฐานข้อมูล\r\n $conn = new mysqli($host, $user, $pass, $dbname);\r\n if ($conn->connect_error) {\r\n"
                },
                {
                    "date": 1758639813285,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -238,9 +238,9 @@\n                 }\r\n             });\r\n             let id = row.dataset.id;\r\n \r\n-            fetch(\"update_quotations2_item.php\", {\r\n+            fetch(\"update_receipts_item.php\", {\r\n                 method: \"POST\",\r\n                 headers: {\"Content-Type\": \"application/json\"},\r\n                 body: JSON.stringify({id, data})\r\n             }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758639837352,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -256,9 +256,9 @@\n     btn.addEventListener(\"click\",function(){\r\n         if(!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n         let row=this.closest(\"tr\");\r\n         let id=row.dataset.id;\r\n-        fetch(\"delete_receipt_item.php\",{\r\n+        fetch(\"delete_receipts_item.php\",{\r\n             method:\"POST\",\r\n             headers:{\"Content-Type\":\"application/json\"},\r\n             body:JSON.stringify({id})\r\n         }).then(r=>r.json()).then(res=>{\r\n"
                },
                {
                    "date": 1758639884099,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,11 +66,11 @@\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n-    <a href=\"all_quotations1.php\">ใบเสนอราคา</a>\r\n-    <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n-    <a href=\"all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n+    <a href=\"http://localhost/shop/list/all_deliveries2.php\">ใบส่งของ</a>\r\n+    <a href=\"http://localhost/shop/list/all_receipts2.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n"
                },
                {
                    "date": 1758639915349,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,13 +57,68 @@\n .btn-cancel{background:#777;color:#fff}\r\n .btn-delete{background:#f44336;color:#fff}\r\n .btn-pdf{margin-top:20px;background:#f77c7c;color:#000;padding:10px 25px;border:none;border-radius:6px;cursor:pointer;font-weight:bold}\r\n .btn-pdf:hover{background:#f55c5c}\r\n-@media print{\r\n-    .sidebar,.search-box,.btn-pdf,.btn-edit,.btn-delete{display:none!important}\r\n-    table{border:5px solid #000}\r\n-    table th:last-child,table td:last-child{display:none!important}\r\n+.btn-upload {\r\n+    margin-top: 20px;\r\n+    background: #7cf7b3ff;\r\n+    color: #000;\r\n+    padding: 10px 25px;\r\n+    border: none;\r\n+    border-radius: 6px;\r\n+    cursor: pointer;\r\n+    font-weight: bold;\r\n+    transition: background 0.3s;\r\n }\r\n+.btn-upload:hover {\r\n+    background: #3ad334ff;\r\n+}\r\n+\r\n+\r\n+/* Print PDF */\r\n+@media print {\r\n+    @page {\r\n+        size: A4 portrait;\r\n+        margin: 5mm;\r\n+    }\r\n+\r\n+    body {\r\n+        background: #fff;\r\n+        margin: 0;\r\n+        font-size: 12pt;\r\n+    }\r\n+\r\n+    .sidebar,\r\n+    .search-box,\r\n+    .btn-pdf,\r\n+    .btn-upload,\r\n+    .btn-edit,\r\n+    .btn-delete\r\n+    {\r\n+        display: none !important;\r\n+    }\r\n+\r\n+    table {\r\n+        border-collapse: collapse;\r\n+        width: auto;            /* ขนาดตามเนื้อหา */\r\n+        margin: 0;              /* ชิดซ้ายสุด */\r\n+        border: 5px solid #000; /* เส้นรอบตารางหนาชัด */\r\n+    }\r\n+\r\n+    th, td {\r\n+        border: 1px solid #000; /* เส้นด้านในปกติ */\r\n+        padding: 6px;\r\n+        text-align: center;\r\n+    }\r\n+\r\n+    /* ซ่อนคอลัมน์สุดท้าย */\r\n+    table th:last-child,\r\n+    table td:last-child {\r\n+        display: none !important;\r\n+    }\r\n+\r\n+\r\n+}\r\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n"
                },
                {
                    "date": 1758639981861,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -194,8 +194,9 @@\n     </table>\r\n \r\n     <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n+    <button class=\"btn-upload\" onclick=\"window.open('../quotations2.html', '_blank')\">เพิ่มใบเสนอราคา</button>\r\n </div>\r\n \r\n <script>\r\n // ✅ ค้นหา\r\n"
                },
                {
                    "date": 1758639990886,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -194,9 +194,9 @@\n     </table>\r\n \r\n     <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-    <button class=\"btn-upload\" onclick=\"window.open('../quotations2.html', '_blank')\">เพิ่มใบเสนอราคา</button>\r\n+    <button class=\"btn-upload\" onclick=\"window.open('../quotations2.html', '_blank')\">เพิ่มใบเสร็จ</button>\r\n </div>\r\n \r\n <script>\r\n // ✅ ค้นหา\r\n"
                },
                {
                    "date": 1758640008871,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -194,9 +194,9 @@\n     </table>\r\n \r\n     <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-    <button class=\"btn-upload\" onclick=\"window.open('../quotations2.html', '_blank')\">เพิ่มใบเสร็จ</button>\r\n+    <button class=\"btn-upload\" onclick=\"window.open('../receipts1.html', '_blank')\">เพิ่มใบเสร็จ</button>\r\n </div>\r\n \r\n <script>\r\n // ✅ ค้นหา\r\n"
                },
                {
                    "date": 1758640104934,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -121,9 +121,9 @@\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n-    <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n+    <a href=\"http://localhost/shop/list/all_quotations.php\">ใบเสนอราคา</a>\r\n     <a href=\"http://localhost/shop/list/all_deliveries2.php\">ใบส่งของ</a>\r\n     <a href=\"http://localhost/shop/list/all_receipts2.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n"
                },
                {
                    "date": 1758640112484,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -121,11 +121,11 @@\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n-    <a href=\"http://localhost/shop/list/all_quotations.php\">ใบเสนอราคา</a>\r\n-    <a href=\"http://localhost/shop/list/all_deliveries2.php\">ใบส่งของ</a>\r\n-    <a href=\"http://localhost/shop/list/all_receipts2.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"http://localhost/shop/list/all_quotations1.php\">ใบเสนอราคา</a>\r\n+    <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n+    <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n"
                },
                {
                    "date": 1758693505700,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,31 +34,133 @@\n <head>\r\n <meta charset=\"UTF-8\">\r\n <title>ใบเสร็จรับเงิน</title>\r\n <style>\r\n-body {margin:0;font-family:Tahoma,sans-serif;background:#f9f9ef}\r\n-.sidebar{width:220px;height:100vh;background:#b89172;float:left;color:#fff;display:flex;flex-direction:column;align-items:center;padding-top:30px}\r\n-.sidebar a{color:#fff;text-decoration:none;margin:15px 0;display:block;width:100%;text-align:center;transition:background .3s}\r\n-.sidebar a:hover{background:rgba(255,255,255,0.2);border-radius:6px}\r\n-.content{margin-left:220px;padding:20px}\r\n-.topbar{background:#d4b295;padding:15px 0;text-align:center;margin-bottom:25px;border-radius:6px 6px 0 0;box-shadow:0 2px 5px rgba(0,0,0,0.1)}\r\n-.topbar img{max-height:60px;margin:0 auto;display:block}\r\n-h2{margin:20px 0;font-weight:600;color:#4d3a2c}\r\n-table{width:100%;border-collapse:collapse;box-shadow:0 2px 5px rgba(0,0,0,.05)}\r\n-th,td{border:1px solid #333;padding:10px;text-align:center}\r\n-th{background:#e5c3a6}\r\n-tr:nth-child(even){background:#fdf5ef}\r\n-tr:hover{background:#ffe8d0}\r\n-.search-box{margin:10px 0 15px}\r\n-input,select{padding:8px;border:1px solid #ccc;border-radius:4px}\r\n-input:focus,select:focus{border-color:#b89172}\r\n-.action-btn{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;margin:2px}\r\n-.btn-edit{background:#4caf50;color:#fff}\r\n-.btn-save{background:#2196f3;color:#fff}\r\n-.btn-cancel{background:#777;color:#fff}\r\n-.btn-delete{background:#f44336;color:#fff}\r\n-.btn-pdf{margin-top:20px;background:#f77c7c;color:#000;padding:10px 25px;border:none;border-radius:6px;cursor:pointer;font-weight:bold}\r\n-.btn-pdf:hover{background:#f55c5c}\r\n+body {\r\n+    margin: 0;\r\n+    font-family: Tahoma, sans-serif;\r\n+    background: #eeece6ff;\r\n+}\r\n+\r\n+/* Sidebar */\r\n+.sidebar {\r\n+    width: 220px;\r\n+    height: 100vh;\r\n+    background: #57564F;\r\n+    float: left;\r\n+    color: #fff;\r\n+    display: flex;\r\n+    flex-direction: column;\r\n+    align-items: center;\r\n+    padding-top: 30px;\r\n+}\r\n+.sidebar a {\r\n+    color: #fff;\r\n+    text-decoration: none;\r\n+    margin: 15px 0;\r\n+    display: block;\r\n+    width: 100%;\r\n+    text-align: center;\r\n+    transition: background 0.3s;\r\n+}\r\n+.sidebar a:hover {\r\n+    background: #57564F;\r\n+    border-radius: 6px;\r\n+}\r\n+\r\n+/* Content */\r\n+.content {\r\n+    margin-left: 220px;\r\n+    padding: 20px;\r\n+}\r\n+\r\n+/* Topbar */\r\n+.topbar {\r\n+    background: #7A7A73;\r\n+    padding: 15px 0;\r\n+    text-align: center;\r\n+    margin-bottom: 25px;\r\n+    box-sizing: border-box;\r\n+    border-radius: 6px 6px 0 0;\r\n+    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\r\n+}\r\n+.topbar img {\r\n+    max-height: 60px;\r\n+    display: block;\r\n+    margin: 0 auto;\r\n+}\r\n+\r\n+/* Headline */\r\n+h2 {\r\n+    margin: 20px 0;\r\n+    font-weight: 600;\r\n+    color: #4d3a2c;\r\n+}\r\n+\r\n+/* Table */\r\n+table {\r\n+    width: 100%;\r\n+    border-collapse: collapse;\r\n+    border-radius: 6px;\r\n+    overflow: hidden;\r\n+    box-shadow: 0 2px 5px rgba(0,0,0,0.05);\r\n+}\r\n+th, td {\r\n+    border: 1px solid #ccc;\r\n+    padding: 10px;\r\n+    text-align: center;\r\n+    transition: background 0.3s;\r\n+}\r\n+th {\r\n+    background: #7A7A73;\r\n+    font-weight: 600;\r\n+    color: #fff; /* ทำให้ตัวอักษรเป็นสีขาว */\r\n+}\r\n+tr:nth-child(even) {\r\n+    background: #fdf5ef;\r\n+}\r\n+tr:hover {\r\n+    background: #DDDAD0;\r\n+}\r\n+\r\n+/* Search box */\r\n+.search-box {\r\n+    margin: 10px 0 15px;\r\n+}\r\n+input, select {\r\n+    padding: 8px;\r\n+    border: 1px solid #ccc;\r\n+    border-radius: 4px;\r\n+    outline: none;\r\n+}\r\n+input:focus, select:focus {\r\n+    border-color: #b89172;\r\n+}\r\n+\r\n+/* PDF button */\r\n+.btn-pdf {\r\n+    margin-top: 20px;\r\n+    background: #f77c7c;\r\n+    color: #000;\r\n+    padding: 10px 25px;\r\n+    border: none;\r\n+    border-radius: 6px;\r\n+    cursor: pointer;\r\n+    font-weight: bold;\r\n+    transition: background 0.3s;\r\n+}\r\n+.btn-pdf:hover {\r\n+    background: #f55c5c;\r\n+}\r\n+\r\n+.action-btn {\r\n+    padding: 5px 10px;\r\n+    border: none;\r\n+    border-radius: 4px;\r\n+    cursor: pointer;\r\n+    margin: 2px;\r\n+}\r\n+\r\n .btn-upload {\r\n     margin-top: 20px;\r\n     background: #7cf7b3ff;\r\n     color: #000;\r\n@@ -72,8 +174,12 @@\n .btn-upload:hover {\r\n     background: #3ad334ff;\r\n }\r\n \r\n+.btn-edit { background: #4caf50; color: #fff; }\r\n+.btn-save { background: #2196f3; color: #fff; }\r\n+.btn-cancel { background: #777; color: #fff; }\r\n+.btn-delete { background: #f44336; color: #fff; }\r\n \r\n /* Print PDF */\r\n @media print {\r\n     @page {\r\n@@ -117,8 +223,9 @@\n     }\r\n \r\n \r\n }\r\n+\r\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n"
                },
                {
                    "date": 1758731676078,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,11 +13,13 @@\n // ดึงข้อมูลจาก receipts + receipt_items\r\n $sql = \"\r\n     SELECT \r\n         i.id AS item_id,\r\n+        r.id AS receipt_id,\r\n         r.order_no,\r\n         r.customer_name,\r\n         r.customer_address,\r\n+        r.pdf_file,\r\n         i.item_name,\r\n         i.qty,\r\n         i.price,\r\n         i.unit,\r\n"
                },
                {
                    "date": 1758731702424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -270,8 +270,9 @@\n                 <th>จำนวน</th>\r\n                 <th>ราคา</th>\r\n                 <th>หน่วย</th>\r\n                 <th>ราคารวม</th>\r\n+                <th>PDF</th>\r\n                 <th>จัดการ</th>\r\n             </tr>\r\n         </thead>\r\n         <tbody>\r\n"
                },
                {
                    "date": 1758731759446,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -289,9 +289,13 @@\n                 echo \"<td class='editable col-qty'>{$row['qty']}</td>\";\r\n                 echo \"<td class='editable col-price'>\".number_format($row['price'],2).\"</td>\";\r\n                 echo \"<td class='editable'>\".htmlspecialchars($row['unit']).\"</td>\";\r\n                 echo \"<td class='editable col-total'>\".number_format($row['total'],2).\"</td>\";\r\n+                $pdf_file = $row['pdf_file'] ?? \"\";\r\n+                $pdf_link = $pdf_file ? \"../\".$pdf_file : \"#\";\r\n+                echo \"<td><a class='action-btn btn-viewpdf' href='{$pdf_link}' target='_blank'>ดู PDF</a></td>\";\r\n                 echo \"<td>\r\n+                echo \"<td>\r\n                         <button class='action-btn btn-edit'>แก้ไข</button>\r\n                         <button class='action-btn btn-delete'>ลบ</button>\r\n                       </td>\";\r\n                 echo \"</tr>\";\r\n"
                },
                {
                    "date": 1758731764755,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -293,9 +293,8 @@\n                 $pdf_file = $row['pdf_file'] ?? \"\";\r\n                 $pdf_link = $pdf_file ? \"../\".$pdf_file : \"#\";\r\n                 echo \"<td><a class='action-btn btn-viewpdf' href='{$pdf_link}' target='_blank'>ดู PDF</a></td>\";\r\n                 echo \"<td>\r\n-                echo \"<td>\r\n                         <button class='action-btn btn-edit'>แก้ไข</button>\r\n                         <button class='action-btn btn-delete'>ลบ</button>\r\n                       </td>\";\r\n                 echo \"</tr>\";\r\n"
                },
                {
                    "date": 1758731829305,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -311,33 +311,39 @@\n     <button class=\"btn-upload\" onclick=\"window.open('../receipts1.html', '_blank')\">เพิ่มใบเสร็จ</button>\r\n </div>\r\n \r\n <script>\r\n-// ✅ ค้นหา\r\n-document.getElementById(\"searchInput\").addEventListener(\"keyup\",function(){\r\n-    let input=this.value.toLowerCase();\r\n-    let rows=document.querySelectorAll(\"#receiptTable tbody tr\");\r\n-    let col=parseInt(document.getElementById(\"searchColumn\").value);\r\n-    rows.forEach(r=>{\r\n-        let cell=r.getElementsByTagName(\"td\")[col];\r\n-        if(cell) r.style.display=cell.textContent.toLowerCase().includes(input)?\"\":\"none\";\r\n-    });\r\n-    updateTableRows();\r\n+// ✅ ฟังก์ชันค้นหา\r\n+document.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n+    let input = this.value.toLowerCase();\r\n+    let table = document.getElementById(\"quotationTable\");\r\n+    let rows = table.getElementsByTagName(\"tr\");\r\n+    let column = parseInt(document.getElementById(\"searchColumn\").value);\r\n+\r\n+    for (let i = 1; i < rows.length; i++) {\r\n+        let cell = rows[i].getElementsByTagName(\"td\")[column];\r\n+        if (cell) {\r\n+            let text = cell.textContent.toLowerCase();\r\n+            rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n+        }\r\n+    }\r\n });\r\n \r\n-// ✅ จำกัดจำนวนแถว\r\n-function updateTableRows(){\r\n-    let rowsPerPage=parseInt(document.getElementById(\"rowsPerPage\").value);\r\n-    let rows=document.querySelectorAll(\"#receiptTable tbody tr\");\r\n-    let count=0;\r\n-    rows.forEach(r=>{\r\n-        if(r.style.display!==\"none\"){\r\n+// ✅ ฟังก์ชันเลือกจำนวนแถว\r\n+function updateTableRows() {\r\n+    let rowsPerPage = parseInt(document.getElementById(\"rowsPerPage\").value);\r\n+    let table = document.getElementById(\"quotationTable\");\r\n+    let rows = table.getElementsByTagName(\"tr\");\r\n+\r\n+    let count = 0;\r\n+    for (let i = 1; i < rows.length; i++) {\r\n+        if (rows[i].style.display !== \"none\") {\r\n             count++;\r\n-            r.style.display=(count<=rowsPerPage)?\"\":\"none\";\r\n+            rows[i].style.display = (count <= rowsPerPage) ? \"\" : \"none\";\r\n         }\r\n-    });\r\n+    }\r\n }\r\n-document.getElementById(\"rowsPerPage\").addEventListener(\"change\",updateTableRows);\r\n+document.getElementById(\"rowsPerPage\").addEventListener(\"change\", updateTableRows);\r\n updateTableRows();\r\n \r\n // ✅ แก้ไข/บันทึก/ยกเลิก\r\n document.querySelectorAll(\".btn-edit\").forEach(btn => {\r\n@@ -407,9 +413,9 @@\n                 }\r\n             });\r\n             let id = row.dataset.id;\r\n \r\n-            fetch(\"update_receipts_item.php\", {\r\n+            fetch(\"update_quotations2_item.php\", {\r\n                 method: \"POST\",\r\n                 headers: {\"Content-Type\": \"application/json\"},\r\n                 body: JSON.stringify({id, data})\r\n             }).then(r => r.json()).then(res => {\r\n@@ -419,24 +425,27 @@\n         }\r\n     });\r\n });\r\n \r\n+\r\n // ✅ ลบ\r\n-document.querySelectorAll(\".btn-delete\").forEach(btn=>{\r\n-    btn.addEventListener(\"click\",function(){\r\n-        if(!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n-        let row=this.closest(\"tr\");\r\n-        let id=row.dataset.id;\r\n-        fetch(\"delete_receipts_item.php\",{\r\n-            method:\"POST\",\r\n-            headers:{\"Content-Type\":\"application/json\"},\r\n-            body:JSON.stringify({id})\r\n-        }).then(r=>r.json()).then(res=>{\r\n-            if(res.success) row.remove();\r\n+document.querySelectorAll(\".btn-delete\").forEach(btn => {\r\n+    btn.addEventListener(\"click\", function() {\r\n+        if (!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n+        let row = this.closest(\"tr\");\r\n+        let id = row.dataset.id;\r\n+\r\n+        fetch(\"delete_quotations2_item.php\", {\r\n+            method: \"POST\",\r\n+            headers: {\"Content-Type\": \"application/json\"},\r\n+            body: JSON.stringify({id})\r\n+        }).then(r => r.json()).then(res => {\r\n+            if (res.success) row.remove();\r\n             else alert(\"ลบไม่สำเร็จ\");\r\n         });\r\n     });\r\n });\r\n </script>\r\n+\r\n </body>\r\n </html>\r\n <?php $conn->close(); ?>\r\n"
                },
                {
                    "date": 1758731855008,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -433,9 +433,9 @@\n         if (!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n         let row = this.closest(\"tr\");\r\n         let id = row.dataset.id;\r\n \r\n-        fetch(\"delete_quotations2_item.php\", {\r\n+        fetch(\"delete_update_receipts_item.php\", {\r\n             method: \"POST\",\r\n             headers: {\"Content-Type\": \"application/json\"},\r\n             body: JSON.stringify({id})\r\n         }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758731860391,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -433,9 +433,9 @@\n         if (!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n         let row = this.closest(\"tr\");\r\n         let id = row.dataset.id;\r\n \r\n-        fetch(\"delete_update_receipts_item.php\", {\r\n+        fetch(\"delete_receipts_item.php\", {\r\n             method: \"POST\",\r\n             headers: {\"Content-Type\": \"application/json\"},\r\n             body: JSON.stringify({id})\r\n         }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758731903746,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -413,9 +413,9 @@\n                 }\r\n             });\r\n             let id = row.dataset.id;\r\n \r\n-            fetch(\"update_quotations2_item.php\", {\r\n+            fetch(\"update_receipts_item.php\", {\r\n                 method: \"POST\",\r\n                 headers: {\"Content-Type\": \"application/json\"},\r\n                 body: JSON.stringify({id, data})\r\n             }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758732150010,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -314,9 +314,9 @@\n <script>\r\n // ✅ ฟังก์ชันค้นหา\r\n document.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n     let input = this.value.toLowerCase();\r\n-    let table = document.getElementById(\"quotationTable\");\r\n+    let table = document.getElementById(\"receiptTable\");\r\n     let rows = table.getElementsByTagName(\"tr\");\r\n     let column = parseInt(document.getElementById(\"searchColumn\").value);\r\n \r\n     for (let i = 1; i < rows.length; i++) {\r\n"
                },
                {
                    "date": 1758732162810,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -330,9 +330,10 @@\n \r\n // ✅ ฟังก์ชันเลือกจำนวนแถว\r\n function updateTableRows() {\r\n     let rowsPerPage = parseInt(document.getElementById(\"rowsPerPage\").value);\r\n-    let table = document.getElementById(\"quotationTable\");\r\n+    let table = document.getElementById(\"receiptTable\");\r\n+\r\n     let rows = table.getElementsByTagName(\"tr\");\r\n \r\n     let count = 0;\r\n     for (let i = 1; i < rows.length; i++) {\r\n"
                },
                {
                    "date": 1758769945078,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -185,49 +185,82 @@\n /* Print PDF */\r\n @media print {\r\n     @page {\r\n         size: A4 portrait;\r\n-        margin: 5mm;\r\n+        margin: 10mm;\r\n     }\r\n \r\n     body {\r\n         background: #fff;\r\n         margin: 0;\r\n         font-size: 12pt;\r\n+        display: flex;\r\n+        justify-content: center;\r\n     }\r\n \r\n     .sidebar,\r\n     .search-box,\r\n     .btn-pdf,\r\n     .btn-upload,\r\n     .btn-edit,\r\n-    .btn-delete\r\n-    {\r\n+    .btn-delete {\r\n         display: none !important;\r\n     }\r\n \r\n-    table {\r\n+    #deliveryTable {\r\n         border-collapse: collapse;\r\n-        width: auto;            /* ขนาดตามเนื้อหา */\r\n-        margin: 0;              /* ชิดซ้ายสุด */\r\n-        border: 5px solid #000; /* เส้นรอบตารางหนาชัด */\r\n+        margin: auto;\r\n+        border: 3px solid #000; /* เส้นรอบนอก */\r\n     }\r\n \r\n-    th, td {\r\n-        border: 1px solid #000; /* เส้นด้านในปกติ */\r\n-        padding: 6px;\r\n+    #deliveryTable th,\r\n+    #deliveryTable td {\r\n+        border: 1.5px solid #000; /* เส้นด้านใน */\r\n+        padding: 8px;\r\n         text-align: center;\r\n     }\r\n \r\n-    /* ซ่อนคอลัมน์สุดท้าย */\r\n-    table th:last-child,\r\n-    table td:last-child {\r\n+    /* ขีดเส้นหนารอบตาราง */\r\n+    #deliveryTable tr:first-child th {\r\n+        border-top: 3px solid #000;   /* เส้นบน */\r\n+    }\r\n+\r\n+    #deliveryTable tr th:first-child,\r\n+    #deliveryTable tr td:first-child {\r\n+        border-left: 3px solid #000;  /* เส้นซ้าย */\r\n+    }\r\n+\r\n+    #deliveryTable tr th:last-child,\r\n+    #deliveryTable tr td:last-child {\r\n+        border-right: 3px solid #000; /* เส้นขวา */\r\n+    }\r\n+\r\n+    /* ซ่อน 2 คอลัมน์สุดท้าย (PDF + จัดการ) */\r\n+    #deliveryTable th:nth-last-child(-n+2),\r\n+    #deliveryTable td:nth-last-child(-n+2) {\r\n         display: none !important;\r\n     }\r\n \r\n+    /* ขีดเส้นหนารอบตาราง */\r\n+#deliveryTable {\r\n+    border-collapse: collapse;\r\n+    margin: auto;\r\n+    border-top: 3px solid #000;    /* เส้นบน */\r\n+    border-bottom: 3px solid #000; /* เส้นล่าง */\r\n+    border-left: 3px solid #000;   /* เส้นซ้าย */\r\n+    border-right: 3px solid #000;  /* เส้นขวา */\r\n+}\r\n \r\n+#deliveryTable th,\r\n+#deliveryTable td {\r\n+    border: 1.5px solid #000; /* เส้นด้านใน */\r\n+    padding: 8px;\r\n+    text-align: center;\r\n }\r\n \r\n+\r\n+}\r\n+\r\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n@@ -331,9 +364,8 @@\n // ✅ ฟังก์ชันเลือกจำนวนแถว\r\n function updateTableRows() {\r\n     let rowsPerPage = parseInt(document.getElementById(\"rowsPerPage\").value);\r\n     let table = document.getElementById(\"receiptTable\");\r\n-\r\n     let rows = table.getElementsByTagName(\"tr\");\r\n \r\n     let count = 0;\r\n     for (let i = 1; i < rows.length; i++) {\r\n"
                },
                {
                    "date": 1758770386955,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -223,9 +223,9 @@\n     #deliveryTable tr:first-child th {\r\n         border-top: 3px solid #000;   /* เส้นบน */\r\n     }\r\n \r\n-    #deliveryTable tr th:first-child,\r\n+    #receiptTable tr th:first-child,\r\n     #deliveryTable tr td:first-child {\r\n         border-left: 3px solid #000;  /* เส้นซ้าย */\r\n     }\r\n \r\n"
                },
                {
                    "date": 1758770452158,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -205,9 +205,9 @@\n     .btn-delete {\r\n         display: none !important;\r\n     }\r\n \r\n-    #deliveryTable {\r\n+    #receiptTable {\r\n         border-collapse: collapse;\r\n         margin: auto;\r\n         border: 3px solid #000; /* เส้นรอบนอก */\r\n     }\r\n@@ -219,9 +219,9 @@\n         text-align: center;\r\n     }\r\n \r\n     /* ขีดเส้นหนารอบตาราง */\r\n-    #deliveryTable tr:first-child th {\r\n+    #receiptTable tr:first-child th {\r\n         border-top: 3px solid #000;   /* เส้นบน */\r\n     }\r\n \r\n     #receiptTable tr th:first-child,\r\n"
                },
                {
                    "date": 1758770459943,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -211,10 +211,10 @@\n         margin: auto;\r\n         border: 3px solid #000; /* เส้นรอบนอก */\r\n     }\r\n \r\n-    #deliveryTable th,\r\n-    #deliveryTable td {\r\n+    #receiptTable th,\r\n+    #receiptTable td {\r\n         border: 1.5px solid #000; /* เส้นด้านใน */\r\n         padding: 8px;\r\n         text-align: center;\r\n     }\r\n"
                },
                {
                    "date": 1758770467039,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -224,9 +224,9 @@\n         border-top: 3px solid #000;   /* เส้นบน */\r\n     }\r\n \r\n     #receiptTable tr th:first-child,\r\n-    #deliveryTable tr td:first-child {\r\n+    #receiptTable tr td:first-child {\r\n         border-left: 3px solid #000;  /* เส้นซ้าย */\r\n     }\r\n \r\n     #deliveryTable tr th:last-child,\r\n"
                },
                {
                    "date": 1758770476229,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -234,10 +234,10 @@\n         border-right: 3px solid #000; /* เส้นขวา */\r\n     }\r\n \r\n     /* ซ่อน 2 คอลัมน์สุดท้าย (PDF + จัดการ) */\r\n-    #deliveryTable th:nth-last-child(-n+2),\r\n-    #deliveryTable td:nth-last-child(-n+2) {\r\n+    #receiptTable th:nth-last-child(-n+2),\r\n+    #receiptTable td:nth-last-child(-n+2) {\r\n         display: none !important;\r\n     }\r\n \r\n     /* ขีดเส้นหนารอบตาราง */\r\n"
                },
                {
                    "date": 1758770483770,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -240,18 +240,18 @@\n         display: none !important;\r\n     }\r\n \r\n     /* ขีดเส้นหนารอบตาราง */\r\n-#deliveryTable {\r\n+#receiptTable {\r\n     border-collapse: collapse;\r\n     margin: auto;\r\n     border-top: 3px solid #000;    /* เส้นบน */\r\n     border-bottom: 3px solid #000; /* เส้นล่าง */\r\n     border-left: 3px solid #000;   /* เส้นซ้าย */\r\n     border-right: 3px solid #000;  /* เส้นขวา */\r\n }\r\n \r\n-#deliveryTable th,\r\n+#receiptTable th,\r\n #deliveryTable td {\r\n     border: 1.5px solid #000; /* เส้นด้านใน */\r\n     padding: 8px;\r\n     text-align: center;\r\n"
                },
                {
                    "date": 1758770498121,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -228,9 +228,9 @@\n     #receiptTable tr td:first-child {\r\n         border-left: 3px solid #000;  /* เส้นซ้าย */\r\n     }\r\n \r\n-    #deliveryTable tr th:last-child,\r\n+    #receiptTablee tr th:last-child,\r\n     #deliveryTable tr td:last-child {\r\n         border-right: 3px solid #000; /* เส้นขวา */\r\n     }\r\n \r\n@@ -250,9 +250,9 @@\n     border-right: 3px solid #000;  /* เส้นขวา */\r\n }\r\n \r\n #receiptTable th,\r\n-#deliveryTable td {\r\n+#receiptTable td {\r\n     border: 1.5px solid #000; /* เส้นด้านใน */\r\n     padding: 8px;\r\n     text-align: center;\r\n }\r\n"
                },
                {
                    "date": 1758770604937,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -228,10 +228,10 @@\n     #receiptTable tr td:first-child {\r\n         border-left: 3px solid #000;  /* เส้นซ้าย */\r\n     }\r\n \r\n-    #receiptTablee tr th:last-child,\r\n-    #deliveryTable tr td:last-child {\r\n+    #receiptTable tr th:last-child,\r\n+    #receiptTable tr td:last-child {\r\n         border-right: 3px solid #000; /* เส้นขวา */\r\n     }\r\n \r\n     /* ซ่อน 2 คอลัมน์สุดท้าย (PDF + จัดการ) */\r\n@@ -257,8 +257,9 @@\n     text-align: center;\r\n }\r\n \r\n \r\n+\r\n }\r\n \r\n </style>\r\n </head>\r\n"
                },
                {
                    "date": 1758770616172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -256,8 +256,12 @@\n     padding: 8px;\r\n     text-align: center;\r\n }\r\n \r\n+    /* ขีดเส้นหนารอบตาราง */\r\n+#receiptTable th tr:first-child th {\r\n+    border-top: 3px solid #000;   /* เส้นบน */\r\n+}\r\n \r\n \r\n }\r\n \r\n"
                },
                {
                    "date": 1758770623207,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -257,9 +257,9 @@\n     text-align: center;\r\n }\r\n \r\n     /* ขีดเส้นหนารอบตาราง */\r\n-#receiptTable th tr:first-child th {\r\n+#receiptTable th, #receiptTable tr:first-child th {\r\n     border-top: 3px solid #000;   /* เส้นบน */\r\n }\r\n \r\n \r\n"
                },
                {
                    "date": 1758770629912,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -257,9 +257,9 @@\n     text-align: center;\r\n }\r\n \r\n     /* ขีดเส้นหนารอบตาราง */\r\n-#receiptTable th, #receiptTable tr:first-child th {\r\n+#deliveryTable tr:first-child th {\r\n     border-top: 3px solid #000;   /* เส้นบน */\r\n }\r\n \r\n \r\n"
                },
                {
                    "date": 1758770636771,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -257,9 +257,9 @@\n     text-align: center;\r\n }\r\n \r\n     /* ขีดเส้นหนารอบตาราง */\r\n-#deliveryTable tr:first-child th {\r\n+#receiptTable  tr:first-child th {\r\n     border-top: 3px solid #000;   /* เส้นบน */\r\n }\r\n \r\n \r\n"
                },
                {
                    "date": 1758770965142,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -184,9 +184,9 @@\n \r\n /* Print PDF */\r\n @media print {\r\n     @page {\r\n-        size: A4 portrait;\r\n+        size: A3 portrait;\r\n         margin: 10mm;\r\n     }\r\n \r\n     body {\r\n@@ -218,54 +218,37 @@\n         padding: 8px;\r\n         text-align: center;\r\n     }\r\n \r\n-    /* ขีดเส้นหนารอบตาราง */\r\n+    /* เส้นหนารอบบน */\r\n     #receiptTable tr:first-child th {\r\n-        border-top: 3px solid #000;   /* เส้นบน */\r\n+        border-top: 3px solid #000;\r\n     }\r\n \r\n+    /* เส้นหนาซ้าย */\r\n     #receiptTable tr th:first-child,\r\n     #receiptTable tr td:first-child {\r\n-        border-left: 3px solid #000;  /* เส้นซ้าย */\r\n+        border-left: 3px solid #000;\r\n     }\r\n \r\n+    /* เส้นหนาขวา */\r\n     #receiptTable tr th:last-child,\r\n     #receiptTable tr td:last-child {\r\n-        border-right: 3px solid #000; /* เส้นขวา */\r\n+        border-right: 3px solid #000;\r\n     }\r\n \r\n+    /* เส้นหนาล่างสุด */\r\n+    #receiptTable tr:last-child td {\r\n+        border-bottom: 3px solid #000;\r\n+    }\r\n+\r\n     /* ซ่อน 2 คอลัมน์สุดท้าย (PDF + จัดการ) */\r\n     #receiptTable th:nth-last-child(-n+2),\r\n     #receiptTable td:nth-last-child(-n+2) {\r\n         display: none !important;\r\n     }\r\n-\r\n-    /* ขีดเส้นหนารอบตาราง */\r\n-#receiptTable {\r\n-    border-collapse: collapse;\r\n-    margin: auto;\r\n-    border-top: 3px solid #000;    /* เส้นบน */\r\n-    border-bottom: 3px solid #000; /* เส้นล่าง */\r\n-    border-left: 3px solid #000;   /* เส้นซ้าย */\r\n-    border-right: 3px solid #000;  /* เส้นขวา */\r\n }\r\n \r\n-#receiptTable th,\r\n-#receiptTable td {\r\n-    border: 1.5px solid #000; /* เส้นด้านใน */\r\n-    padding: 8px;\r\n-    text-align: center;\r\n-}\r\n-\r\n-    /* ขีดเส้นหนารอบตาราง */\r\n-#receiptTable  tr:first-child th {\r\n-    border-top: 3px solid #000;   /* เส้นบน */\r\n-}\r\n-\r\n-\r\n-}\r\n-\r\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n"
                }
            ],
            "date": 1758552087197,
            "name": "Commit-0",
            "content": "<?php\r\n$host = \"localhost\";\r\n$user = \"root\";\r\n$pass = \"\";\r\n$dbname = \"shop_it\";\r\n\r\n// เชื่อมต่อฐานข้อมูล\r\n$conn = new mysqli($host, $user, $pass, $dbname);\r\nif ($conn->connect_error) {\r\n    die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n}\r\n\r\n// ดึงข้อมูลจากตาราง receipts + receipt_items\r\n$sql = \"\r\n    SELECT \r\n        r.order_no,\r\n        r.customer_name,\r\n        r.customer_address,\r\n        i.item_name,\r\n        i.qty,\r\n        i.price,\r\n        i.unit,\r\n        i.total\r\n    FROM receipts r\r\n    JOIN receipt_items i ON i.receipt_id = r.id\r\n    ORDER BY r.id, i.id\r\n\";\r\n$result = $conn->query($sql);\r\n?>\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"th\">\r\n<head>\r\n<meta charset=\"UTF-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n<title>ใบเสร็จรับเงิน</title>\r\n<style>\r\nbody {\r\n    margin: 0;\r\n    font-family: Tahoma, sans-serif;\r\n    background: #f9f9ef;\r\n}\r\n\r\n/* Sidebar */\r\n.sidebar {\r\n    width: 220px;\r\n    height: 100vh;\r\n    background: #b89172;\r\n    float: left;\r\n    color: #fff;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    padding-top: 30px;\r\n}\r\n.sidebar a {\r\n    color: #fff;\r\n    text-decoration: none;\r\n    margin: 15px 0;\r\n    display: block;\r\n    width: 100%;\r\n    text-align: center;\r\n    transition: background 0.3s;\r\n}\r\n.sidebar a:hover {\r\n    background: rgba(255,255,255,0.2);\r\n    border-radius: 6px;\r\n}\r\n\r\n/* Content */\r\n.content {\r\n    margin-left: 220px;\r\n    padding: 20px;\r\n}\r\n\r\n/* Topbar */\r\n.topbar {\r\n    background: #d4b295;\r\n    padding: 15px 0;\r\n    text-align: center;\r\n    margin-bottom: 25px;\r\n    box-sizing: border-box;\r\n    border-radius: 6px 6px 0 0;\r\n    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\r\n}\r\n.topbar img {\r\n    max-height: 60px;\r\n    display: block;\r\n    margin: 0 auto;\r\n}\r\n\r\n/* Headline */\r\nh2, h3 {\r\n    font-weight: 600;\r\n    color: #4d3a2c;\r\n    margin: 15px 0;\r\n}\r\n\r\n/* Table */\r\ntable {\r\n    width: 100%;\r\n    border-collapse: collapse;\r\n    border-radius: 6px;\r\n    overflow: hidden;\r\n    box-shadow: 0 2px 5px rgba(0,0,0,0.05);\r\n}\r\nth, td {\r\n    border: 1px solid #333; /* เส้นชัด */\r\n    padding: 10px;\r\n    text-align: center;\r\n}\r\nth {\r\n    background: #e5c3a6;\r\n    font-weight: 600;\r\n}\r\ntr:nth-child(even) {\r\n    background: #fdf5ef;\r\n}\r\ntr:hover {\r\n    background: #ffe8d0;\r\n}\r\n\r\n/* Search box */\r\n.search-box {\r\n    margin: 10px 0 15px;\r\n}\r\ninput, select, textarea {\r\n    padding: 6px;\r\n    border: 1px solid #ccc;\r\n    border-radius: 4px;\r\n    outline: none;\r\n}\r\ninput:focus, select:focus, textarea:focus {\r\n    border-color: #b89172;\r\n}\r\n\r\n/* PDF button */\r\n.btn-pdf {\r\n    margin-top: 20px;\r\n    background: #f77c7c;\r\n    color: #000;\r\n    padding: 10px 25px;\r\n    border: none;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    font-weight: bold;\r\n    transition: background 0.3s;\r\n}\r\n.btn-pdf:hover {\r\n    background: #f55c5c;\r\n}\r\n\r\n/* Print PDF */\r\n@media print {\r\n    @page { size: A5 portrait; margin: 5mm; }\r\n    body { background: #fff; margin: 0; font-size: 12pt; }\r\n    .sidebar, .search-box, .btn-pdf, .topbar { display: none !important; }\r\n    .content { margin: 0; padding: 0; }\r\n    table { border-collapse: collapse; width: 100%; border: 2px solid #000; margin: 0; box-sizing: border-box; }\r\n    th, td { border: 1px solid #000; padding: 6px; text-align: center; box-sizing: border-box; }\r\n    tr:nth-child(even) { background: #fdf5ef; }\r\n}\r\n</style>\r\n</head>\r\n<body>\r\n<div class=\"sidebar\">\r\n    <a href=\"all_quotations1.php\">ใบเสนอราคา</a>\r\n    <a href=\"all_deliveries1.php\">ใบส่งของ</a>\r\n    <a href=\"#\">ใบเสร็จรับเงิน</a>\r\n</div>\r\n\r\n<div class=\"content\">\r\n    <div class=\"topbar\">\r\n        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n    </div>\r\n\r\n    <h2>รายการใบเสร็จรับเงิน</h2>\r\n\r\n    <div class=\"search-box\">\r\n        <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n        <select id=\"searchColumn\">\r\n            <option value=\"1\">เลขที่ใบเสร็จ</option>\r\n            <option value=\"2\">ชื่อลูกค้า</option>\r\n        </select>\r\n        <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n    </div>\r\n\r\n    <table id=\"receiptTable\">\r\n        <thead>\r\n            <tr>\r\n                <th>ลำดับ</th>\r\n                <th>เลขที่ใบเสร็จ</th>\r\n                <th>ชื่อลูกค้า</th>\r\n                <th>ที่อยู่ลูกค้า</th>\r\n                <th>รายการ</th>\r\n                <th>จำนวน</th>\r\n                <th>ราคา</th>\r\n                <th>หน่วย</th>\r\n                <th>ราคารวม</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            <?php\r\n            $no = 1;\r\n            if ($result->num_rows > 0) {\r\n                while($row = $result->fetch_assoc()) {\r\n                    echo \"<tr>\";\r\n                    echo \"<td>\" . $no++ . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['order_no']) . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['customer_name']) . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['customer_address']) . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n                    echo \"<td>\" . $row['qty'] . \"</td>\";\r\n                    echo \"<td>\" . number_format($row['price'],2) . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n                    echo \"<td>\" . number_format($row['total'],2) . \"</td>\";\r\n                    echo \"</tr>\";\r\n                }\r\n            } else {\r\n                echo \"<tr><td colspan='9'>ยังไม่มีข้อมูล</td></tr>\";\r\n            }\r\n            ?>\r\n        </tbody>\r\n    </table>\r\n\r\n    <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n</div>\r\n\r\n<script>\r\n// ฟังก์ชันค้นหา (client side)\r\ndocument.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n    let input = this.value.toLowerCase();\r\n    let table = document.getElementById(\"receiptTable\");\r\n    let rows = table.getElementsByTagName(\"tr\");\r\n    let column = parseInt(document.getElementById(\"searchColumn\").value);\r\n\r\n    for (let i = 1; i < rows.length; i++) {\r\n        let cell = rows[i].getElementsByTagName(\"td\")[column];\r\n        if (cell) {\r\n            let text = cell.textContent.toLowerCase();\r\n            rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n        }\r\n    }\r\n});\r\n</script>\r\n\r\n</body>\r\n</html>\r\n\r\n<?php $conn->close(); ?>\r\n"
        }
    ]
}