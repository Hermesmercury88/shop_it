{
    "sourceFile": "list/all_quotations2.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 26,
            "patches": [
                {
                    "date": 1758552406754,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1758552414050,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -200,9 +200,9 @@\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n-    <a href=\"http://localhost/shop/list/all_quotations1.php\">ใบเสนอราคา</a>\r\n+    <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n     <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n     <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n"
                },
                {
                    "date": 1758552419766,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -201,10 +201,10 @@\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n     <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n-    <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n-    <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"http://localhost/shop/list/all_deliveries2.php\">ใบส่งของ</a>\r\n+    <a href=\"http://localhost/shop/list/all_receipts2.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n"
                },
                {
                    "date": 1758552432779,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -210,9 +210,9 @@\n     <div class=\"topbar\">\r\n         <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n     </div>\r\n \r\n-    <h2>รายการใบเสนอราคา</h2>\r\n+    <h2>รใบเสนอราคา</h2>\r\n \r\n     <div class=\"search-box\">\r\n         <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n         <select id=\"searchColumn\">\r\n"
                },
                {
                    "date": 1758552454835,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -207,12 +207,12 @@\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n-        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n+        <img src=\"../pic/mylogo.png\" alt=\"LOGO\">\r\n     </div>\r\n \r\n-    <h2>รใบเสนอราคา</h2>\r\n+    <h2>ใบเสนอราคา</h2>\r\n \r\n     <div class=\"search-box\">\r\n         <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n         <select id=\"searchColumn\">\r\n"
                },
                {
                    "date": 1758552462550,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n <?php\r\n $host = \"localhost\";\r\n $user = \"root\";\r\n $pass = \"\";\r\n-$dbname = \"shop_it\";\r\n+$dbname = \"shop_it2\";\r\n \r\n // เชื่อมต่อฐานข้อมูล\r\n $conn = new mysqli($host, $user, $pass, $dbname);\r\n if ($conn->connect_error) {\r\n"
                },
                {
                    "date": 1758552792738,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -260,9 +260,14 @@\n             ?>\r\n         </tbody>\r\n     </table>\r\n \r\n+    <div style=\"margin-top: 20px; display: flex; gap: 10px;\">\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n+    <button style=\"padding: 10px 10px; background:#b89172; color:#fff; border:none; border-radius:6px; cursor:pointer; font-weight:bold;\"\r\n+            onclick=\"window.location.href='../index.html'\">\r\n+        กลับหน้าหลัก\r\n+    </button>\r\n </div>\r\n \r\n <script>\r\n // ฟังก์ชันค้นหา (client side)\r\n"
                },
                {
                    "date": 1758554014199,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -284,8 +284,27 @@\n             rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n         }\r\n     }\r\n });\r\n+\r\n+// ✅ ฟังก์ชันเลือกจำนวนแถวที่จะแสดง\r\n+function updateTableRows() {\r\n+    let rowsPerPage = parseInt(document.getElementById(\"rowsPerPage\").value);\r\n+    let table = document.getElementById(\"deliveryTable\");\r\n+    let rows = table.getElementsByTagName(\"tr\");\r\n+\r\n+    let count = 0;\r\n+    for (let i = 1; i < rows.length; i++) {\r\n+        if (rows[i].style.display !== \"none\") { // ถ้าไม่ได้ถูกซ่อนจากการค้นหา\r\n+            count++;\r\n+            rows[i].style.display = (count <= rowsPerPage) ? \"\" : \"none\";\r\n+        }\r\n+    }\r\n+}\r\n+\r\n+document.getElementById(\"rowsPerPage\").addEventListener(\"change\", updateTableRows);\r\n+// เรียกตอนโหลดหน้า\r\n+updateTableRows();\r\n </script>\r\n \r\n </body>\r\n </html>\r\n"
                },
                {
                    "date": 1758554033609,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -220,8 +220,16 @@\n             <option value=\"2\">เรื่อง</option>\r\n             <option value=\"3\">เรียน</option>\r\n         </select>\r\n         <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+        <!-- ✅ เพิ่มตัวเลือกจำนวนแถว -->\r\n+        <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n+        <select id=\"rowsPerPage\">\r\n+            <option value=\"5\">5</option>\r\n+            <option value=\"10\" selected>10</option>\r\n+            <option value=\"20\">20</option>\r\n+            <option value=\"50\">50</option>\r\n+        </select>\r\n     </div>\r\n \r\n     <table id=\"quotationTable\">\r\n         <thead>\r\n@@ -303,8 +311,9 @@\n \r\n document.getElementById(\"rowsPerPage\").addEventListener(\"change\", updateTableRows);\r\n // เรียกตอนโหลดหน้า\r\n updateTableRows();\r\n+\r\n </script>\r\n \r\n </body>\r\n </html>\r\n"
                },
                {
                    "date": 1758554242737,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -220,8 +220,9 @@\n             <option value=\"2\">เรื่อง</option>\r\n             <option value=\"3\">เรียน</option>\r\n         </select>\r\n         <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+\r\n         <!-- ✅ เพิ่มตัวเลือกจำนวนแถว -->\r\n         <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n         <select id=\"rowsPerPage\">\r\n             <option value=\"5\">5</option>\r\n@@ -296,9 +297,9 @@\n \r\n // ✅ ฟังก์ชันเลือกจำนวนแถวที่จะแสดง\r\n function updateTableRows() {\r\n     let rowsPerPage = parseInt(document.getElementById(\"rowsPerPage\").value);\r\n-    let table = document.getElementById(\"deliveryTable\");\r\n+    let table = document.getElementById(\"quotationTable\");\r\n     let rows = table.getElementsByTagName(\"tr\");\r\n \r\n     let count = 0;\r\n     for (let i = 1; i < rows.length; i++) {\r\n"
                },
                {
                    "date": 1758554649964,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -269,14 +269,10 @@\n             ?>\r\n         </tbody>\r\n     </table>\r\n \r\n-    <div style=\"margin-top: 20px; display: flex; gap: 10px;\">\r\n+    <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-    <button style=\"padding: 10px 10px; background:#b89172; color:#fff; border:none; border-radius:6px; cursor:pointer; font-weight:bold;\"\r\n-            onclick=\"window.location.href='../index.html'\">\r\n-        กลับหน้าหลัก\r\n-    </button>\r\n </div>\r\n \r\n <script>\r\n // ฟังก์ชันค้นหา (client side)\r\n"
                },
                {
                    "date": 1758611343002,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n <?php\r\n $host = \"localhost\";\r\n $user = \"root\";\r\n $pass = \"\";\r\n-$dbname = \"shop_it2\";\r\n+$dbname = \"shop_it\";\r\n \r\n // เชื่อมต่อฐานข้อมูล\r\n $conn = new mysqli($host, $user, $pass, $dbname);\r\n if ($conn->connect_error) {\r\n@@ -12,8 +12,9 @@\n \r\n // ดึงข้อมูลจากตาราง quotations + quotation_items\r\n $sql = \"\r\n     SELECT \r\n+        i.id AS item_id,\r\n         q.quotation_no,\r\n         q.subject,\r\n         q.recipient_name,\r\n         i.item_name,\r\n@@ -135,9 +136,21 @@\n input:focus, select:focus {\r\n     border-color: #b89172;\r\n }\r\n \r\n-/* PDF button */\r\n+/* ปุ่ม */\r\n+.action-btn {\r\n+    padding: 5px 10px;\r\n+    border: none;\r\n+    border-radius: 4px;\r\n+    cursor: pointer;\r\n+    margin: 2px;\r\n+}\r\n+.btn-edit { background: #4caf50; color: #fff; }\r\n+.btn-save { background: #2196f3; color: #fff; }\r\n+.btn-cancel { background: #777; color: #fff; }\r\n+.btn-delete { background: #f44336; color: #fff; }\r\n+\r\n .btn-pdf {\r\n     margin-top: 20px;\r\n     background: #f77c7c;\r\n     color: #000;\r\n@@ -151,14 +164,29 @@\n .btn-pdf:hover {\r\n     background: #f55c5c;\r\n }\r\n \r\n+.btn-upload {\r\n+    margin-top: 20px;\r\n+    background: #7cf7b3ff;\r\n+    color: #000;\r\n+    padding: 10px 25px;\r\n+    border: none;\r\n+    border-radius: 6px;\r\n+    cursor: pointer;\r\n+    font-weight: bold;\r\n+    transition: background 0.3s;\r\n+}\r\n+.btn-upload:hover {\r\n+    background: #3ad334ff;\r\n+}\r\n+\r\n+\r\n /* Print PDF */\r\n-/* Print PDF */\r\n @media print {\r\n     @page {\r\n-        size: A5 portrait;\r\n-        margin: 5mm;  /* กระชับขอบทุกด้าน */\r\n+        size: A4 portrait;\r\n+        margin: 5mm;\r\n     }\r\n \r\n     body {\r\n         background: #fff;\r\n@@ -167,49 +195,51 @@\n     }\r\n \r\n     .sidebar,\r\n     .search-box,\r\n-    .btn-pdf{\r\n+    .btn-pdf,\r\n+    .btn-upload,\r\n+    .btn-edit,\r\n+    .btn-delete\r\n+    {\r\n         display: none !important;\r\n     }\r\n \r\n-    .content {\r\n-        margin: 0;\r\n-        padding: 0;\r\n-    }\r\n-\r\n     table {\r\n         border-collapse: collapse;\r\n-        width: 100%;\r\n-        border: 2px solid #000;  /* ขอบชัดทุกด้าน */\r\n-        margin: 0;\r\n-        box-sizing: border-box;\r\n+        width: auto;            /* ขนาดตามเนื้อหา */\r\n+        margin: 0;              /* ชิดซ้ายสุด */\r\n+        border: 5px solid #000; /* เส้นรอบตารางหนาชัด */\r\n     }\r\n \r\n     th, td {\r\n-        border: 1px solid #000;  /* เส้นชัด */\r\n+        border: 1px solid #000; /* เส้นด้านในปกติ */\r\n         padding: 6px;\r\n         text-align: center;\r\n-        box-sizing: border-box;\r\n     }\r\n \r\n-    tr:nth-child(even) {\r\n-        background: #fdf5ef;\r\n+    /* ซ่อนคอลัมน์สุดท้าย */\r\n+    table th:last-child,\r\n+    table td:last-child {\r\n+        display: none !important;\r\n     }\r\n+\r\n+\r\n }\r\n \r\n+\r\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n-    <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n-    <a href=\"http://localhost/shop/list/all_deliveries2.php\">ใบส่งของ</a>\r\n-    <a href=\"http://localhost/shop/list/all_receipts2.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"http://localhost/shop/list/all_quotations1.php\">ใบเสนอราคา</a>\r\n+    <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n+    <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n-        <img src=\"../pic/mylogo.png\" alt=\"LOGO\">\r\n+        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n     </div>\r\n \r\n     <h2>ใบเสนอราคา</h2>\r\n \r\n@@ -221,9 +251,8 @@\n             <option value=\"3\">เรียน</option>\r\n         </select>\r\n         <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n \r\n-        <!-- ✅ เพิ่มตัวเลือกจำนวนแถว -->\r\n         <label for=\"rowsPerPage\">แสดงแถว: </label>\r\n         <select id=\"rowsPerPage\">\r\n             <option value=\"5\">5</option>\r\n             <option value=\"10\" selected>10</option>\r\n@@ -243,40 +272,46 @@\n                 <th>จำนวน</th>\r\n                 <th>ราคา</th>\r\n                 <th>หน่วย</th>\r\n                 <th>ราคารวม</th>\r\n+                <th>จัดการ</th>\r\n             </tr>\r\n         </thead>\r\n         <tbody>\r\n             <?php\r\n             $no = 1;\r\n             if ($result->num_rows > 0) {\r\n                 while($row = $result->fetch_assoc()) {\r\n-                    echo \"<tr>\";\r\n+                    echo \"<tr data-id='\" . $row['item_id'] . \"'>\";\r\n                     echo \"<td>\" . $no++ . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['quotation_no']) . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['subject']) . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['recipient_name']) . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n-                    echo \"<td>\" . $row['qty'] . \"</td>\";\r\n-                    echo \"<td>\" . number_format($row['price'],2) . \"</td>\";\r\n-                    echo \"<td>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n-                    echo \"<td>\" . number_format($row['total'],2) . \"</td>\";\r\n+                    echo \"<td class='editable'>\" . htmlspecialchars($row['quotation_no']) . \"</td>\";\r\n+                    echo \"<td class='editable'>\" . htmlspecialchars($row['subject']) . \"</td>\";\r\n+                    echo \"<td class='editable'>\" . htmlspecialchars($row['recipient_name']) . \"</td>\";\r\n+                    echo \"<td class='editable'>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n+                    echo \"<td class='editable col-qty'>\" . $row['qty'] . \"</td>\";\r\n+                    echo \"<td class='editable col-price'>\" . number_format($row['price'],2) . \"</td>\";\r\n+                    echo \"<td class='editable'>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n+                    echo \"<td class='editable col-total'>\" . number_format($row['total'],2) . \"</td>\";\r\n+                    echo \"<td>\r\n+                            <button class='action-btn btn-edit'>แก้ไข</button>\r\n+                            <button class='action-btn btn-delete'>ลบ</button>\r\n+                          </td>\";\r\n                     echo \"</tr>\";\r\n                 }\r\n             } else {\r\n-                echo \"<tr><td colspan='9'>ยังไม่มีข้อมูล</td></tr>\";\r\n+                echo \"<tr><td colspan='10'>ยังไม่มีข้อมูล</td></tr>\";\r\n             }\r\n             ?>\r\n         </tbody>\r\n     </table>\r\n \r\n     <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n+    <button class=\"btn-upload\" onclick=\"window.open('../quotations1.html', '_blank')\">เพิ่มใบเสนอราคา</button>\r\n </div>\r\n \r\n <script>\r\n-// ฟังก์ชันค้นหา (client side)\r\n+// ✅ ฟังก์ชันค้นหา\r\n document.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n     let input = this.value.toLowerCase();\r\n     let table = document.getElementById(\"quotationTable\");\r\n     let rows = table.getElementsByTagName(\"tr\");\r\n@@ -290,29 +325,100 @@\n         }\r\n     }\r\n });\r\n \r\n-// ✅ ฟังก์ชันเลือกจำนวนแถวที่จะแสดง\r\n+// ✅ ฟังก์ชันเลือกจำนวนแถว\r\n function updateTableRows() {\r\n     let rowsPerPage = parseInt(document.getElementById(\"rowsPerPage\").value);\r\n     let table = document.getElementById(\"quotationTable\");\r\n     let rows = table.getElementsByTagName(\"tr\");\r\n \r\n     let count = 0;\r\n     for (let i = 1; i < rows.length; i++) {\r\n-        if (rows[i].style.display !== \"none\") { // ถ้าไม่ได้ถูกซ่อนจากการค้นหา\r\n+        if (rows[i].style.display !== \"none\") {\r\n             count++;\r\n             rows[i].style.display = (count <= rowsPerPage) ? \"\" : \"none\";\r\n         }\r\n     }\r\n }\r\n-\r\n document.getElementById(\"rowsPerPage\").addEventListener(\"change\", updateTableRows);\r\n-// เรียกตอนโหลดหน้า\r\n updateTableRows();\r\n \r\n+// ✅ แก้ไข/บันทึก/ยกเลิก\r\n+document.querySelectorAll(\".btn-edit\").forEach(btn => {\r\n+    btn.addEventListener(\"click\", function() {\r\n+        let row = this.closest(\"tr\");\r\n+        let tds = row.querySelectorAll(\".editable\");\r\n+\r\n+        if (this.textContent === \"แก้ไข\") {\r\n+            // แปลงเป็น input\r\n+            tds.forEach(td => {\r\n+                let val = td.textContent.trim();\r\n+                td.innerHTML = `<input value=\"${val}\">`;\r\n+            });\r\n+\r\n+            // ✅ จับช่อง qty, price, total\r\n+            let qtyInput = row.querySelector(\".col-qty input\");\r\n+            let priceInput = row.querySelector(\".col-price input\");\r\n+            let totalCell = row.querySelector(\".col-total\");\r\n+\r\n+            // ฟังก์ชันคำนวณราคารวม\r\n+            function updateTotal() {\r\n+                let qty = parseFloat(qtyInput.value) || 0;\r\n+                let price = parseFloat(priceInput.value) || 0;\r\n+                let total = qty * price;\r\n+                totalCell.innerHTML = `<input value=\"${total.toFixed(2)}\">`;\r\n+            }\r\n+\r\n+            qtyInput.addEventListener(\"input\", updateTotal);\r\n+            priceInput.addEventListener(\"input\", updateTotal);\r\n+\r\n+            this.textContent = \"บันทึก\";\r\n+            this.className = \"action-btn btn-save\";\r\n+\r\n+            let cancelBtn = document.createElement(\"button\");\r\n+            cancelBtn.textContent = \"ยกเลิก\";\r\n+            cancelBtn.className = \"action-btn btn-cancel\";\r\n+            this.after(cancelBtn);\r\n+            cancelBtn.addEventListener(\"click\", () => location.reload());\r\n+\r\n+        } else {\r\n+            // เก็บค่า input ส่งไป PHP\r\n+            let data = [];\r\n+            tds.forEach(td => data.push(td.querySelector(\"input\").value));\r\n+            let id = row.dataset.id;\r\n+\r\n+            fetch(\"update_quotations_item.php\", {\r\n+                method: \"POST\",\r\n+                headers: {\"Content-Type\": \"application/json\"},\r\n+                body: JSON.stringify({id, data})\r\n+            }).then(r => r.json()).then(res => {\r\n+                if (res.success) location.reload();\r\n+                else alert(\"บันทึกไม่สำเร็จ\");\r\n+            });\r\n+        }\r\n+    });\r\n+});\r\n+\r\n+\r\n+// ✅ ลบ\r\n+document.querySelectorAll(\".btn-delete\").forEach(btn => {\r\n+    btn.addEventListener(\"click\", function() {\r\n+        if (!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n+        let row = this.closest(\"tr\");\r\n+        let id = row.dataset.id;\r\n+\r\n+        fetch(\"delete_quotations_item.php\", {\r\n+            method: \"POST\",\r\n+            headers: {\"Content-Type\": \"application/json\"},\r\n+            body: JSON.stringify({id})\r\n+        }).then(r => r.json()).then(res => {\r\n+            if (res.success) row.remove();\r\n+            else alert(\"ลบไม่สำเร็จ\");\r\n+        });\r\n+    });\r\n+});\r\n </script>\r\n \r\n </body>\r\n </html>\r\n-\r\n <?php $conn->close(); ?>\r\n"
                },
                {
                    "date": 1758611350610,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -305,9 +305,9 @@\n     </table>\r\n \r\n     <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-    <button class=\"btn-upload\" onclick=\"window.open('../quotations1.html', '_blank')\">เพิ่มใบเสนอราคา</button>\r\n+    <button class=\"btn-upload\" onclick=\"window.open('../quotations2.html', '_blank')\">เพิ่มใบเสนอราคา</button>\r\n </div>\r\n \r\n <script>\r\n // ✅ ฟังก์ชันค้นหา\r\n"
                },
                {
                    "date": 1758611357235,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -230,9 +230,9 @@\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n-    <a href=\"http://localhost/shop/list/all_quotations1.php\">ใบเสนอราคา</a>\r\n+    <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n     <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n     <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n"
                },
                {
                    "date": 1758611372970,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -231,15 +231,15 @@\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n     <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n-    <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n-    <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n+    <a href=\"http://localhost/shop/list/all_deliveries2.php\">ใบส่งของ</a>\r\n+    <a href=\"http://localhost/shop/list/all_receipts2.php\">ใบเสร็จรับเงิน</a>\r\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n-        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n+        <img src=\"../pic/mylogo.png\" alt=\"LOGO\">\r\n     </div>\r\n \r\n     <h2>ใบเสนอราคา</h2>\r\n \r\n"
                },
                {
                    "date": 1758611383638,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n <?php\r\n $host = \"localhost\";\r\n $user = \"root\";\r\n $pass = \"\";\r\n-$dbname = \"shop_it\";\r\n+$dbname = \"shop_it2\";\r\n \r\n // เชื่อมต่อฐานข้อมูล\r\n $conn = new mysqli($host, $user, $pass, $dbname);\r\n if ($conn->connect_error) {\r\n"
                },
                {
                    "date": 1758611405314,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -386,9 +386,9 @@\n             let data = [];\r\n             tds.forEach(td => data.push(td.querySelector(\"input\").value));\r\n             let id = row.dataset.id;\r\n \r\n-            fetch(\"update_quotations_item.php\", {\r\n+            fetch(\"update_quotations2_item.php\", {\r\n                 method: \"POST\",\r\n                 headers: {\"Content-Type\": \"application/json\"},\r\n                 body: JSON.stringify({id, data})\r\n             }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758636504348,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,8 +365,10 @@\n             function updateTotal() {\r\n                 let qty = parseFloat(qtyInput.value) || 0;\r\n                 let price = parseFloat(priceInput.value) || 0;\r\n                 let total = qty * price;\r\n+                // ✅ บังคับ price และ total แสดงทศนิยม 2 หลัก\r\n+                priceInput.value = price.toFixed(2);\r\n                 totalCell.innerHTML = `<input value=\"${total.toFixed(2)}\">`;\r\n             }\r\n \r\n             qtyInput.addEventListener(\"input\", updateTotal);\r\n@@ -406,9 +408,9 @@\n         if (!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n         let row = this.closest(\"tr\");\r\n         let id = row.dataset.id;\r\n \r\n-        fetch(\"delete_quotations_item.php\", {\r\n+        fetch(\"delete_quotations2_item.php\", {\r\n             method: \"POST\",\r\n             headers: {\"Content-Type\": \"application/json\"},\r\n             body: JSON.stringify({id})\r\n         }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758637221443,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,10 +365,8 @@\n             function updateTotal() {\r\n                 let qty = parseFloat(qtyInput.value) || 0;\r\n                 let price = parseFloat(priceInput.value) || 0;\r\n                 let total = qty * price;\r\n-                // ✅ บังคับ price และ total แสดงทศนิยม 2 หลัก\r\n-                priceInput.value = price.toFixed(2);\r\n                 totalCell.innerHTML = `<input value=\"${total.toFixed(2)}\">`;\r\n             }\r\n \r\n             qtyInput.addEventListener(\"input\", updateTotal);\r\n"
                },
                {
                    "date": 1758639072746,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -362,14 +362,26 @@\n             let totalCell = row.querySelector(\".col-total\");\r\n \r\n             // ฟังก์ชันคำนวณราคารวม\r\n             function updateTotal() {\r\n-                let qty = parseFloat(qtyInput.value) || 0;\r\n-                let price = parseFloat(priceInput.value) || 0;\r\n-                let total = qty * price;\r\n-                totalCell.innerHTML = `<input value=\"${total.toFixed(2)}\">`;\r\n+                let qtyStr = qtyInput.value.trim().replace(/,/g, \"\");\r\n+                let priceStr = priceInput.value.trim().replace(/,/g, \"\");\r\n+\r\n+                if (!qtyStr) qtyStr = \"0\";\r\n+                if (!priceStr) priceStr = \"0\";\r\n+\r\n+                let total = parseFloat(qtyStr) * parseFloat(priceStr);\r\n+\r\n+                if (Number.isInteger(total)) {\r\n+                    totalCell.innerHTML = `<input value=\"${total}\">`; // ถ้าเป็นเลขกลม\r\n+                } else {\r\n+                    totalCell.innerHTML = `<input value=\"${total.toFixed(2)}\">`; // ถ้ามีเศษทศนิยม\r\n+                }\r\n             }\r\n \r\n+            // ✅ คำนวณ total เดิมทันที\r\n+            updateTotal();\r\n+\r\n             qtyInput.addEventListener(\"input\", updateTotal);\r\n             priceInput.addEventListener(\"input\", updateTotal);\r\n \r\n             this.textContent = \"บันทึก\";\r\n@@ -381,14 +393,27 @@\n             this.after(cancelBtn);\r\n             cancelBtn.addEventListener(\"click\", () => location.reload());\r\n \r\n         } else {\r\n-            // เก็บค่า input ส่งไป PHP\r\n+            // ✅ เก็บค่า input ส่งไป PHP\r\n             let data = [];\r\n-            tds.forEach(td => data.push(td.querySelector(\"input\").value));\r\n+            tds.forEach(td => {\r\n+                let val = td.querySelector(\"input\").value.trim().replace(/,/g, \"\");\r\n+                let num = parseFloat(val);\r\n+\r\n+                if (!isNaN(num)) {\r\n+                    if (Number.isInteger(num)) {\r\n+                        data.push(num.toString()); // เก็บเป็น int ถ้าเลขกลม เช่น 7500\r\n+                    } else {\r\n+                        data.push(num.toFixed(2)); // เก็บทศนิยมถ้ามี เช่น 7500.50\r\n+                    }\r\n+                } else {\r\n+                    data.push(val); // เผื่อเป็นข้อความ เช่น \"รายการ\"\r\n+                }\r\n+            });\r\n             let id = row.dataset.id;\r\n \r\n-            fetch(\"update_quotations2_item.php\", {\r\n+            fetch(\"update_quotations_item.php\", {\r\n                 method: \"POST\",\r\n                 headers: {\"Content-Type\": \"application/json\"},\r\n                 body: JSON.stringify({id, data})\r\n             }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758693947043,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,16 +39,16 @@\n <style>\r\n body {\r\n     margin: 0;\r\n     font-family: Tahoma, sans-serif;\r\n-    background: #f9f9ef;\r\n+    background: #fdfdf7ff;\r\n }\r\n \r\n /* Sidebar */\r\n .sidebar {\r\n     width: 220px;\r\n     height: 100vh;\r\n-    background: #b89172;\r\n+    background: #456882;\r\n     float: left;\r\n     color: #fff;\r\n     display: flex;\r\n     flex-direction: column;\r\n@@ -76,9 +76,9 @@\n }\r\n \r\n /* Topbar */\r\n .topbar {\r\n-    background: #d4b295;\r\n+    background: #456882;\r\n     padding: 15px 0;\r\n     text-align: center;\r\n     margin-bottom: 25px;\r\n     box-sizing: border-box;\r\n@@ -106,22 +106,23 @@\n     overflow: hidden;\r\n     box-shadow: 0 2px 5px rgba(0,0,0,0.05);\r\n }\r\n th, td {\r\n-    border: 1px solid #333; /* เส้นชัด */\r\n+    border: 1px solid #ccc;\r\n     padding: 10px;\r\n     text-align: center;\r\n     transition: background 0.3s;\r\n }\r\n th {\r\n-    background: #e5c3a6;\r\n+    background: #456882;\r\n     font-weight: 600;\r\n+    color: #fff; /* ทำให้ตัวอักษรเป็นสีขาว */\r\n }\r\n tr:nth-child(even) {\r\n     background: #fdf5ef;\r\n }\r\n tr:hover {\r\n-    background: #ffe8d0;\r\n+    background: #DDDAD0;\r\n }\r\n \r\n /* Search box */\r\n .search-box {\r\n@@ -136,21 +137,9 @@\n input:focus, select:focus {\r\n     border-color: #b89172;\r\n }\r\n \r\n-/* ปุ่ม */\r\n-.action-btn {\r\n-    padding: 5px 10px;\r\n-    border: none;\r\n-    border-radius: 4px;\r\n-    cursor: pointer;\r\n-    margin: 2px;\r\n-}\r\n-.btn-edit { background: #4caf50; color: #fff; }\r\n-.btn-save { background: #2196f3; color: #fff; }\r\n-.btn-cancel { background: #777; color: #fff; }\r\n-.btn-delete { background: #f44336; color: #fff; }\r\n-\r\n+/* PDF button */\r\n .btn-pdf {\r\n     margin-top: 20px;\r\n     background: #f77c7c;\r\n     color: #000;\r\n@@ -164,8 +153,16 @@\n .btn-pdf:hover {\r\n     background: #f55c5c;\r\n }\r\n \r\n+.action-btn {\r\n+    padding: 5px 10px;\r\n+    border: none;\r\n+    border-radius: 4px;\r\n+    cursor: pointer;\r\n+    margin: 2px;\r\n+}\r\n+\r\n .btn-upload {\r\n     margin-top: 20px;\r\n     background: #7cf7b3ff;\r\n     color: #000;\r\n@@ -179,8 +176,12 @@\n .btn-upload:hover {\r\n     background: #3ad334ff;\r\n }\r\n \r\n+.btn-edit { background: #4caf50; color: #fff; }\r\n+.btn-save { background: #2196f3; color: #fff; }\r\n+.btn-cancel { background: #777; color: #fff; }\r\n+.btn-delete { background: #f44336; color: #fff; }\r\n \r\n /* Print PDF */\r\n @media print {\r\n     @page {\r\n@@ -222,12 +223,9 @@\n     table td:last-child {\r\n         display: none !important;\r\n     }\r\n \r\n-\r\n }\r\n-\r\n-\r\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n@@ -411,9 +409,9 @@\n                 }\r\n             });\r\n             let id = row.dataset.id;\r\n \r\n-            fetch(\"update_quotations_item.php\", {\r\n+            fetch(\"update_quotations2_item.php\", {\r\n                 method: \"POST\",\r\n                 headers: {\"Content-Type\": \"application/json\"},\r\n                 body: JSON.stringify({id, data})\r\n             }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758693955665,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,16 +39,16 @@\n <style>\r\n body {\r\n     margin: 0;\r\n     font-family: Tahoma, sans-serif;\r\n-    background: #fdfdf7ff;\r\n+    background: #f9f9ef;\r\n }\r\n \r\n /* Sidebar */\r\n .sidebar {\r\n     width: 220px;\r\n     height: 100vh;\r\n-    background: #456882;\r\n+    background: #b89172;\r\n     float: left;\r\n     color: #fff;\r\n     display: flex;\r\n     flex-direction: column;\r\n@@ -76,9 +76,9 @@\n }\r\n \r\n /* Topbar */\r\n .topbar {\r\n-    background: #456882;\r\n+    background: #d4b295;\r\n     padding: 15px 0;\r\n     text-align: center;\r\n     margin-bottom: 25px;\r\n     box-sizing: border-box;\r\n@@ -106,23 +106,22 @@\n     overflow: hidden;\r\n     box-shadow: 0 2px 5px rgba(0,0,0,0.05);\r\n }\r\n th, td {\r\n-    border: 1px solid #ccc;\r\n+    border: 1px solid #333; /* เส้นชัด */\r\n     padding: 10px;\r\n     text-align: center;\r\n     transition: background 0.3s;\r\n }\r\n th {\r\n-    background: #456882;\r\n+    background: #e5c3a6;\r\n     font-weight: 600;\r\n-    color: #fff; /* ทำให้ตัวอักษรเป็นสีขาว */\r\n }\r\n tr:nth-child(even) {\r\n     background: #fdf5ef;\r\n }\r\n tr:hover {\r\n-    background: #DDDAD0;\r\n+    background: #ffe8d0;\r\n }\r\n \r\n /* Search box */\r\n .search-box {\r\n@@ -137,9 +136,21 @@\n input:focus, select:focus {\r\n     border-color: #b89172;\r\n }\r\n \r\n-/* PDF button */\r\n+/* ปุ่ม */\r\n+.action-btn {\r\n+    padding: 5px 10px;\r\n+    border: none;\r\n+    border-radius: 4px;\r\n+    cursor: pointer;\r\n+    margin: 2px;\r\n+}\r\n+.btn-edit { background: #4caf50; color: #fff; }\r\n+.btn-save { background: #2196f3; color: #fff; }\r\n+.btn-cancel { background: #777; color: #fff; }\r\n+.btn-delete { background: #f44336; color: #fff; }\r\n+\r\n .btn-pdf {\r\n     margin-top: 20px;\r\n     background: #f77c7c;\r\n     color: #000;\r\n@@ -153,16 +164,8 @@\n .btn-pdf:hover {\r\n     background: #f55c5c;\r\n }\r\n \r\n-.action-btn {\r\n-    padding: 5px 10px;\r\n-    border: none;\r\n-    border-radius: 4px;\r\n-    cursor: pointer;\r\n-    margin: 2px;\r\n-}\r\n-\r\n .btn-upload {\r\n     margin-top: 20px;\r\n     background: #7cf7b3ff;\r\n     color: #000;\r\n@@ -176,12 +179,8 @@\n .btn-upload:hover {\r\n     background: #3ad334ff;\r\n }\r\n \r\n-.btn-edit { background: #4caf50; color: #fff; }\r\n-.btn-save { background: #2196f3; color: #fff; }\r\n-.btn-cancel { background: #777; color: #fff; }\r\n-.btn-delete { background: #f44336; color: #fff; }\r\n \r\n /* Print PDF */\r\n @media print {\r\n     @page {\r\n@@ -223,9 +222,12 @@\n     table td:last-child {\r\n         display: none !important;\r\n     }\r\n \r\n+\r\n }\r\n+\r\n+\r\n </style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n"
                },
                {
                    "date": 1758694009933,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,16 +39,16 @@\n <style>\r\n body {\r\n     margin: 0;\r\n     font-family: Tahoma, sans-serif;\r\n-    background: #f9f9ef;\r\n+    background: #fdfdf7ff;\r\n }\r\n \r\n /* Sidebar */\r\n .sidebar {\r\n     width: 220px;\r\n     height: 100vh;\r\n-    background: #b89172;\r\n+    background: #456882;\r\n     float: left;\r\n     color: #fff;\r\n     display: flex;\r\n     flex-direction: column;\r\n@@ -76,9 +76,9 @@\n }\r\n \r\n /* Topbar */\r\n .topbar {\r\n-    background: #d4b295;\r\n+    background: #456882;\r\n     padding: 15px 0;\r\n     text-align: center;\r\n     margin-bottom: 25px;\r\n     box-sizing: border-box;\r\n@@ -106,22 +106,23 @@\n     overflow: hidden;\r\n     box-shadow: 0 2px 5px rgba(0,0,0,0.05);\r\n }\r\n th, td {\r\n-    border: 1px solid #333; /* เส้นชัด */\r\n+    border: 1px solid #ccc;\r\n     padding: 10px;\r\n     text-align: center;\r\n     transition: background 0.3s;\r\n }\r\n th {\r\n-    background: #e5c3a6;\r\n+    background: #456882;\r\n     font-weight: 600;\r\n+    color: #fff; /* ทำให้ตัวอักษรเป็นสีขาว */\r\n }\r\n tr:nth-child(even) {\r\n     background: #fdf5ef;\r\n }\r\n tr:hover {\r\n-    background: #ffe8d0;\r\n+    background: #DDDAD0;\r\n }\r\n \r\n /* Search box */\r\n .search-box {\r\n@@ -136,21 +137,9 @@\n input:focus, select:focus {\r\n     border-color: #b89172;\r\n }\r\n \r\n-/* ปุ่ม */\r\n-.action-btn {\r\n-    padding: 5px 10px;\r\n-    border: none;\r\n-    border-radius: 4px;\r\n-    cursor: pointer;\r\n-    margin: 2px;\r\n-}\r\n-.btn-edit { background: #4caf50; color: #fff; }\r\n-.btn-save { background: #2196f3; color: #fff; }\r\n-.btn-cancel { background: #777; color: #fff; }\r\n-.btn-delete { background: #f44336; color: #fff; }\r\n-\r\n+/* PDF button */\r\n .btn-pdf {\r\n     margin-top: 20px;\r\n     background: #f77c7c;\r\n     color: #000;\r\n@@ -164,8 +153,16 @@\n .btn-pdf:hover {\r\n     background: #f55c5c;\r\n }\r\n \r\n+.action-btn {\r\n+    padding: 5px 10px;\r\n+    border: none;\r\n+    border-radius: 4px;\r\n+    cursor: pointer;\r\n+    margin: 2px;\r\n+}\r\n+\r\n .btn-upload {\r\n     margin-top: 20px;\r\n     background: #7cf7b3ff;\r\n     color: #000;\r\n@@ -179,8 +176,12 @@\n .btn-upload:hover {\r\n     background: #3ad334ff;\r\n }\r\n \r\n+.btn-edit { background: #4caf50; color: #fff; }\r\n+.btn-save { background: #2196f3; color: #fff; }\r\n+.btn-cancel { background: #777; color: #fff; }\r\n+.btn-delete { background: #f44336; color: #fff; }\r\n \r\n /* Print PDF */\r\n @media print {\r\n     @page {\r\n@@ -222,13 +223,11 @@\n     table td:last-child {\r\n         display: none !important;\r\n     }\r\n \r\n-\r\n }\r\n+</style>\r\n \r\n-\r\n-</style>\r\n </head>\r\n <body>\r\n <div class=\"sidebar\">\r\n     <a href=\"http://localhost/shop/list/all_quotations2.php\">ใบเสนอราคา</a>\r\n@@ -240,9 +239,9 @@\n     <div class=\"topbar\">\r\n         <img src=\"../pic/mylogo.png\" alt=\"LOGO\">\r\n     </div>\r\n \r\n-    <h2>ใบเสนอราคา</h2>\r\n+    <h2>รายการใบเสนอราคา</h2>\r\n \r\n     <div class=\"search-box\">\r\n         <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n         <select id=\"searchColumn\">\r\n"
                },
                {
                    "date": 1758729611290,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -236,9 +236,9 @@\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n-        <img src=\"../pic/mylogo.png\" alt=\"LOGO\">\r\n+        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n     </div>\r\n \r\n     <h2>รายการใบเสนอราคา</h2>\r\n \r\n@@ -271,8 +271,9 @@\n                 <th>จำนวน</th>\r\n                 <th>ราคา</th>\r\n                 <th>หน่วย</th>\r\n                 <th>ราคารวม</th>\r\n+                <th>PDF</th>\r\n                 <th>จัดการ</th>\r\n             </tr>\r\n         </thead>\r\n         <tbody>\r\n@@ -289,8 +290,12 @@\n                     echo \"<td class='editable col-qty'>\" . $row['qty'] . \"</td>\";\r\n                     echo \"<td class='editable col-price'>\" . number_format($row['price'],2) . \"</td>\";\r\n                     echo \"<td class='editable'>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n                     echo \"<td class='editable col-total'>\" . number_format($row['total'],2) . \"</td>\";\r\n+                    $pdf_file = isset($row['pdf_file']) ? $row['pdf_file'] : \"\";\r\n+                    $pdf_link = $pdf_file ? \"../uploads/quotations/\" . basename($pdf_file) : \"#\";\r\n+                    echo \"<td><a class='action-btn btn-viewpdf' href='{$pdf_link}' target='_blank'>ดู PDF</a></td>\";\r\n+\r\n                     echo \"<td>\r\n                             <button class='action-btn btn-edit'>แก้ไข</button>\r\n                             <button class='action-btn btn-delete'>ลบ</button>\r\n                           </td>\";\r\n@@ -304,9 +309,9 @@\n     </table>\r\n \r\n     <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-    <button class=\"btn-upload\" onclick=\"window.open('../quotations2.html', '_blank')\">เพิ่มใบเสนอราคา</button>\r\n+    <button class=\"btn-upload\" onclick=\"window.open('../quotations1.html', '_blank')\">เพิ่มใบเสนอราคา</button>\r\n </div>\r\n \r\n <script>\r\n // ✅ ฟังก์ชันค้นหา\r\n@@ -410,9 +415,9 @@\n                 }\r\n             });\r\n             let id = row.dataset.id;\r\n \r\n-            fetch(\"update_quotations2_item.php\", {\r\n+            fetch(\"update_quotations_item.php\", {\r\n                 method: \"POST\",\r\n                 headers: {\"Content-Type\": \"application/json\"},\r\n                 body: JSON.stringify({id, data})\r\n             }).then(r => r.json()).then(res => {\r\n@@ -430,9 +435,9 @@\n         if (!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n         let row = this.closest(\"tr\");\r\n         let id = row.dataset.id;\r\n \r\n-        fetch(\"delete_quotations2_item.php\", {\r\n+        fetch(\"delete_quotations_item.php\", {\r\n             method: \"POST\",\r\n             headers: {\"Content-Type\": \"application/json\"},\r\n             body: JSON.stringify({id})\r\n         }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758729663483,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,11 +13,13 @@\n // ดึงข้อมูลจากตาราง quotations + quotation_items\r\n $sql = \"\r\n     SELECT \r\n         i.id AS item_id,\r\n+        q.id AS quotation_id,\r\n         q.quotation_no,\r\n         q.subject,\r\n         q.recipient_name,\r\n+        q.pdf_file,\r\n         i.item_name,\r\n         i.qty,\r\n         i.price,\r\n         i.unit,\r\n"
                },
                {
                    "date": 1758731214297,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -238,9 +238,9 @@\n </div>\r\n \r\n <div class=\"content\">\r\n     <div class=\"topbar\">\r\n-        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n+        <img src=\"../pic/mylogo.png\" alt=\"LOGO\">\r\n     </div>\r\n \r\n     <h2>รายการใบเสนอราคา</h2>\r\n \r\n@@ -437,9 +437,9 @@\n         if (!confirm(\"คุณต้องการลบข้อมูลนี้หรือไม่?\")) return;\r\n         let row = this.closest(\"tr\");\r\n         let id = row.dataset.id;\r\n \r\n-        fetch(\"delete_quotations_item.php\", {\r\n+        fetch(\"delete_quotations2_item.php\", {\r\n             method: \"POST\",\r\n             headers: {\"Content-Type\": \"application/json\"},\r\n             body: JSON.stringify({id})\r\n         }).then(r => r.json()).then(res => {\r\n"
                },
                {
                    "date": 1758731232512,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -311,9 +311,9 @@\n     </table>\r\n \r\n     <button class=\"btn-pdf\" onclick=\"window.location.href='../index.html'\">กลับหน้าหลัก</button>\r\n     <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n-    <button class=\"btn-upload\" onclick=\"window.open('../quotations1.html', '_blank')\">เพิ่มใบเสนอราคา</button>\r\n+    <button class=\"btn-upload\" onclick=\"window.open('../quotations2.html', '_blank')\">เพิ่มใบเสนอราคา</button>\r\n </div>\r\n \r\n <script>\r\n // ✅ ฟังก์ชันค้นหา\r\n@@ -417,9 +417,9 @@\n                 }\r\n             });\r\n             let id = row.dataset.id;\r\n \r\n-            fetch(\"update_quotations_item.php\", {\r\n+            fetch(\"update_quotations2_item.php\", {\r\n                 method: \"POST\",\r\n                 headers: {\"Content-Type\": \"application/json\"},\r\n                 body: JSON.stringify({id, data})\r\n             }).then(r => r.json()).then(res => {\r\n"
                }
            ],
            "date": 1758552406754,
            "name": "Commit-0",
            "content": "<?php\r\n$host = \"localhost\";\r\n$user = \"root\";\r\n$pass = \"\";\r\n$dbname = \"shop_it\";\r\n\r\n// เชื่อมต่อฐานข้อมูล\r\n$conn = new mysqli($host, $user, $pass, $dbname);\r\nif ($conn->connect_error) {\r\n    die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n}\r\n\r\n// ดึงข้อมูลจากตาราง quotations + quotation_items\r\n$sql = \"\r\n    SELECT \r\n        q.quotation_no,\r\n        q.subject,\r\n        q.recipient_name,\r\n        i.item_name,\r\n        i.qty,\r\n        i.price,\r\n        i.unit,\r\n        i.total\r\n    FROM quotations q\r\n    JOIN quotation_items i ON i.quotation_id = q.id\r\n    ORDER BY q.id, i.id\r\n\";\r\n$result = $conn->query($sql);\r\n?>\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"th\">\r\n<head>\r\n<meta charset=\"UTF-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n<title>ใบเสนอราคา</title>\r\n\r\n<style>\r\nbody {\r\n    margin: 0;\r\n    font-family: Tahoma, sans-serif;\r\n    background: #f9f9ef;\r\n}\r\n\r\n/* Sidebar */\r\n.sidebar {\r\n    width: 220px;\r\n    height: 100vh;\r\n    background: #b89172;\r\n    float: left;\r\n    color: #fff;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    padding-top: 30px;\r\n}\r\n.sidebar a {\r\n    color: #fff;\r\n    text-decoration: none;\r\n    margin: 15px 0;\r\n    display: block;\r\n    width: 100%;\r\n    text-align: center;\r\n    transition: background 0.3s;\r\n}\r\n.sidebar a:hover {\r\n    background: rgba(255,255,255,0.2);\r\n    border-radius: 6px;\r\n}\r\n\r\n/* Content */\r\n.content {\r\n    margin-left: 220px;\r\n    padding: 20px;\r\n}\r\n\r\n/* Topbar */\r\n.topbar {\r\n    background: #d4b295;\r\n    padding: 15px 0;\r\n    text-align: center;\r\n    margin-bottom: 25px;\r\n    box-sizing: border-box;\r\n    border-radius: 6px 6px 0 0;\r\n    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\r\n}\r\n.topbar img {\r\n    max-height: 60px;\r\n    display: block;\r\n    margin: 0 auto;\r\n}\r\n\r\n/* Headline */\r\nh2 {\r\n    margin: 20px 0;\r\n    font-weight: 600;\r\n    color: #4d3a2c;\r\n}\r\n\r\n/* Table */\r\ntable {\r\n    width: 100%;\r\n    border-collapse: collapse;\r\n    border-radius: 6px;\r\n    overflow: hidden;\r\n    box-shadow: 0 2px 5px rgba(0,0,0,0.05);\r\n}\r\nth, td {\r\n    border: 1px solid #333; /* เส้นชัด */\r\n    padding: 10px;\r\n    text-align: center;\r\n    transition: background 0.3s;\r\n}\r\nth {\r\n    background: #e5c3a6;\r\n    font-weight: 600;\r\n}\r\ntr:nth-child(even) {\r\n    background: #fdf5ef;\r\n}\r\ntr:hover {\r\n    background: #ffe8d0;\r\n}\r\n\r\n/* Search box */\r\n.search-box {\r\n    margin: 10px 0 15px;\r\n}\r\ninput, select {\r\n    padding: 8px;\r\n    border: 1px solid #ccc;\r\n    border-radius: 4px;\r\n    outline: none;\r\n}\r\ninput:focus, select:focus {\r\n    border-color: #b89172;\r\n}\r\n\r\n/* PDF button */\r\n.btn-pdf {\r\n    margin-top: 20px;\r\n    background: #f77c7c;\r\n    color: #000;\r\n    padding: 10px 25px;\r\n    border: none;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    font-weight: bold;\r\n    transition: background 0.3s;\r\n}\r\n.btn-pdf:hover {\r\n    background: #f55c5c;\r\n}\r\n\r\n/* Print PDF */\r\n/* Print PDF */\r\n@media print {\r\n    @page {\r\n        size: A5 portrait;\r\n        margin: 5mm;  /* กระชับขอบทุกด้าน */\r\n    }\r\n\r\n    body {\r\n        background: #fff;\r\n        margin: 0;\r\n        font-size: 12pt;\r\n    }\r\n\r\n    .sidebar,\r\n    .search-box,\r\n    .btn-pdf{\r\n        display: none !important;\r\n    }\r\n\r\n    .content {\r\n        margin: 0;\r\n        padding: 0;\r\n    }\r\n\r\n    table {\r\n        border-collapse: collapse;\r\n        width: 100%;\r\n        border: 2px solid #000;  /* ขอบชัดทุกด้าน */\r\n        margin: 0;\r\n        box-sizing: border-box;\r\n    }\r\n\r\n    th, td {\r\n        border: 1px solid #000;  /* เส้นชัด */\r\n        padding: 6px;\r\n        text-align: center;\r\n        box-sizing: border-box;\r\n    }\r\n\r\n    tr:nth-child(even) {\r\n        background: #fdf5ef;\r\n    }\r\n}\r\n\r\n</style>\r\n</head>\r\n<body>\r\n<div class=\"sidebar\">\r\n    <a href=\"http://localhost/shop/list/all_quotations1.php\">ใบเสนอราคา</a>\r\n    <a href=\"http://localhost/shop/list/all_deliveries1.php\">ใบส่งของ</a>\r\n    <a href=\"http://localhost/shop/list/all_receipts1.php\">ใบเสร็จรับเงิน</a>\r\n</div>\r\n\r\n<div class=\"content\">\r\n    <div class=\"topbar\">\r\n        <img src=\"../pic/logo.png\" alt=\"LOGO\">\r\n    </div>\r\n\r\n    <h2>รายการใบเสนอราคา</h2>\r\n\r\n    <div class=\"search-box\">\r\n        <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n        <select id=\"searchColumn\">\r\n            <option value=\"1\">เลขที่ใบเสนอราคา</option>\r\n            <option value=\"2\">เรื่อง</option>\r\n            <option value=\"3\">เรียน</option>\r\n        </select>\r\n        <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n    </div>\r\n\r\n    <table id=\"quotationTable\">\r\n        <thead>\r\n            <tr>\r\n                <th>ลำดับ</th>\r\n                <th>เลขที่ใบเสนอราคา</th>\r\n                <th>เรื่อง</th>\r\n                <th>เรียน</th>\r\n                <th>รายการ</th>\r\n                <th>จำนวน</th>\r\n                <th>ราคา</th>\r\n                <th>หน่วย</th>\r\n                <th>ราคารวม</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            <?php\r\n            $no = 1;\r\n            if ($result->num_rows > 0) {\r\n                while($row = $result->fetch_assoc()) {\r\n                    echo \"<tr>\";\r\n                    echo \"<td>\" . $no++ . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['quotation_no']) . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['subject']) . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['recipient_name']) . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n                    echo \"<td>\" . $row['qty'] . \"</td>\";\r\n                    echo \"<td>\" . number_format($row['price'],2) . \"</td>\";\r\n                    echo \"<td>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n                    echo \"<td>\" . number_format($row['total'],2) . \"</td>\";\r\n                    echo \"</tr>\";\r\n                }\r\n            } else {\r\n                echo \"<tr><td colspan='9'>ยังไม่มีข้อมูล</td></tr>\";\r\n            }\r\n            ?>\r\n        </tbody>\r\n    </table>\r\n\r\n    <button class=\"btn-pdf\" onclick=\"window.print()\">พิมพ์ PDF</button>\r\n</div>\r\n\r\n<script>\r\n// ฟังก์ชันค้นหา (client side)\r\ndocument.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n    let input = this.value.toLowerCase();\r\n    let table = document.getElementById(\"quotationTable\");\r\n    let rows = table.getElementsByTagName(\"tr\");\r\n    let column = parseInt(document.getElementById(\"searchColumn\").value);\r\n\r\n    for (let i = 1; i < rows.length; i++) {\r\n        let cell = rows[i].getElementsByTagName(\"td\")[column];\r\n        if (cell) {\r\n            let text = cell.textContent.toLowerCase();\r\n            rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n        }\r\n    }\r\n});\r\n</script>\r\n\r\n</body>\r\n</html>\r\n\r\n<?php $conn->close(); ?>\r\n"
        }
    ]
}