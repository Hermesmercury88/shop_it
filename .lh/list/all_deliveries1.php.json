{
    "sourceFile": "list/all_deliveries1.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 10,
            "patches": [
                {
                    "date": 1758466403789,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1758466600333,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,14 +3,15 @@\n $user = \"root\";\r\n $pass = \"\";\r\n $dbname = \"shop_it\";\r\n \r\n+// เชื่อมต่อฐานข้อมูล\r\n $conn = new mysqli($host, $user, $pass, $dbname);\r\n if ($conn->connect_error) {\r\n     die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n }\r\n \r\n-// ดึงข้อมูล delivery พร้อม item\r\n+// ดึงข้อมูลจากตาราง deliveries + delivery_items\r\n $sql = \"\r\n     SELECT \r\n         d.customer_name,\r\n         d.delivery_no,\r\n@@ -22,28 +23,42 @@\n     FROM deliveries d\r\n     JOIN delivery_items i ON i.delivery_id = d.id\r\n     ORDER BY d.id, i.id\r\n \";\r\n-\r\n $result = $conn->query($sql);\r\n ?>\r\n-\r\n <!DOCTYPE html>\r\n <html lang=\"th\">\r\n <head>\r\n-<meta charset=\"UTF-8\">\r\n-<title>รายการส่งของทั้งหมด</title>\r\n-<link href=\"css/delivery.css\" rel=\"stylesheet\">\r\n-<style>\r\n-table { width: 100%; border-collapse: collapse; }\r\n-th, td { border: 1px solid #333; padding: 8px; text-align: center; }\r\n-th { background-color: #f0f0f0; }\r\n-</style>\r\n+    <meta charset=\"UTF-8\">\r\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+    <title>ใบส่งของ</title>\r\n+    <style>\r\n+        body { font-family: Tahoma, sans-serif; margin: 20px; }\r\n+        h2 { margin-bottom: 10px; }\r\n+        .search-box { margin-bottom: 15px; }\r\n+        select, input { padding: 6px; font-size: 14px; }\r\n+        table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n+        th, td { border: 1px solid #555; padding: 8px; text-align: center; }\r\n+        th { background: #f2f2f2; }\r\n+        tr:hover { background-color: #f9f9f9; }\r\n+    </style>\r\n </head>\r\n <body>\r\n \r\n-<h2>รายการส่งของทั้งหมด</h2>\r\n-<table>\r\n+<h2>รายการใบส่งของ</h2>\r\n+\r\n+<div class=\"search-box\">\r\n+    <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n+    <select id=\"searchColumn\">\r\n+        <option value=\"1\">ชื่อลูกค้า</option>\r\n+        <option value=\"2\">เลขที่ / NO.</option>\r\n+        <option value=\"3\">รายการสินค้า</option>\r\n+    </select>\r\n+    <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+</div>\r\n+\r\n+<table id=\"deliveryTable\">\r\n     <thead>\r\n         <tr>\r\n             <th>ลำดับ</th>\r\n             <th>ชื่อลูกค้า</th>\r\n@@ -77,8 +92,25 @@\n         ?>\r\n     </tbody>\r\n </table>\r\n \r\n+<script>\r\n+// ฟังก์ชันค้นหา (client side)\r\n+document.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n+    let input = this.value.toLowerCase();\r\n+    let table = document.getElementById(\"deliveryTable\");\r\n+    let rows = table.getElementsByTagName(\"tr\");\r\n+    let column = document.getElementById(\"searchColumn\").value;\r\n+\r\n+    for (let i = 1; i < rows.length; i++) {\r\n+        let cell = rows[i].getElementsByTagName(\"td\")[column];\r\n+        if (cell) {\r\n+            let text = cell.textContent.toLowerCase();\r\n+            rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n+        }\r\n+    }\r\n+});\r\n+</script>\r\n+\r\n </body>\r\n </html>\r\n-\r\n <?php $conn->close(); ?>\r\n"
                },
                {
                    "date": 1758547490443,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,17 +1,17 @@\n <?php\r\n+header('Content-Type: application/json; charset=utf-8');\r\n+\r\n $host = \"localhost\";\r\n $user = \"root\";\r\n $pass = \"\";\r\n $dbname = \"shop_it\";\r\n \r\n-// เชื่อมต่อฐานข้อมูล\r\n $conn = new mysqli($host, $user, $pass, $dbname);\r\n if ($conn->connect_error) {\r\n-    die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n+    die(json_encode([\"error\" => \"เชื่อมต่อฐานข้อมูลล้มเหลว\"]));\r\n }\r\n \r\n-// ดึงข้อมูลจากตาราง deliveries + delivery_items\r\n $sql = \"\r\n     SELECT \r\n         d.customer_name,\r\n         d.delivery_no,\r\n@@ -24,93 +24,16 @@\n     JOIN delivery_items i ON i.delivery_id = d.id\r\n     ORDER BY d.id, i.id\r\n \";\r\n $result = $conn->query($sql);\r\n-?>\r\n-<!DOCTYPE html>\r\n-<html lang=\"th\">\r\n-<head>\r\n-    <meta charset=\"UTF-8\">\r\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n-    <title>ใบส่งของ</title>\r\n-    <style>\r\n-        body { font-family: Tahoma, sans-serif; margin: 20px; }\r\n-        h2 { margin-bottom: 10px; }\r\n-        .search-box { margin-bottom: 15px; }\r\n-        select, input { padding: 6px; font-size: 14px; }\r\n-        table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n-        th, td { border: 1px solid #555; padding: 8px; text-align: center; }\r\n-        th { background: #f2f2f2; }\r\n-        tr:hover { background-color: #f9f9f9; }\r\n-    </style>\r\n-</head>\r\n-<body>\r\n \r\n-<h2>รายการใบส่งของ</h2>\r\n+$data = [];\r\n+if ($result->num_rows > 0) {\r\n+    while($row = $result->fetch_assoc()) {\r\n+        $data[] = $row;\r\n+    }\r\n+}\r\n \r\n-<div class=\"search-box\">\r\n-    <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n-    <select id=\"searchColumn\">\r\n-        <option value=\"1\">ชื่อลูกค้า</option>\r\n-        <option value=\"2\">เลขที่ / NO.</option>\r\n-        <option value=\"3\">รายการสินค้า</option>\r\n-    </select>\r\n-    <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n-</div>\r\n+echo json_encode($data, JSON_UNESCAPED_UNICODE);\r\n \r\n-<table id=\"deliveryTable\">\r\n-    <thead>\r\n-        <tr>\r\n-            <th>ลำดับ</th>\r\n-            <th>ชื่อลูกค้า</th>\r\n-            <th>เลขที่ / NO.</th>\r\n-            <th>รายการ</th>\r\n-            <th>จำนวน</th>\r\n-            <th>ราคา</th>\r\n-            <th>หน่วย</th>\r\n-            <th>ราคารวม</th>\r\n-        </tr>\r\n-    </thead>\r\n-    <tbody>\r\n-        <?php\r\n-        $no = 1;\r\n-        if ($result->num_rows > 0) {\r\n-            while($row = $result->fetch_assoc()) {\r\n-                echo \"<tr>\";\r\n-                echo \"<td>\" . $no++ . \"</td>\";\r\n-                echo \"<td>\" . htmlspecialchars($row['customer_name']) . \"</td>\";\r\n-                echo \"<td>\" . htmlspecialchars($row['delivery_no']) . \"</td>\";\r\n-                echo \"<td>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n-                echo \"<td>\" . $row['qty'] . \"</td>\";\r\n-                echo \"<td>\" . number_format($row['price'],2) . \"</td>\";\r\n-                echo \"<td>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n-                echo \"<td>\" . number_format($row['total'],2) . \"</td>\";\r\n-                echo \"</tr>\";\r\n-            }\r\n-        } else {\r\n-            echo \"<tr><td colspan='8'>ยังไม่มีข้อมูล</td></tr>\";\r\n-        }\r\n-        ?>\r\n-    </tbody>\r\n-</table>\r\n-\r\n-<script>\r\n-// ฟังก์ชันค้นหา (client side)\r\n-document.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n-    let input = this.value.toLowerCase();\r\n-    let table = document.getElementById(\"deliveryTable\");\r\n-    let rows = table.getElementsByTagName(\"tr\");\r\n-    let column = document.getElementById(\"searchColumn\").value;\r\n-\r\n-    for (let i = 1; i < rows.length; i++) {\r\n-        let cell = rows[i].getElementsByTagName(\"td\")[column];\r\n-        if (cell) {\r\n-            let text = cell.textContent.toLowerCase();\r\n-            rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n-        }\r\n-    }\r\n-});\r\n-</script>\r\n-\r\n-</body>\r\n-</html>\r\n-<?php $conn->close(); ?>\r\n+$conn->close();\r\n+?>\r\n"
                },
                {
                    "date": 1758547699529,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,17 +1,17 @@\n <?php\r\n-header('Content-Type: application/json; charset=utf-8');\r\n-\r\n $host = \"localhost\";\r\n $user = \"root\";\r\n $pass = \"\";\r\n $dbname = \"shop_it\";\r\n \r\n+// เชื่อมต่อฐานข้อมูล\r\n $conn = new mysqli($host, $user, $pass, $dbname);\r\n if ($conn->connect_error) {\r\n-    die(json_encode([\"error\" => \"เชื่อมต่อฐานข้อมูลล้มเหลว\"]));\r\n+    die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n }\r\n \r\n+// ดึงข้อมูลจากตาราง deliveries + delivery_items\r\n $sql = \"\r\n     SELECT \r\n         d.customer_name,\r\n         d.delivery_no,\r\n@@ -24,16 +24,93 @@\n     JOIN delivery_items i ON i.delivery_id = d.id\r\n     ORDER BY d.id, i.id\r\n \";\r\n $result = $conn->query($sql);\r\n+?>\r\n+<!DOCTYPE html>\r\n+<html lang=\"th\">\r\n+<head>\r\n+    <meta charset=\"UTF-8\">\r\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+    <title>ใบส่งของ</title>\r\n+    <style>\r\n+        body { font-family: Tahoma, sans-serif; margin: 20px; }\r\n+        h2 { margin-bottom: 10px; }\r\n+        .search-box { margin-bottom: 15px; }\r\n+        select, input { padding: 6px; font-size: 14px; }\r\n+        table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n+        th, td { border: 1px solid #555; padding: 8px; text-align: center; }\r\n+        th { background: #f2f2f2; }\r\n+        tr:hover { background-color: #f9f9f9; }\r\n+    </style>\r\n+</head>\r\n+<body>\r\n \r\n-$data = [];\r\n-if ($result->num_rows > 0) {\r\n-    while($row = $result->fetch_assoc()) {\r\n-        $data[] = $row;\r\n+<h2>รายการใบส่งของ</h2>\r\n+\r\n+<div class=\"search-box\">\r\n+    <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n+    <select id=\"searchColumn\">\r\n+        <option value=\"1\">ชื่อลูกค้า</option>\r\n+        <option value=\"2\">เลขที่ / NO.</option>\r\n+        <option value=\"3\">รายการสินค้า</option>\r\n+    </select>\r\n+    <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+</div>\r\n+\r\n+<table id=\"deliveryTable\">\r\n+    <thead>\r\n+        <tr>\r\n+            <th>ลำดับ</th>\r\n+            <th>ชื่อลูกค้า</th>\r\n+            <th>เลขที่ / NO.</th>\r\n+            <th>รายการ</th>\r\n+            <th>จำนวน</th>\r\n+            <th>ราคา</th>\r\n+            <th>หน่วย</th>\r\n+            <th>ราคารวม</th>\r\n+        </tr>\r\n+    </thead>\r\n+    <tbody>\r\n+        <?php\r\n+        $no = 1;\r\n+        if ($result->num_rows > 0) {\r\n+            while($row = $result->fetch_assoc()) {\r\n+                echo \"<tr>\";\r\n+                echo \"<td>\" . $no++ . \"</td>\";\r\n+                echo \"<td>\" . htmlspecialchars($row['customer_name']) . \"</td>\";\r\n+                echo \"<td>\" . htmlspecialchars($row['delivery_no']) . \"</td>\";\r\n+                echo \"<td>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n+                echo \"<td>\" . $row['qty'] . \"</td>\";\r\n+                echo \"<td>\" . number_format($row['price'],2) . \"</td>\";\r\n+                echo \"<td>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n+                echo \"<td>\" . number_format($row['total'],2) . \"</td>\";\r\n+                echo \"</tr>\";\r\n+            }\r\n+        } else {\r\n+            echo \"<tr><td colspan='8'>ยังไม่มีข้อมูล</td></tr>\";\r\n+        }\r\n+        ?>\r\n+    </tbody>\r\n+</table>\r\n+\r\n+<script>\r\n+// ฟังก์ชันค้นหา (client side)\r\n+document.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n+    let input = this.value.toLowerCase();\r\n+    let table = document.getElementById(\"deliveryTable\");\r\n+    let rows = table.getElementsByTagName(\"tr\");\r\n+    let column = document.getElementById(\"searchColumn\").value;\r\n+\r\n+    for (let i = 1; i < rows.length; i++) {\r\n+        let cell = rows[i].getElementsByTagName(\"td\")[column];\r\n+        if (cell) {\r\n+            let text = cell.textContent.toLowerCase();\r\n+            rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n+        }\r\n     }\r\n-}\r\n+});\r\n+</script>\r\n \r\n-echo json_encode($data, JSON_UNESCAPED_UNICODE);\r\n-\r\n-$conn->close();\r\n-?>\r\n+</body>\r\n+</html>\r\n+<?php $conn->close(); ?>\r\n"
                },
                {
                    "date": 1758548648517,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,116 +0,0 @@\n-<?php\r\n-$host = \"localhost\";\r\n-$user = \"root\";\r\n-$pass = \"\";\r\n-$dbname = \"shop_it\";\r\n-\r\n-// เชื่อมต่อฐานข้อมูล\r\n-$conn = new mysqli($host, $user, $pass, $dbname);\r\n-if ($conn->connect_error) {\r\n-    die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n-}\r\n-\r\n-// ดึงข้อมูลจากตาราง deliveries + delivery_items\r\n-$sql = \"\r\n-    SELECT \r\n-        d.customer_name,\r\n-        d.delivery_no,\r\n-        i.item_name,\r\n-        i.qty,\r\n-        i.price,\r\n-        i.unit,\r\n-        i.total\r\n-    FROM deliveries d\r\n-    JOIN delivery_items i ON i.delivery_id = d.id\r\n-    ORDER BY d.id, i.id\r\n-\";\r\n-$result = $conn->query($sql);\r\n-?>\r\n-<!DOCTYPE html>\r\n-<html lang=\"th\">\r\n-<head>\r\n-    <meta charset=\"UTF-8\">\r\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n-    <title>ใบส่งของ</title>\r\n-    <style>\r\n-        body { font-family: Tahoma, sans-serif; margin: 20px; }\r\n-        h2 { margin-bottom: 10px; }\r\n-        .search-box { margin-bottom: 15px; }\r\n-        select, input { padding: 6px; font-size: 14px; }\r\n-        table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n-        th, td { border: 1px solid #555; padding: 8px; text-align: center; }\r\n-        th { background: #f2f2f2; }\r\n-        tr:hover { background-color: #f9f9f9; }\r\n-    </style>\r\n-</head>\r\n-<body>\r\n-\r\n-<h2>รายการใบส่งของ</h2>\r\n-\r\n-<div class=\"search-box\">\r\n-    <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n-    <select id=\"searchColumn\">\r\n-        <option value=\"1\">ชื่อลูกค้า</option>\r\n-        <option value=\"2\">เลขที่ / NO.</option>\r\n-        <option value=\"3\">รายการสินค้า</option>\r\n-    </select>\r\n-    <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n-</div>\r\n-\r\n-<table id=\"deliveryTable\">\r\n-    <thead>\r\n-        <tr>\r\n-            <th>ลำดับ</th>\r\n-            <th>ชื่อลูกค้า</th>\r\n-            <th>เลขที่ / NO.</th>\r\n-            <th>รายการ</th>\r\n-            <th>จำนวน</th>\r\n-            <th>ราคา</th>\r\n-            <th>หน่วย</th>\r\n-            <th>ราคารวม</th>\r\n-        </tr>\r\n-    </thead>\r\n-    <tbody>\r\n-        <?php\r\n-        $no = 1;\r\n-        if ($result->num_rows > 0) {\r\n-            while($row = $result->fetch_assoc()) {\r\n-                echo \"<tr>\";\r\n-                echo \"<td>\" . $no++ . \"</td>\";\r\n-                echo \"<td>\" . htmlspecialchars($row['customer_name']) . \"</td>\";\r\n-                echo \"<td>\" . htmlspecialchars($row['delivery_no']) . \"</td>\";\r\n-                echo \"<td>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n-                echo \"<td>\" . $row['qty'] . \"</td>\";\r\n-                echo \"<td>\" . number_format($row['price'],2) . \"</td>\";\r\n-                echo \"<td>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n-                echo \"<td>\" . number_format($row['total'],2) . \"</td>\";\r\n-                echo \"</tr>\";\r\n-            }\r\n-        } else {\r\n-            echo \"<tr><td colspan='8'>ยังไม่มีข้อมูล</td></tr>\";\r\n-        }\r\n-        ?>\r\n-    </tbody>\r\n-</table>\r\n-\r\n-<script>\r\n-// ฟังก์ชันค้นหา (client side)\r\n-document.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n-    let input = this.value.toLowerCase();\r\n-    let table = document.getElementById(\"deliveryTable\");\r\n-    let rows = table.getElementsByTagName(\"tr\");\r\n-    let column = document.getElementById(\"searchColumn\").value;\r\n-\r\n-    for (let i = 1; i < rows.length; i++) {\r\n-        let cell = rows[i].getElementsByTagName(\"td\")[column];\r\n-        if (cell) {\r\n-            let text = cell.textContent.toLowerCase();\r\n-            rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n-        }\r\n-    }\r\n-});\r\n-</script>\r\n-\r\n-</body>\r\n-</html>\r\n-<?php $conn->close(); ?>\r\n\\ No newline at end of file\n"
                },
                {
                    "date": 1758548705921,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,1 +1,90 @@\n-\n+<?php\r\n+$host = \"localhost\";\r\n+$user = \"root\";\r\n+$pass = \"\";\r\n+$dbname = \"shop_it\";\r\n+\r\n+$conn = new mysqli($host, $user, $pass, $dbname);\r\n+if ($conn->connect_error) {\r\n+    die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n+}\r\n+\r\n+$sql = \"\r\n+    SELECT \r\n+        d.customer_name,\r\n+        d.delivery_no,\r\n+        i.item_name,\r\n+        i.qty,\r\n+        i.price,\r\n+        i.unit,\r\n+        i.total\r\n+    FROM deliveries d\r\n+    JOIN delivery_items i ON i.delivery_id = d.id\r\n+    ORDER BY d.id, i.id\r\n+\";\r\n+$result = $conn->query($sql);\r\n+\r\n+$data = [];\r\n+if ($result && $result->num_rows > 0) {\r\n+    while($row = $result->fetch_assoc()) {\r\n+        $data[] = $row;\r\n+    }\r\n+}\r\n+\r\n+// ถ้ามี header HTTP_X_REQUESTED_WITH = fetch → ส่ง JSON\r\n+if (!empty($_SERVER['HTTP_X_REQUESTED_WITH'])) {\r\n+    header(\"Content-Type: application/json; charset=UTF-8\");\r\n+    echo json_encode($data, JSON_UNESCAPED_UNICODE);\r\n+} else {\r\n+    // ถ้าเปิดตรงๆ http://localhost/shop/list/all_deliveries1.php → แสดงตาราง HTML\r\n+    echo \"<!DOCTYPE html>\r\n+    <html lang='th'>\r\n+    <head>\r\n+        <meta charset='UTF-8'>\r\n+        <title>รายการส่งของ</title>\r\n+        <style>\r\n+            body { font-family: Tahoma, sans-serif; padding: 20px; }\r\n+            table { border-collapse: collapse; width: 100%; }\r\n+            th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }\r\n+            th { background: #f2f2f2; }\r\n+        </style>\r\n+    </head>\r\n+    <body>\r\n+    <h2>รายการส่งของ</h2>\";\r\n+\r\n+    if (count($data) > 0) {\r\n+        echo \"<table>\r\n+            <thead>\r\n+                <tr>\r\n+                    <th>#</th>\r\n+                    <th>ลูกค้า</th>\r\n+                    <th>เลขที่ส่งของ</th>\r\n+                    <th>สินค้า</th>\r\n+                    <th>จำนวน</th>\r\n+                    <th>ราคา/หน่วย</th>\r\n+                    <th>หน่วย</th>\r\n+                    <th>รวม</th>\r\n+                </tr>\r\n+            </thead>\r\n+            <tbody>\";\r\n+        foreach ($data as $idx => $row) {\r\n+            echo \"<tr>\r\n+                <td>\".($idx+1).\"</td>\r\n+                <td>{$row['customer_name']}</td>\r\n+                <td>{$row['delivery_no']}</td>\r\n+                <td>{$row['item_name']}</td>\r\n+                <td>{$row['qty']}</td>\r\n+                <td>\".number_format($row['price'],2).\"</td>\r\n+                <td>{$row['unit']}</td>\r\n+                <td>\".number_format($row['total'],2).\"</td>\r\n+            </tr>\";\r\n+        }\r\n+        echo \"</tbody></table>\";\r\n+    } else {\r\n+        echo \"<p>ไม่มีข้อมูล</p>\";\r\n+    }\r\n+\r\n+    echo \"</body></html>\";\r\n+}\r\n+\r\n+$conn->close();\r\n"
                },
                {
                    "date": 1758549084079,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,8 @@\n <?php\r\n+error_reporting(E_ALL);\r\n+ini_set('display_errors', 1);\r\n+\r\n $host = \"localhost\";\r\n $user = \"root\";\r\n $pass = \"\";\r\n $dbname = \"shop_it\";\r\n@@ -8,8 +11,9 @@\n if ($conn->connect_error) {\r\n     die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n }\r\n \r\n+// ดึงข้อมูล deliveries + items\r\n $sql = \"\r\n     SELECT \r\n         d.customer_name,\r\n         d.delivery_no,\r\n@@ -30,61 +34,63 @@\n         $data[] = $row;\r\n     }\r\n }\r\n \r\n-// ถ้ามี header HTTP_X_REQUESTED_WITH = fetch → ส่ง JSON\r\n-if (!empty($_SERVER['HTTP_X_REQUESTED_WITH'])) {\r\n+// ถ้าเรียกจาก Ajax (XMLHttpRequest) → ส่ง JSON\r\n+if (!empty($_SERVER['HTTP_X_REQUESTED_WITH']) &&\r\n+    strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) === 'xmlhttprequest') {\r\n     header(\"Content-Type: application/json; charset=UTF-8\");\r\n     echo json_encode($data, JSON_UNESCAPED_UNICODE);\r\n-} else {\r\n-    // ถ้าเปิดตรงๆ http://localhost/shop/list/all_deliveries1.php → แสดงตาราง HTML\r\n-    echo \"<!DOCTYPE html>\r\n-    <html lang='th'>\r\n-    <head>\r\n-        <meta charset='UTF-8'>\r\n-        <title>รายการส่งของ</title>\r\n-        <style>\r\n-            body { font-family: Tahoma, sans-serif; padding: 20px; }\r\n-            table { border-collapse: collapse; width: 100%; }\r\n-            th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }\r\n-            th { background: #f2f2f2; }\r\n-        </style>\r\n-    </head>\r\n-    <body>\r\n-    <h2>รายการส่งของ</h2>\";\r\n-\r\n-    if (count($data) > 0) {\r\n-        echo \"<table>\r\n-            <thead>\r\n-                <tr>\r\n-                    <th>#</th>\r\n-                    <th>ลูกค้า</th>\r\n-                    <th>เลขที่ส่งของ</th>\r\n-                    <th>สินค้า</th>\r\n-                    <th>จำนวน</th>\r\n-                    <th>ราคา/หน่วย</th>\r\n-                    <th>หน่วย</th>\r\n-                    <th>รวม</th>\r\n-                </tr>\r\n-            </thead>\r\n-            <tbody>\";\r\n-        foreach ($data as $idx => $row) {\r\n-            echo \"<tr>\r\n-                <td>\".($idx+1).\"</td>\r\n-                <td>{$row['customer_name']}</td>\r\n-                <td>{$row['delivery_no']}</td>\r\n-                <td>{$row['item_name']}</td>\r\n-                <td>{$row['qty']}</td>\r\n-                <td>\".number_format($row['price'],2).\"</td>\r\n-                <td>{$row['unit']}</td>\r\n-                <td>\".number_format($row['total'],2).\"</td>\r\n-            </tr>\";\r\n-        }\r\n-        echo \"</tbody></table>\";\r\n-    } else {\r\n-        echo \"<p>ไม่มีข้อมูล</p>\";\r\n-    }\r\n-\r\n-    echo \"</body></html>\";\r\n+    exit;\r\n }\r\n \r\n-$conn->close();\r\n+// ถ้าเข้าหน้า PHP ตรงๆ → แสดงตาราง HTML (สำหรับ debug)\r\n+?>\r\n+<!DOCTYPE html>\r\n+<html lang=\"th\">\r\n+<head>\r\n+<meta charset=\"UTF-8\">\r\n+<title>รายการส่งของ</title>\r\n+<style>\r\n+body { font-family: Tahoma, sans-serif; padding: 20px; }\r\n+table { border-collapse: collapse; width: 100%; }\r\n+th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }\r\n+th { background: #f2f2f2; }\r\n+</style>\r\n+</head>\r\n+<body>\r\n+<h2>รายการส่งของ</h2>\r\n+<?php if(count($data) > 0): ?>\r\n+<table>\r\n+    <thead>\r\n+        <tr>\r\n+            <th>#</th>\r\n+            <th>ลูกค้า</th>\r\n+            <th>เลขที่ส่งของ</th>\r\n+            <th>สินค้า</th>\r\n+            <th>จำนวน</th>\r\n+            <th>ราคา/หน่วย</th>\r\n+            <th>หน่วย</th>\r\n+            <th>รวม</th>\r\n+        </tr>\r\n+    </thead>\r\n+    <tbody>\r\n+        <?php foreach($data as $idx => $row): ?>\r\n+        <tr>\r\n+            <td><?= $idx+1 ?></td>\r\n+            <td><?= $row['customer_name'] ?></td>\r\n+            <td><?= $row['delivery_no'] ?></td>\r\n+            <td><?= $row['item_name'] ?></td>\r\n+            <td><?= $row['qty'] ?></td>\r\n+            <td><?= number_format($row['price'],2) ?></td>\r\n+            <td><?= $row['unit'] ?></td>\r\n+            <td><?= number_format($row['total'],2) ?></td>\r\n+        </tr>\r\n+        <?php endforeach; ?>\r\n+    </tbody>\r\n+</table>\r\n+<?php else: ?>\r\n+<p>ไม่มีข้อมูล</p>\r\n+<?php endif; ?>\r\n+</body>\r\n+</html>\r\n+<?php $conn->close(); ?>\r\n"
                },
                {
                    "date": 1758549176446,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,5 @@\n <?php\r\n-error_reporting(E_ALL);\r\n-ini_set('display_errors', 1);\r\n-\r\n $host = \"localhost\";\r\n $user = \"root\";\r\n $pass = \"\";\r\n $dbname = \"shop_it\";\r\n@@ -11,9 +8,8 @@\n if ($conn->connect_error) {\r\n     die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n }\r\n \r\n-// ดึงข้อมูล deliveries + items\r\n $sql = \"\r\n     SELECT \r\n         d.customer_name,\r\n         d.delivery_no,\r\n@@ -34,63 +30,61 @@\n         $data[] = $row;\r\n     }\r\n }\r\n \r\n-// ถ้าเรียกจาก Ajax (XMLHttpRequest) → ส่ง JSON\r\n-if (!empty($_SERVER['HTTP_X_REQUESTED_WITH']) &&\r\n-    strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) === 'xmlhttprequest') {\r\n+// ถ้ามี header HTTP_X_REQUESTED_WITH = fetch → ส่ง JSON\r\n+if (!empty($_SERVER['HTTP_X_REQUESTED_WITH'])) {\r\n     header(\"Content-Type: application/json; charset=UTF-8\");\r\n     echo json_encode($data, JSON_UNESCAPED_UNICODE);\r\n-    exit;\r\n+} else {\r\n+    // ถ้าเปิดตรงๆ http://localhost/shop/list/all_deliveries1.php → แสดงตาราง HTML\r\n+    echo \"<!DOCTYPE html>\r\n+    <html lang='th'>\r\n+    <head>\r\n+        <meta charset='UTF-8'>\r\n+        <title>รายการส่งของ</title>\r\n+        <style>\r\n+            body { font-family: Tahoma, sans-serif; padding: 20px; }\r\n+            table { border-collapse: collapse; width: 100%; }\r\n+            th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }\r\n+            th { background: #f2f2f2; }\r\n+        </style>\r\n+    </head>\r\n+    <body>\r\n+    <h2>รายการส่งของ</h2>\";\r\n+\r\n+    if (count($data) > 0) {\r\n+        echo \"<table>\r\n+            <thead>\r\n+                <tr>\r\n+                    <th>#</th>\r\n+                    <th>ลูกค้า</th>\r\n+                    <th>เลขที่ส่งของ</th>\r\n+                    <th>สินค้า</th>\r\n+                    <th>จำนวน</th>\r\n+                    <th>ราคา/หน่วย</th>\r\n+                    <th>หน่วย</th>\r\n+                    <th>รวม</th>\r\n+                </tr>\r\n+            </thead>\r\n+            <tbody>\";\r\n+        foreach ($data as $idx => $row) {\r\n+            echo \"<tr>\r\n+                <td>\".($idx+1).\"</td>\r\n+                <td>{$row['customer_name']}</td>\r\n+                <td>{$row['delivery_no']}</td>\r\n+                <td>{$row['item_name']}</td>\r\n+                <td>{$row['qty']}</td>\r\n+                <td>\".number_format($row['price'],2).\"</td>\r\n+                <td>{$row['unit']}</td>\r\n+                <td>\".number_format($row['total'],2).\"</td>\r\n+            </tr>\";\r\n+        }\r\n+        echo \"</tbody></table>\";\r\n+    } else {\r\n+        echo \"<p>ไม่มีข้อมูล</p>\";\r\n+    }\r\n+\r\n+    echo \"</body></html>\";\r\n }\r\n \r\n-// ถ้าเข้าหน้า PHP ตรงๆ → แสดงตาราง HTML (สำหรับ debug)\r\n-?>\r\n-<!DOCTYPE html>\r\n-<html lang=\"th\">\r\n-<head>\r\n-<meta charset=\"UTF-8\">\r\n-<title>รายการส่งของ</title>\r\n-<style>\r\n-body { font-family: Tahoma, sans-serif; padding: 20px; }\r\n-table { border-collapse: collapse; width: 100%; }\r\n-th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }\r\n-th { background: #f2f2f2; }\r\n-</style>\r\n-</head>\r\n-<body>\r\n-<h2>รายการส่งของ</h2>\r\n-<?php if(count($data) > 0): ?>\r\n-<table>\r\n-    <thead>\r\n-        <tr>\r\n-            <th>#</th>\r\n-            <th>ลูกค้า</th>\r\n-            <th>เลขที่ส่งของ</th>\r\n-            <th>สินค้า</th>\r\n-            <th>จำนวน</th>\r\n-            <th>ราคา/หน่วย</th>\r\n-            <th>หน่วย</th>\r\n-            <th>รวม</th>\r\n-        </tr>\r\n-    </thead>\r\n-    <tbody>\r\n-        <?php foreach($data as $idx => $row): ?>\r\n-        <tr>\r\n-            <td><?= $idx+1 ?></td>\r\n-            <td><?= $row['customer_name'] ?></td>\r\n-            <td><?= $row['delivery_no'] ?></td>\r\n-            <td><?= $row['item_name'] ?></td>\r\n-            <td><?= $row['qty'] ?></td>\r\n-            <td><?= number_format($row['price'],2) ?></td>\r\n-            <td><?= $row['unit'] ?></td>\r\n-            <td><?= number_format($row['total'],2) ?></td>\r\n-        </tr>\r\n-        <?php endforeach; ?>\r\n-    </tbody>\r\n-</table>\r\n-<?php else: ?>\r\n-<p>ไม่มีข้อมูล</p>\r\n-<?php endif; ?>\r\n-</body>\r\n-</html>\r\n-<?php $conn->close(); ?>\r\n+$conn->close();\r\n"
                },
                {
                    "date": 1758549234878,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,13 +3,15 @@\n $user = \"root\";\r\n $pass = \"\";\r\n $dbname = \"shop_it\";\r\n \r\n+// เชื่อมต่อฐานข้อมูล\r\n $conn = new mysqli($host, $user, $pass, $dbname);\r\n if ($conn->connect_error) {\r\n     die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n }\r\n \r\n+// ดึงข้อมูลจากตาราง deliveries + delivery_items\r\n $sql = \"\r\n     SELECT \r\n         d.customer_name,\r\n         d.delivery_no,\r\n@@ -22,69 +24,93 @@\n     JOIN delivery_items i ON i.delivery_id = d.id\r\n     ORDER BY d.id, i.id\r\n \";\r\n $result = $conn->query($sql);\r\n+?>\r\n+<!DOCTYPE html>\r\n+<html lang=\"th\">\r\n+<head>\r\n+    <meta charset=\"UTF-8\">\r\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+    <title>ใบส่งของ</title>\r\n+    <style>\r\n+        body { font-family: Tahoma, sans-serif; margin: 20px; }\r\n+        h2 { margin-bottom: 10px; }\r\n+        .search-box { margin-bottom: 15px; }\r\n+        select, input { padding: 6px; font-size: 14px; }\r\n+        table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n+        th, td { border: 1px solid #555; padding: 8px; text-align: center; }\r\n+        th { background: #f2f2f2; }\r\n+        tr:hover { background-color: #f9f9f9; }\r\n+    </style>\r\n+</head>\r\n+<body>\r\n \r\n-$data = [];\r\n-if ($result && $result->num_rows > 0) {\r\n-    while($row = $result->fetch_assoc()) {\r\n-        $data[] = $row;\r\n-    }\r\n-}\r\n+<h2>รายการใบส่งของ</h2>\r\n \r\n-// ถ้ามี header HTTP_X_REQUESTED_WITH = fetch → ส่ง JSON\r\n-if (!empty($_SERVER['HTTP_X_REQUESTED_WITH'])) {\r\n-    header(\"Content-Type: application/json; charset=UTF-8\");\r\n-    echo json_encode($data, JSON_UNESCAPED_UNICODE);\r\n-} else {\r\n-    // ถ้าเปิดตรงๆ http://localhost/shop/list/all_deliveries1.php → แสดงตาราง HTML\r\n-    echo \"<!DOCTYPE html>\r\n-    <html lang='th'>\r\n-    <head>\r\n-        <meta charset='UTF-8'>\r\n-        <title>รายการส่งของ</title>\r\n-        <style>\r\n-            body { font-family: Tahoma, sans-serif; padding: 20px; }\r\n-            table { border-collapse: collapse; width: 100%; }\r\n-            th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }\r\n-            th { background: #f2f2f2; }\r\n-        </style>\r\n-    </head>\r\n-    <body>\r\n-    <h2>รายการส่งของ</h2>\";\r\n+<div class=\"search-box\">\r\n+    <label for=\"searchColumn\">ค้นหาโดย: </label>\r\n+    <select id=\"searchColumn\">\r\n+        <option value=\"1\">ชื่อลูกค้า</option>\r\n+        <option value=\"2\">เลขที่ / NO.</option>\r\n+        <option value=\"3\">รายการสินค้า</option>\r\n+    </select>\r\n+    <input type=\"text\" id=\"searchInput\" placeholder=\"พิมพ์คำค้นหา...\">\r\n+</div>\r\n \r\n-    if (count($data) > 0) {\r\n-        echo \"<table>\r\n-            <thead>\r\n-                <tr>\r\n-                    <th>#</th>\r\n-                    <th>ลูกค้า</th>\r\n-                    <th>เลขที่ส่งของ</th>\r\n-                    <th>สินค้า</th>\r\n-                    <th>จำนวน</th>\r\n-                    <th>ราคา/หน่วย</th>\r\n-                    <th>หน่วย</th>\r\n-                    <th>รวม</th>\r\n-                </tr>\r\n-            </thead>\r\n-            <tbody>\";\r\n-        foreach ($data as $idx => $row) {\r\n-            echo \"<tr>\r\n-                <td>\".($idx+1).\"</td>\r\n-                <td>{$row['customer_name']}</td>\r\n-                <td>{$row['delivery_no']}</td>\r\n-                <td>{$row['item_name']}</td>\r\n-                <td>{$row['qty']}</td>\r\n-                <td>\".number_format($row['price'],2).\"</td>\r\n-                <td>{$row['unit']}</td>\r\n-                <td>\".number_format($row['total'],2).\"</td>\r\n-            </tr>\";\r\n+<table id=\"deliveryTable\">\r\n+    <thead>\r\n+        <tr>\r\n+            <th>ลำดับ</th>\r\n+            <th>ชื่อลูกค้า</th>\r\n+            <th>เลขที่ / NO.</th>\r\n+            <th>รายการ</th>\r\n+            <th>จำนวน</th>\r\n+            <th>ราคา</th>\r\n+            <th>หน่วย</th>\r\n+            <th>ราคารวม</th>\r\n+        </tr>\r\n+    </thead>\r\n+    <tbody>\r\n+        <?php\r\n+        $no = 1;\r\n+        if ($result->num_rows > 0) {\r\n+            while($row = $result->fetch_assoc()) {\r\n+                echo \"<tr>\";\r\n+                echo \"<td>\" . $no++ . \"</td>\";\r\n+                echo \"<td>\" . htmlspecialchars($row['customer_name']) . \"</td>\";\r\n+                echo \"<td>\" . htmlspecialchars($row['delivery_no']) . \"</td>\";\r\n+                echo \"<td>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n+                echo \"<td>\" . $row['qty'] . \"</td>\";\r\n+                echo \"<td>\" . number_format($row['price'],2) . \"</td>\";\r\n+                echo \"<td>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n+                echo \"<td>\" . number_format($row['total'],2) . \"</td>\";\r\n+                echo \"</tr>\";\r\n+            }\r\n+        } else {\r\n+            echo \"<tr><td colspan='8'>ยังไม่มีข้อมูล</td></tr>\";\r\n         }\r\n-        echo \"</tbody></table>\";\r\n-    } else {\r\n-        echo \"<p>ไม่มีข้อมูล</p>\";\r\n+        ?>\r\n+    </tbody>\r\n+</table>\r\n+\r\n+<script>\r\n+// ฟังก์ชันค้นหา (client side)\r\n+document.getElementById(\"searchInput\").addEventListener(\"keyup\", function() {\r\n+    let input = this.value.toLowerCase();\r\n+    let table = document.getElementById(\"deliveryTable\");\r\n+    let rows = table.getElementsByTagName(\"tr\");\r\n+    let column = document.getElementById(\"searchColumn\").value;\r\n+\r\n+    for (let i = 1; i < rows.length; i++) {\r\n+        let cell = rows[i].getElementsByTagName(\"td\")[column];\r\n+        if (cell) {\r\n+            let text = cell.textContent.toLowerCase();\r\n+            rows[i].style.display = text.includes(input) ? \"\" : \"none\";\r\n+        }\r\n     }\r\n+});\r\n+</script>\r\n \r\n-    echo \"</body></html>\";\r\n-}\r\n-\r\n-$conn->close();\r\n+</body>\r\n+</html>\r\n+<?php $conn->close(); ?>\r\n"
                },
                {
                    "date": 1758549249495,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,9 @@\n         .search-box { margin-bottom: 15px; }\r\n         select, input { padding: 6px; font-size: 14px; }\r\n         table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n         th, td { border: 1px solid #555; padding: 8px; text-align: center; }\r\n-        th { background: #f2f2f2ff; }\r\n+        th { background: #a79636ff; }\r\n         tr:hover { background-color: #f9f9f9; }\r\n     </style>\r\n </head>\r\n <body>\r\n"
                },
                {
                    "date": 1758554329962,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -267,9 +267,9 @@\n         </tbody>\r\n     </table>\r\n \r\n     <div style=\"margin-top: 20px; display: flex; gap: 10px;\">\r\n-\r\n+    \r\n     <button style=\"padding: 10px 10px; background:#b89172; color:#fff; border:none; border-radius:6px; cursor:pointer; font-weight:bold;\"\r\n             onclick=\"window.location.href='../index.html'\">\r\n         กลับหน้าหลัก\r\n     </button>\r\n"
                }
            ],
            "date": 1758466403789,
            "name": "Commit-0",
            "content": "<?php\r\n$host = \"localhost\";\r\n$user = \"root\";\r\n$pass = \"\";\r\n$dbname = \"shop_it\";\r\n\r\n$conn = new mysqli($host, $user, $pass, $dbname);\r\nif ($conn->connect_error) {\r\n    die(\"เชื่อมต่อฐานข้อมูลล้มเหลว: \" . $conn->connect_error);\r\n}\r\n\r\n// ดึงข้อมูล delivery พร้อม item\r\n$sql = \"\r\n    SELECT \r\n        d.customer_name,\r\n        d.delivery_no,\r\n        i.item_name,\r\n        i.qty,\r\n        i.price,\r\n        i.unit,\r\n        i.total\r\n    FROM deliveries d\r\n    JOIN delivery_items i ON i.delivery_id = d.id\r\n    ORDER BY d.id, i.id\r\n\";\r\n\r\n$result = $conn->query($sql);\r\n?>\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"th\">\r\n<head>\r\n<meta charset=\"UTF-8\">\r\n<title>รายการส่งของทั้งหมด</title>\r\n<link href=\"css/delivery.css\" rel=\"stylesheet\">\r\n<style>\r\ntable { width: 100%; border-collapse: collapse; }\r\nth, td { border: 1px solid #333; padding: 8px; text-align: center; }\r\nth { background-color: #f0f0f0; }\r\n</style>\r\n</head>\r\n<body>\r\n\r\n<h2>รายการส่งของทั้งหมด</h2>\r\n<table>\r\n    <thead>\r\n        <tr>\r\n            <th>ลำดับ</th>\r\n            <th>ชื่อลูกค้า</th>\r\n            <th>เลขที่ / NO.</th>\r\n            <th>รายการ</th>\r\n            <th>จำนวน</th>\r\n            <th>ราคา</th>\r\n            <th>หน่วย</th>\r\n            <th>ราคารวม</th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <?php\r\n        $no = 1;\r\n        if ($result->num_rows > 0) {\r\n            while($row = $result->fetch_assoc()) {\r\n                echo \"<tr>\";\r\n                echo \"<td>\" . $no++ . \"</td>\";\r\n                echo \"<td>\" . htmlspecialchars($row['customer_name']) . \"</td>\";\r\n                echo \"<td>\" . htmlspecialchars($row['delivery_no']) . \"</td>\";\r\n                echo \"<td>\" . htmlspecialchars($row['item_name']) . \"</td>\";\r\n                echo \"<td>\" . $row['qty'] . \"</td>\";\r\n                echo \"<td>\" . number_format($row['price'],2) . \"</td>\";\r\n                echo \"<td>\" . htmlspecialchars($row['unit']) . \"</td>\";\r\n                echo \"<td>\" . number_format($row['total'],2) . \"</td>\";\r\n                echo \"</tr>\";\r\n            }\r\n        } else {\r\n            echo \"<tr><td colspan='8'>ยังไม่มีข้อมูล</td></tr>\";\r\n        }\r\n        ?>\r\n    </tbody>\r\n</table>\r\n\r\n</body>\r\n</html>\r\n\r\n<?php $conn->close(); ?>\r\n"
        }
    ]
}