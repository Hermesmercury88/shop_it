{
    "sourceFile": "quotations1.html",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1758459842734,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1758459982673,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,10 +28,60 @@\n         </div>\r\n     </div>\r\n \r\n     <!-- ฟอร์ม -->\r\n-    <form action=\"http://localhost/shop/ยังไม่มี.php\" method=\"post\" id=\"receiptForm\">\r\n+    <form action=\"http://localhost/shop/<?php\r\n+$servername = \"localhost\";\r\n+$username = \"root\"; // เปลี่ยนตามจริง\r\n+$password = \"\";     // เปลี่ยนตามจริง\r\n+$dbname = \"shop_it\";\r\n \r\n+// สร้างการเชื่อมต่อ\r\n+$conn = new mysqli($servername, $username, $password, $dbname);\r\n+\r\n+// ตรวจสอบการเชื่อมต่อ\r\n+if ($conn->connect_error) {\r\n+    die(\"Connection failed: \" . $conn->connect_error);\r\n+}\r\n+\r\n+// SQL สำหรับสร้างตาราง quotations\r\n+$sql1 = \"CREATE TABLE IF NOT EXISTS quotations (\r\n+    id INT(11) AUTO_INCREMENT PRIMARY KEY,\r\n+    quotation_no VARCHAR(50) NOT NULL,\r\n+    subject VARCHAR(255) NOT NULL,\r\n+    recipient_name VARCHAR(255) NOT NULL,\r\n+    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\r\n+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\";\r\n+\r\n+// SQL สำหรับสร้างตาราง quotation_items\r\n+$sql2 = \"CREATE TABLE IF NOT EXISTS quotation_items (\r\n+    id INT(11) AUTO_INCREMENT PRIMARY KEY,\r\n+    quotation_id INT(11) NOT NULL,\r\n+    item_name VARCHAR(255) NOT NULL,\r\n+    qty INT(11) DEFAULT 0,\r\n+    price DECIMAL(10,2) DEFAULT 0.00,\r\n+    unit VARCHAR(50) DEFAULT NULL,\r\n+    total DECIMAL(10,2) DEFAULT 0.00,\r\n+    FOREIGN KEY (quotation_id) REFERENCES quotations(id) ON DELETE CASCADE\r\n+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\";\r\n+\r\n+// รัน SQL\r\n+if ($conn->query($sql1) === TRUE) {\r\n+    echo \"ตาราง quotations ถูกสร้างเรียบร้อย<br>\";\r\n+} else {\r\n+    echo \"Error creating quotations: \" . $conn->error . \"<br>\";\r\n+}\r\n+\r\n+if ($conn->query($sql2) === TRUE) {\r\n+    echo \"ตาราง quotation_items ถูกสร้างเรียบร้อย<br>\";\r\n+} else {\r\n+    echo \"Error creating quotation_items: \" . $conn->error . \"<br>\";\r\n+}\r\n+\r\n+$conn->close();\r\n+?>\r\n+.php\" method=\"post\" id=\"receiptForm\">\r\n+\r\n         <div class=\"doc-title\">\r\n             <h2>ใบเสนอราคา (QUATATION)</h2>\r\n             <div class=\"doc-info\">\r\n                 <label>เลขที่ / NO. : <input type=\"text\" name=\"order_no\" required></label>\r\n"
                },
                {
                    "date": 1758459997299,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,60 +28,10 @@\n         </div>\r\n     </div>\r\n \r\n     <!-- ฟอร์ม -->\r\n-    <form action=\"http://localhost/shop/<?php\r\n-$servername = \"localhost\";\r\n-$username = \"root\"; // เปลี่ยนตามจริง\r\n-$password = \"\";     // เปลี่ยนตามจริง\r\n-$dbname = \"shop_it\";\r\n+    <form action=\"http://localhost/shop/quotation.php\" method=\"post\" id=\"receiptForm\">\r\n \r\n-// สร้างการเชื่อมต่อ\r\n-$conn = new mysqli($servername, $username, $password, $dbname);\r\n-\r\n-// ตรวจสอบการเชื่อมต่อ\r\n-if ($conn->connect_error) {\r\n-    die(\"Connection failed: \" . $conn->connect_error);\r\n-}\r\n-\r\n-// SQL สำหรับสร้างตาราง quotations\r\n-$sql1 = \"CREATE TABLE IF NOT EXISTS quotations (\r\n-    id INT(11) AUTO_INCREMENT PRIMARY KEY,\r\n-    quotation_no VARCHAR(50) NOT NULL,\r\n-    subject VARCHAR(255) NOT NULL,\r\n-    recipient_name VARCHAR(255) NOT NULL,\r\n-    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\r\n-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\";\r\n-\r\n-// SQL สำหรับสร้างตาราง quotation_items\r\n-$sql2 = \"CREATE TABLE IF NOT EXISTS quotation_items (\r\n-    id INT(11) AUTO_INCREMENT PRIMARY KEY,\r\n-    quotation_id INT(11) NOT NULL,\r\n-    item_name VARCHAR(255) NOT NULL,\r\n-    qty INT(11) DEFAULT 0,\r\n-    price DECIMAL(10,2) DEFAULT 0.00,\r\n-    unit VARCHAR(50) DEFAULT NULL,\r\n-    total DECIMAL(10,2) DEFAULT 0.00,\r\n-    FOREIGN KEY (quotation_id) REFERENCES quotations(id) ON DELETE CASCADE\r\n-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\";\r\n-\r\n-// รัน SQL\r\n-if ($conn->query($sql1) === TRUE) {\r\n-    echo \"ตาราง quotations ถูกสร้างเรียบร้อย<br>\";\r\n-} else {\r\n-    echo \"Error creating quotations: \" . $conn->error . \"<br>\";\r\n-}\r\n-\r\n-if ($conn->query($sql2) === TRUE) {\r\n-    echo \"ตาราง quotation_items ถูกสร้างเรียบร้อย<br>\";\r\n-} else {\r\n-    echo \"Error creating quotation_items: \" . $conn->error . \"<br>\";\r\n-}\r\n-\r\n-$conn->close();\r\n-?>\r\n-.php\" method=\"post\" id=\"receiptForm\">\r\n-\r\n         <div class=\"doc-title\">\r\n             <h2>ใบเสนอราคา (QUATATION)</h2>\r\n             <div class=\"doc-info\">\r\n                 <label>เลขที่ / NO. : <input type=\"text\" name=\"order_no\" required></label>\r\n"
                },
                {
                    "date": 1758460010763,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n         </div>\r\n     </div>\r\n \r\n     <!-- ฟอร์ม -->\r\n-    <form action=\"http://localhost/shop/quotation.php\" method=\"post\" id=\"receiptForm\">\r\n+    <form action=\"http://localhost/shop/quotations1.php\" method=\"post\" id=\"receiptForm\">\r\n \r\n         <div class=\"doc-title\">\r\n             <h2>ใบเสนอราคา (QUATATION)</h2>\r\n             <div class=\"doc-info\">\r\n"
                },
                {
                    "date": 1758460410433,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,9 +33,9 @@\n \r\n         <div class=\"doc-title\">\r\n             <h2>ใบเสนอราคา (QUATATION)</h2>\r\n             <div class=\"doc-info\">\r\n-                <label>เลขที่ / NO. : <input type=\"text\" name=\"order_no\" required></label>\r\n+                <label>เลขที่ / NO. : <input type=\"text\" name=\"quotation_no\" required></label>\r\n                 <span><b>วันที่ / Date :</b> ............................................</span>\r\n             </div>\r\n         </div>\r\n \r\n"
                },
                {
                    "date": 1758460576806,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,10 +39,10 @@\n             </div>\r\n         </div>\r\n \r\n         <div class=\"customer-info\">\r\n-            <label>เรื่อง : <input type=\"text\" name=\"customer_name\" required></label><br>\r\n-            <label>เรียน : <textarea name=\"customer_address\" rows=\"2\" required></textarea></label>\r\n+            <label>เรื่อง : <input type=\"text\" name=\"subject\" required></label><br>\r\n+            <label>เรียน : <textarea name=\"recipient_name\" rows=\"2\" required></textarea></label>\r\n         </div>\r\n \r\n         <br>\r\n         <h3>ข้าพเจ้า ร้านเอวาริณ คอปเปอร์เรท  ขอเสนอราคารายการดังต่อไป</h3>\r\n@@ -90,9 +90,9 @@\n         <input type=\"hidden\" name=\"grand_total\" id=\"grand_total_input\">\r\n \r\n         <button type=\"button\" class=\"add-btn\">+</button>\r\n         <button type=\"button\" class=\"button btn-back\" onclick=\"window.location.href='index.html'\">ย้อนกลับ</button>\r\n-        <button type=\"submit\" class=\"button btn-save\">บันทึกใบเสร็จ</button>\r\n+        <button type=\"submit\" class=\"button btn-save\">บันทึกใบเสนอราคา</button>\r\n         <button type=\"button\" class=\"button btn-print\" onclick=\"printPDF()\">พิมพ์ PDF</button>\r\n     </form>\r\n \r\n <!-- ส่วนท้ายหลังตาราง -->\r\n"
                }
            ],
            "date": 1758459842734,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\r\n<html lang=\"th\">\r\n<head>\r\n<meta charset=\"UTF-8\">\r\n<title>ใบเสนอราคา</title>\r\n\r\n<!-- Site Icons -->\r\n<link rel=\"shortcut icon\" href=\"pic/logo.png\" type=\"image/x-icon\" />\r\n<link rel=\"icon\" href=\"pic/logo.png\" type=\"image/x-icon\" />\r\n<link rel=\"apple-touch-icon\" href=\"pic/logo.png\" />\r\n<link href=\"css/quotations1.css\" rel=\"stylesheet\">\r\n\r\n</head>\r\n<body>\r\n<div class=\"container\" id=\"receiptContent\">\r\n\r\n    <!-- ส่วนหัว -->\r\n    <div class=\"header-info\">\r\n        <div class=\"company\">\r\n            <h2>เอวาริณ  คอปเปอร์เรท</h2>\r\n            <p>227 หมู่ 1 ตำบลนาดี อำเภอยางตลาด จังหวัดกาฬสินธุ์ 46120</p>\r\n            <p>โทร. 082-1053870 , 093-4435566</p>\r\n            <p>เลขประจำตัวผู้เสียภาษีอากร  1469900009082</p>\r\n            <p>ทะเบียนการค้าเลขที่  4611664000007</p>\r\n        </div>\r\n        <div class=\"logo\">\r\n            <img src=\"./pic/logo.png\" alt=\"logo\">\r\n        </div>\r\n    </div>\r\n\r\n    <!-- ฟอร์ม -->\r\n    <form action=\"http://localhost/shop/ยังไม่มี.php\" method=\"post\" id=\"receiptForm\">\r\n\r\n        <div class=\"doc-title\">\r\n            <h2>ใบเสนอราคา (QUATATION)</h2>\r\n            <div class=\"doc-info\">\r\n                <label>เลขที่ / NO. : <input type=\"text\" name=\"order_no\" required></label>\r\n                <span><b>วันที่ / Date :</b> ............................................</span>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"customer-info\">\r\n            <label>เรื่อง : <input type=\"text\" name=\"customer_name\" required></label><br>\r\n            <label>เรียน : <textarea name=\"customer_address\" rows=\"2\" required></textarea></label>\r\n        </div>\r\n\r\n        <br>\r\n        <h3>ข้าพเจ้า ร้านเอวาริณ คอปเปอร์เรท  ขอเสนอราคารายการดังต่อไป</h3>\r\n        <table id=\"itemsTable\">\r\n            <thead>\r\n                <tr>\r\n                    <th>ลำดับ</th>\r\n                    <th>รายการ</th>\r\n                    <th>จำนวน</th>\r\n                    <th>ราคา</th>\r\n                    <th>หน่วย</th>\r\n                    <th>ราคารวม</th>\r\n                    <th>ลบ</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr>\r\n                    <td>1</td>\r\n                    <td><input type=\"text\" name=\"item_name[]\"></td>\r\n                    <td><input type=\"number\" name=\"qty[]\" class=\"qty\"></td>\r\n                    <td><input type=\"number\" name=\"price[]\" class=\"price\"> </td>\r\n                    <td><input type=\"text\" name=\"unit[]\"></td>\r\n                    <td><input type=\"text\" name=\"total[]\" class=\"total\" readonly></td>\r\n                    <td><button type=\"button\" class=\"remove-btn\">-</button></td>\r\n                </tr>\r\n            </tbody>\r\n            <tfoot>\r\n                <!-- รวมเป็นเงินทั้งสิ้น -->\r\n                 <tr>\r\n                    <td colspan=\"5\" style=\"text-align:center;font-weight:bold;\">รวมเป็นเงินทั้งสิ้น</td>\r\n                    <td style=\"text-align:right;font-weight:bold;\">\r\n                        <span id=\"grandTotalDisplay\">0.00</span>\r\n                    </td>\r\n                    <td></td>\r\n                </tr>\r\n                <!-- ตัวอักษร -->\r\n                 <tr>\r\n                    <td colspan=\"7\" style=\"text-align:left;font-weight:bold;\">\r\n                        (ตัวอักษร: <span id=\"thaiTextDisplay\">ศูนย์บาทถ้วน</span>)\r\n                    </td>\r\n                </tr>\r\n            </tfoot>\r\n        </table>\r\n\r\n        <input type=\"hidden\" name=\"grand_total\" id=\"grand_total_input\">\r\n\r\n        <button type=\"button\" class=\"add-btn\">+</button>\r\n        <button type=\"button\" class=\"button btn-back\" onclick=\"window.location.href='index.html'\">ย้อนกลับ</button>\r\n        <button type=\"submit\" class=\"button btn-save\">บันทึกใบเสร็จ</button>\r\n        <button type=\"button\" class=\"button btn-print\" onclick=\"printPDF()\">พิมพ์ PDF</button>\r\n    </form>\r\n\r\n<!-- ส่วนท้ายหลังตาราง -->\r\n<div class=\"footer-section\">\r\n  <div class=\"note\">\r\n    <p><strong>หมายเหตุ :</strong></p>\r\n    <p><strong>กำหนดยืนราคา 15 วัน</strong></p>\r\n    <p><strong>กำหนดส่งมอบสินค้า 7 วัน</strong></p>\r\n    <br>\r\n    <p><strong>จึงเรียนมาเพื่อโปรดพิจารณา</strong></p>\r\n\r\n</div>\r\n\r\n  <div class=\"signature\">\r\n    <br>\r\n    <br>\r\n    <br>\r\n    <p>(..............................................................)</p>\r\n    <p>( นายอภิชาติ พิมพะนิตย์ )</p>\r\n    <p>ผู้เสนอราคา</p>\r\n  </div>\r\n\r\n</div>\r\n\r\n<script>\r\n// แปลงตัวเลขเป็นภาษาไทย\r\nfunction numberToThaiText(number) {\r\n    const txtnum = [\"ศูนย์\",\"หนึ่ง\",\"สอง\",\"สาม\",\"สี่\",\"ห้า\",\"หก\",\"เจ็ด\",\"แปด\",\"เก้า\"];\r\n    const txtdigit = [\"\",\"สิบ\",\"ร้อย\",\"พัน\",\"หมื่น\",\"แสน\",\"ล้าน\"];\r\n    if(number === 0) return \"ศูนย์บาทถ้วน\";\r\n    let bahtText = \"\";\r\n    let numStr = number.toFixed(2).toString();\r\n    let [intPart, decPart] = numStr.split(\".\");\r\n    let intLen = intPart.length;\r\n\r\n    for(let i=0; i<intLen; i++){\r\n        let n = parseInt(intPart.charAt(i));\r\n        let pos = intLen - i - 1;\r\n        if(n!==0){\r\n            if(pos==1 && n==1) bahtText += \"สิบ\";\r\n            else if(pos==1 && n==2) bahtText += \"ยี่สิบ\";\r\n            else if(pos==0 && n==1 && intLen>1) bahtText += \"เอ็ด\";\r\n            else bahtText += txtnum[n] + (pos>0?txtdigit[pos]:\"\");\r\n        }\r\n    }\r\n    bahtText += \"บาท\";\r\n    if(decPart==\"00\") bahtText += \"ถ้วน\";\r\n    else {\r\n        let d1 = parseInt(decPart.charAt(0));\r\n        let d2 = parseInt(decPart.charAt(1));\r\n        if(d1!=0){\r\n            if(d1==1) bahtText += \"สิบ\";\r\n            else if(d1==2) bahtText += \"ยี่สิบ\";\r\n            else bahtText += txtnum[d1]+\"สิบ\";\r\n        }\r\n        if(d2!=0){\r\n            if(d2==1) bahtText += \"เอ็ดสตางค์\";\r\n            else bahtText += txtnum[d2]+\"สตางค์\";\r\n        }\r\n    }\r\n    return bahtText;\r\n}\r\n\r\n// คำนวณราคารวม\r\nfunction calculateTotals() {\r\n    let qtys = document.querySelectorAll(\".qty\");\r\n    let prices = document.querySelectorAll(\".price\");\r\n    let totals = document.querySelectorAll(\".total\");\r\n    let grandTotal = 0;\r\n\r\n    qtys.forEach((qty, i) => {\r\n        let q = parseFloat(qty.value) || 0;\r\n        let p = parseFloat(prices[i].value) || 0;\r\n        let sum = q * p;\r\n        totals[i].value = sum.toFixed(2);\r\n        grandTotal += sum;\r\n    });\r\n\r\n    // แสดงผลรวม\r\n    document.getElementById(\"grandTotalDisplay\").innerText = grandTotal.toFixed(2);\r\n    document.getElementById(\"grand_total_input\").value = grandTotal.toFixed(2);\r\n\r\n    // แสดงตัวอักษร\r\n    document.getElementById(\"thaiTextDisplay\").innerText = numberToThaiText(grandTotal);\r\n}\r\n\r\n// event คำนวณอัตโนมัติ\r\ndocument.addEventListener(\"input\", function(e){\r\n    if(e.target.classList.contains(\"qty\") || e.target.classList.contains(\"price\")){\r\n        calculateTotals();\r\n    }\r\n});\r\n\r\n// เพิ่มแถวสินค้า\r\ndocument.querySelector(\".add-btn\").addEventListener(\"click\", function(){\r\n    let table = document.getElementById(\"itemsTable\").getElementsByTagName(\"tbody\")[0];\r\n    let rowCount = table.rows.length;\r\n    let row = table.insertRow();\r\n    row.innerHTML = `\r\n        <td>${rowCount+1}</td>\r\n        <td><input type=\"text\" name=\"item_name[]\"></td>\r\n        <td><input type=\"number\" name=\"qty[]\" class=\"qty\"></td>\r\n        <td><input type=\"number\" name=\"price[]\" class=\"price\"></td>\r\n        <td><input type=\"text\" name=\"unit[]\"></td>\r\n        <td><input type=\"text\" name=\"total[]\" class=\"total\" readonly></td>\r\n        <td><button type=\"button\" class=\"remove-btn\">-</button></td>\r\n    `;\r\n});\r\n\r\n// ลบแถวสินค้า\r\ndocument.getElementById(\"itemsTable\").addEventListener(\"click\", function(e){\r\n    if(e.target.classList.contains(\"remove-btn\")){\r\n        let row = e.target.closest(\"tr\");\r\n        row.parentNode.removeChild(row);\r\n        calculateTotals();\r\n        let rows = document.querySelectorAll(\"#itemsTable tbody tr\");\r\n        rows.forEach((r, i) => r.cells[0].innerText = i+1);\r\n    }\r\n});\r\n\r\n// ปุ่มพิมพ์ PDF\r\nfunction printPDF() {\r\n  window.print();\r\n}\r\n\r\n</script>\r\n</body>\r\n</html>\r\n"
        }
    ]
}